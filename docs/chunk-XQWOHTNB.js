import{a as G,b}from"./chunk-2NV76B7Q.js";import{a as A}from"./chunk-XKFIHP3N.js";import{Oa as W,Sa as N,Ta as k,X as w,Ya as P,a as p,aa as M,b as E,e as $,qc as S,ra as L,xa as O}from"./chunk-DAZPDLGM.js";var J=class a{foods=L([]);constructor(){this.loadFoods()}loadFoods(){let t=localStorage.getItem("foods");t?this.foods.set(JSON.parse(t)):this.foods.set([])}addEditFood(t){this.foods().find(r=>r.id===t.id)?this.foods.update(r=>r.map(n=>n.id===t.id?t:n)):this.foods.update(r=>[...r,E(p({},t),{id:t.id||b()})]),localStorage.setItem("foods",JSON.stringify(this.foods()))}deleteFood(t){this.foods.update(e=>e.filter(r=>r.id!==t.id)),localStorage.setItem("foods",JSON.stringify(this.foods()))}downloadFoods(){let t=JSON.stringify(this.foods()),e=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download="foods.json",n.click(),URL.revokeObjectURL(r)}setFoods(t){localStorage.setItem("foods",JSON.stringify(t)),this.loadFoods()}getFoodById(t){return this.foods().find(e=>e.id===t)}getFoodByBarcode(t){return this.foods().find(e=>e.barcode===t)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"})};var U=(i=>(i[i.None=0]="None",i[i.Carbs=1]="Carbs",i[i.Proteins=2]="Proteins",i[i.Fats=3]="Fats",i[i.Vegetable=4]="Vegetable",i[i.Complex=5]="Complex",i[i.Other=6]="Other",i))(U||{}),ne={0:{bgColor:"#302010"},1:{bgColor:"#706030"},2:{bgColor:"#305090"},3:{bgColor:"#805040"},4:{bgColor:"#208040"},5:{bgColor:"#654070"},6:{bgColor:"#333355"}};var x=class{constructor(t="",e="",r=0,n=0,o=0,s=0,i=0,d=0,l=100,c="",m=""){this.id=t;this.name=e;this.macroCategory=r;this.protein=n;this.carbs=o;this.fats=s;this.fiber=i;this.calories=d;this.weight=l;this.barcode=c;this.note=m}};function B(a){return a&&typeof a=="object"&&typeof a.id=="string"&&typeof a.name=="string"&&typeof a.macroCategory=="number"&&typeof a.protein=="number"&&typeof a.carbs=="number"&&typeof a.fats=="number"&&typeof a.fiber=="number"&&typeof a.calories=="number"&&typeof a.weight=="number"&&(!a.barcode||typeof a.barcode=="string")&&typeof a.note=="string"}var z=class a{vcr=M(k);renderer=M(W);elementRef=M(O);buttonIcon=S.required();minWidthPx=S(120);iconSize=S("32px");ngAfterViewInit(){this.renderer.setAttribute(this.elementRef.nativeElement,"type","button"),this.renderer.addClass(this.elementRef.nativeElement,"d-flex"),this.renderer.addClass(this.elementRef.nativeElement,"justify-content-between"),this.renderer.addClass(this.elementRef.nativeElement,"align-items-center"),this.renderer.addClass(this.elementRef.nativeElement,"align-content-center"),this.renderer.addClass(this.elementRef.nativeElement,"flex-shrink-0"),this.renderer.addClass(this.elementRef.nativeElement,"gap-2"),this.renderer.setStyle(this.elementRef.nativeElement,"white-space","nowrap"),this.renderer.setStyle(this.elementRef.nativeElement,"padding","0.125rem 0.5rem");let t=this.vcr.createComponent(A,{bindings:[N("icon",this.buttonIcon),N("size",this.iconSize)]});this.elementRef.nativeElement.childNodes?.[0]?.textContent?.trim()?(this.renderer.setStyle(this.elementRef.nativeElement,"min-width",`${this.minWidthPx()}px`),this.renderer.setStyle(this.elementRef.nativeElement,"padding","0.125rem 0.5rem")):this.renderer.setStyle(this.elementRef.nativeElement,"padding","0.125rem"),this.renderer.appendChild(this.elementRef.nativeElement,t.location.nativeElement)}static \u0275fac=function(e){return new(e||a)};static \u0275dir=P({type:a,selectors:[["","buttonIcon",""]],inputs:{buttonIcon:[1,"buttonIcon"],minWidthPx:[1,"minWidthPx"],iconSize:[1,"iconSize"]}})};var C=(i=>(i[i.None=0]="None",i[i.MealOne=1]="MealOne",i[i.MealTwo=2]="MealTwo",i[i.MealThree=3]="MealThree",i[i.MealFour=4]="MealFour",i[i.MealFive=5]="MealFive",i[i.Snacks=6]="Snacks",i))(C||{}),I={0:"None",1:"Meal I",2:"Meal II",3:"Meal III",4:"Meal IV",5:"Meal V",6:"Snacks"};var h=class{constructor(t=0,e=0,r=0,n=0,o=0,s=0){this.proteins=t;this.carbs=e;this.fats=r;this.fiber=n;this.calories=o;this.weight=s}};var g=class{constructor(t="",e="",r=[],n="",o){this.id=t;this.name=e;this.foods=r;this.note=n;this.time=o}};function H(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.protein*e.weight*.01,0):0}function K(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.carbs*e.weight*.01,0):0}function Q(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.fats*e.weight*.01,0):0}function X(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.fiber*e.weight*.01,0):0}function Y(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.calories*e.weight*.01,0):0}function Z(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.weight,0):0}function me(a){return new h(H(a),K(a),Q(a),X(a),Y(a),Z(a))}var T=class extends g{constructor(e="",r="",n=[],o=1,s=""){super(e,r,n,s);this.portions=o}};function we(a){return a&&typeof a=="object"&&typeof a.id=="string"&&typeof a.name=="string"&&typeof a.portions=="number"&&typeof a.note=="string"&&Array.isArray(a.foods)&&a.foods.every(t=>B(t))}var u=$(G());var R=class{diaryDays=[]};var y=class{entries=[];weight;note;waterMl;activities=[]},D=class{constructor(t=0,e=new g,r=[]){this.position=t;this.meal=e;this.recipes=r}};var f=class{constructor(t,e=new y){this.date=t;this.dayTemplate=e}};var F=class{constructor(t,e=0,r=15,n){this.time=t;this.type=e;this.durationMinutes=r;this.note=n}},j=(i=>(i[i.None=0]="None",i[i.Walk=1]="Walk",i[i.Aerobics=2]="Aerobics",i[i.Cardio=3]="Cardio",i[i.Sports=4]="Sports",i[i.Workout=5]="Workout",i[i.Other=6]="Other",i))(j||{}),Fe={0:{icon:"fluent:border-none-24-filled"},1:{icon:"fa-solid:walking"},2:{icon:"icon-park-solid:sport"},3:{icon:"tabler:run"},4:{icon:"icon-park-solid:sporting"},5:{icon:"streamline-plump:dumbell-solid"},6:{icon:"hugeicons:activity-01"}};var q=class a{diaryLog=L(void 0);constructor(){this.setDiaryLog(),this.loadDiaryLog()}setDiaryLog(){if(!localStorage.getItem("diaryLog")){let e=new R;localStorage.setItem("diaryLog",JSON.stringify(e))}}loadDiaryLog(){this.diaryLog.set(JSON.parse(localStorage.getItem("diaryLog")))}getRespectiveMeal(t,e){return this.diaryLog()?.diaryDays.find(r=>r.date===t)?.dayTemplate.entries.find(r=>r.position===e)?.meal}updateMealTime(t,e){e=Number(e),this.diaryLog.update(r=>{let n=p({},r),o=n.diaryDays.find(d=>d.date===t);if(!o)return r;let s=o.dayTemplate.entries.find(d=>d.position===e);if(!s)return r;let i=(0,u.default)();return s.meal.time={hour:i.hour(),minute:i.minute(),second:0},n}),this.saveDiaryLog()}getRespectiveRecipes(t,e){return this.diaryLog()?.diaryDays.find(r=>r.date===t)?.dayTemplate.entries.find(r=>r.position===e)?.recipes}addFood(t,e,r){r=p({},r),e=Number(e),this.diaryLog.update(n=>{let o=p({},n),s=o.diaryDays.find(d=>d.date===t);if(!s){let d=new f(t,new y);o.diaryDays.push(d),s=d}let i=s.dayTemplate.entries.find(d=>d.position===e);return i?i.meal.foods.push(r):(i=new D(e,new g(b(),I[e],[r]),[]),s.dayTemplate.entries.push(i)),o}),this.saveDiaryLog()}saveDiaryLog(){localStorage.setItem("diaryLog",JSON.stringify(this.diaryLog(),(t,e)=>t==="position"&&typeof e=="string"?C[e]:e))}updateMealName(t,e,r){this.diaryLog.update(n=>{let o=p({},n),s=o.diaryDays.find(d=>d.date===t);if(!s)return n;let i=s.dayTemplate.entries.find(d=>d.position===e);return i?(i.meal.name=r,o):n}),this.saveDiaryLog()}removeFood(t,e,r){this.diaryLog.update(n=>{let o=p({},n),s=o.diaryDays.find(d=>d.date===t);if(!s)return n;let i=s.dayTemplate.entries.find(d=>d.position===e);return i?(i.meal.foods=i.meal.foods.filter((d,l)=>l!==r),o):n}),this.saveDiaryLog()}removeRecipeFromPosition(t,e,r){this.diaryLog.update(n=>{let o=p({},n),s=o.diaryDays.find(d=>d.date===t);if(!s)return n;let i=s.dayTemplate.entries.find(d=>d.position===e);return i?(i.recipes=i.recipes.filter((d,l)=>l!==r),o):n}),this.saveDiaryLog()}updateRecipeFoodWeight(t,e,r,n,o){this.diaryLog.update(s=>{let i=p({},s),d=i.diaryDays.find(v=>v.date===t);if(!d)return s;let l=d.dayTemplate.entries.find(v=>v.position===e);if(!l)return s;let c=l.recipes?.[r];if(!c)return s;let m=c.foods?.[n];return m?(m.weight=Number(o),i):s}),this.saveDiaryLog()}removeFoodFromRecipe(t,e,r,n){this.diaryLog.update(o=>{let s=p({},o),i=s.diaryDays.find(m=>m.date===t);if(!i)return o;let d=i.dayTemplate.entries.find(m=>m.position===e);if(!d)return o;let l=d.recipes?.[r];return!l||!l.foods?.[n]?o:(l.foods=l.foods.filter((m,v)=>v!==n),s)}),this.saveDiaryLog()}clearMeal(t,e){this.diaryLog.update(r=>{let n=p({},r),o=n.diaryDays.find(i=>i.date===t);return!o||!o.dayTemplate.entries.find(i=>i.position===e)?r:(o.dayTemplate.entries=o.dayTemplate.entries.filter(i=>i.position!==e),n)}),this.saveDiaryLog()}updateFoodWeight(t,e,r,n){this.diaryLog.update(o=>{let s=p({},o),i=s.diaryDays.find(l=>l.date===t);if(!i)return o;let d=i.dayTemplate.entries.find(l=>l.position===e);return d?(d.meal.foods[r].weight=Number(n),s):o}),this.saveDiaryLog()}getDayStats(t){let e=this.diaryLog()?.diaryDays.find(n=>n.date===t),r=new h;if(!e)return r;for(let n of e.dayTemplate.entries){let o=[...n.meal.foods,...n.recipes.flatMap(s=>s.foods)];r.proteins+=o.reduce((s,i)=>s+i.protein*i.weight*.01,0),r.carbs+=o.reduce((s,i)=>s+i.carbs*i.weight*.01,0),r.fats+=o.reduce((s,i)=>s+i.fats*i.weight*.01,0),r.fiber+=o.reduce((s,i)=>s+i.fiber*i.weight*.01,0),r.calories+=o.reduce((s,i)=>s+i.calories*i.weight*.01,0),r.weight+=o.reduce((s,i)=>s+i.weight,0)}return r}getDayNote(t){return this.diaryLog()?.diaryDays?.find(e=>e.date===t)?.dayTemplate?.note??null}updateDayNote(t,e){this.diaryLog.update(r=>{let n=p({},r),o=n.diaryDays.find(s=>s.date===t);if(!o){let s=new f(t,new y);n.diaryDays.push(s),o=s}return o.dayTemplate.note=e,n}),this.saveDiaryLog()}getDayWater(t){return this.diaryLog()?.diaryDays?.find(e=>e.date===t)?.dayTemplate?.waterMl??null}updateDayWater(t,e){this.diaryLog.update(r=>{let n=p({},r),o=n.diaryDays.find(s=>s.date===t);if(!o){let s=new f(t,new y);n.diaryDays.push(s),o=s}return e?o.dayTemplate.waterMl=Number(e):delete o.dayTemplate.waterMl,n}),this.saveDiaryLog()}addDayWater(t,e){this.updateDayWater(t,(this.getDayWater(t)+e).toString())}subtractDayWater(t,e){let r=this.getDayWater(t);r<=e?this.updateDayWater(t,""):this.updateDayWater(t,(r-e).toString())}getPositionStats(t,e){let r=this.diaryLog()?.diaryDays.find(i=>i.date===t),n=new h;if(!r)return n;let o=r.dayTemplate.entries.find(i=>i.position===e);if(!o)return n;let s=[...o.meal.foods,...o.recipes.flatMap(i=>i.foods)];return{proteins:s.reduce((i,d)=>i+d.protein*d.weight*.01,0),carbs:s.reduce((i,d)=>i+d.carbs*d.weight*.01,0),fats:s.reduce((i,d)=>i+d.fats*d.weight*.01,0),fiber:s.reduce((i,d)=>i+d.fiber*d.weight*.01,0),calories:s.reduce((i,d)=>i+d.calories*d.weight*.01,0),weight:s.reduce((i,d)=>i+d.weight,0)}}updateMealNote(t,e,r){this.diaryLog.update(n=>{let o=p({},n),s=o.diaryDays.find(d=>d.date===t);if(!s)return n;let i=s.dayTemplate.entries.find(d=>d.meal.id===e);return i?(i.meal.note=r,o):n}),this.saveDiaryLog()}getExpandedMeal(){let t=localStorage.getItem("expandedMeal");return t?JSON.parse(t):null}toggleExpandedMeal(t,e){let r=this.getExpandedMeal();localStorage.setItem("expandedMeal",JSON.stringify({isoDate:r?.isoDate===t&&r?.mealPosition===e?"":t,mealPosition:r?.isoDate===t&&r?.mealPosition===e?0:e}))}expandMeal(t,e){localStorage.setItem("expandedMeal",JSON.stringify({isoDate:t,mealPosition:e}))}addRecipe(t,e,r,n){this.diaryLog.update(o=>{let s=p({},o),i=s.diaryDays.find(c=>c.date===t);if(!i){let c=new f(t,new y);s.diaryDays.push(c),i=c}let d=i.dayTemplate.entries.find(c=>c.position===e),l=new T(b(),n.name,n.foods.map(c=>new x(c.id,c.name,c.macroCategory,c.protein,c.carbs,c.fats,c.fiber,c.calories,c.weight*(r/n.portions),c.note)),r,n.note);return d?d.recipes.push(l):(d=new D(e,new g(b(),I[e],[]),[l]),i.dayTemplate.entries.push(d)),s}),this.saveDiaryLog()}hasFoodOnDate(t){let e=this.diaryLog()?.diaryDays.find(r=>r.date===t);if(!e)return!1;for(let r of e.dayTemplate.entries)if(r.meal.foods.length>0||r.recipes.length>0)return!0;return!1}hasWeightInOnDate(t){return!!this.diaryLog()?.diaryDays.find(e=>e.date===t)?.dayTemplate?.weight}hasWaterOnDate(t){return!!this.diaryLog()?.diaryDays.find(e=>e.date===t)?.dayTemplate?.waterMl}hasActivitiesOnDate(t){return!!this.diaryLog()?.diaryDays.find(e=>e.date===t)?.dayTemplate?.activities?.some(e=>!!e.durationMinutes&&e.type!==0)}getCurrentWeight(t){let e=this.diaryLog()?.diaryDays.find(r=>r.date===t);return e?e.dayTemplate.weight??null:null}updateCurrentWeight(t,e){this.diaryLog.update(r=>{let n=p({},r),o=n.diaryDays.find(s=>s.date===t);if(!o){let s=new f(t,new y);n.diaryDays.push(s),o=s}return e?o.dayTemplate.weight=Number(e):delete o.dayTemplate.weight,n}),this.saveDiaryLog()}getWeightByFormula(t,e){let r=(0,u.default)(t).utc().startOf("day"),n=[];for(let s=0;s<e;s++){let i=r.subtract(s,"day").toISOString(),d=this.getCurrentWeight(i);d&&n.push(d)}if(!n.length)return 0;if(n.sort(),n.length<=3)return n.reduce((s,i)=>s+i,0)/n.length;let o=Math.floor(n.length/2);return n.length%2===0?(n[o-1]+n[o])/2:(n[o-1]+n[o]+n[o+1])/3}getWeights(t,e){let r=u.default.min((0,u.default)(t).utc().startOf("day"),(0,u.default)().utc().startOf("day")),n=[],o=0;for(let s=0;s<e;s++){let i=r.subtract(s,"day").toISOString();o=this.getCurrentWeight(i),o&&n.push(o)}return n.reverse(),n}getCalorie(t){return this.getDayStats(t).calories}getCalories(t,e){let r=u.default.min((0,u.default)(t).utc().startOf("day"),(0,u.default)().utc().startOf("day")),n=[],o=0;for(let s=0;s<e;s++){let i=r.subtract(s,"day").toISOString();o=this.getCalorie(i),o&&n.push(o)}return n.reverse(),n}getActivities(t){return this.diaryLog()?.diaryDays.find(e=>e.date===t)?.dayTemplate.activities??[]}addActivity(t){this.diaryLog.update(e=>{let r=p({},e),n=r.diaryDays.find(d=>d.date===t);if(!n){let d=new f(t,new y);r.diaryDays.push(d),n=d}let o=n.dayTemplate.activities,s=(0,u.default)(),i=new F({hour:s.hour(),minute:s.minute(),second:0});return o?.length?o.push(i):n.dayTemplate.activities=[i],r}),this.saveDiaryLog()}removeActivity(t,e){this.diaryLog.update(r=>{let n=p({},r),o=n.diaryDays.find(s=>s.date===t);return o?(o.dayTemplate.activities=o.dayTemplate.activities.filter((s,i)=>i!==e),n):r}),this.saveDiaryLog()}setActivityType(t,e,r){this.diaryLog.update(n=>{let o=p({},n),s=o.diaryDays.find(i=>i.date===t);return s?(s.dayTemplate.activities[e].type=r,o):n}),this.saveDiaryLog()}downloadDiary(){let t=JSON.stringify(this.diaryLog()),e=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(e),n=document.createElement("a");n.href=r,n.download="diary.json",n.click(),URL.revokeObjectURL(r)}setDiary(t){localStorage.setItem("diaryLog",JSON.stringify(t)),this.loadDiaryLog()}static \u0275fac=function(e){return new(e||a)};static \u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"})};export{J as a,U as b,ne as c,x as d,B as e,z as f,C as g,I as h,g as i,H as j,K as k,Q as l,X as m,Y as n,Z as o,me as p,y as q,T as r,we as s,j as t,Fe as u,q as v};
