import{a as X,b as D}from"./chunk-2NV76B7Q.js";import{Oa as P,Sa as F,Sb as B,Ta as z,Wa as A,X as M,Ya as J,a as p,aa as L,b as W,e as Q,fc as _,qc as y,ra as S,ub as V,xa as k,yb as U}from"./chunk-DAZPDLGM.js";var Y=(a,t,e)=>({width:a,height:t,fontSize:e}),C=class a{icon=y.required();flip=y();rotate=y();size=y();width=y();height=y();fontSize=y();static \u0275fac=function(e){return new(e||a)};static \u0275cmp=A({type:a,selectors:[["iconify"]],inputs:{icon:[1,"icon"],flip:[1,"flip"],rotate:[1,"rotate"],size:[1,"size"],width:[1,"width"],height:[1,"height"],fontSize:[1,"fontSize"]},decls:1,vars:9,consts:[[3,"icon","flip","rotate"]],template:function(e,r){e&1&&V(0,"iconify-icon",0),e&2&&(B(_(5,Y,r.width()||r.size(),r.height()||r.size(),r.fontSize()||r.size())),U("icon",r.icon())("flip",r.flip())("rotate",r.rotate()))},styles:["[_nghost-%COMP%]{display:inline-block;vertical-align:middle}[_nghost-%COMP%]   iconify-icon[_ngcontent-%COMP%]{display:flex;vertical-align:middle;align-items:center;justify-content:center}"],changeDetection:0})};var j=class a{foods=S([]);constructor(){this.loadFoods()}loadFoods(){let t=localStorage.getItem("foods");t?this.foods.set(JSON.parse(t)):this.foods.set([])}addEditFood(t){this.foods().find(r=>r.id===t.id)?this.foods.update(r=>r.map(o=>o.id===t.id?t:o)):this.foods.update(r=>[...r,W(p({},t),{id:t.id||D()})]),localStorage.setItem("foods",JSON.stringify(this.foods()))}deleteFood(t){this.foods.update(e=>e.filter(r=>r.id!==t.id)),localStorage.setItem("foods",JSON.stringify(this.foods()))}downloadFoods(){let t=JSON.stringify(this.foods()),e=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(e),o=document.createElement("a");o.href=r,o.download="foods.json",o.click(),URL.revokeObjectURL(r)}setFoods(t){localStorage.setItem("foods",JSON.stringify(t)),this.loadFoods()}getFoodById(t){return this.foods().find(e=>e.id===t)}getFoodByBarcode(t){return this.foods().find(e=>e.barcode===t)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=M({token:a,factory:a.\u0275fac,providedIn:"root"})};var q=(i=>(i[i.None=0]="None",i[i.Carbs=1]="Carbs",i[i.Proteins=2]="Proteins",i[i.Fats=3]="Fats",i[i.Vegetable=4]="Vegetable",i[i.Complex=5]="Complex",i[i.Other=6]="Other",i))(q||{}),fe={0:{bgColor:"#302010"},1:{bgColor:"#706030"},2:{bgColor:"#305090"},3:{bgColor:"#805040"},4:{bgColor:"#208040"},5:{bgColor:"#654070"},6:{bgColor:"#333355"}};var N=class{constructor(t="",e="",r=0,o=0,s=0,n=0,i=0,d=0,l=100,c="",h=""){this.id=t;this.name=e;this.macroCategory=r;this.protein=o;this.carbs=s;this.fats=n;this.fiber=i;this.calories=d;this.weight=l;this.barcode=c;this.note=h}};function H(a){return a&&typeof a=="object"&&typeof a.id=="string"&&typeof a.name=="string"&&typeof a.macroCategory=="number"&&typeof a.protein=="number"&&typeof a.carbs=="number"&&typeof a.fats=="number"&&typeof a.fiber=="number"&&typeof a.calories=="number"&&typeof a.weight=="number"&&(!a.barcode||typeof a.barcode=="string")&&typeof a.note=="string"}var $=class a{vcr=L(z);renderer=L(P);elementRef=L(k);buttonIcon=y.required();minWidthPx=y(120);iconSize=y("32px");ngAfterViewInit(){this.renderer.setAttribute(this.elementRef.nativeElement,"type","button"),this.renderer.addClass(this.elementRef.nativeElement,"d-flex"),this.renderer.addClass(this.elementRef.nativeElement,"justify-content-between"),this.renderer.addClass(this.elementRef.nativeElement,"align-items-center"),this.renderer.addClass(this.elementRef.nativeElement,"align-content-center"),this.renderer.addClass(this.elementRef.nativeElement,"flex-shrink-0"),this.renderer.addClass(this.elementRef.nativeElement,"gap-2"),this.renderer.setStyle(this.elementRef.nativeElement,"white-space","nowrap"),this.renderer.setStyle(this.elementRef.nativeElement,"padding","0.125rem 0.5rem");let t=this.vcr.createComponent(C,{bindings:[F("icon",this.buttonIcon),F("size",this.iconSize)]});this.elementRef.nativeElement.childNodes?.[0]?.textContent?.trim()?(this.renderer.setStyle(this.elementRef.nativeElement,"min-width",`${this.minWidthPx()}px`),this.renderer.setStyle(this.elementRef.nativeElement,"padding","0.125rem 0.5rem")):this.renderer.setStyle(this.elementRef.nativeElement,"padding","0.125rem"),this.renderer.appendChild(this.elementRef.nativeElement,t.location.nativeElement)}static \u0275fac=function(e){return new(e||a)};static \u0275dir=J({type:a,selectors:[["","buttonIcon",""]],inputs:{buttonIcon:[1,"buttonIcon"],minWidthPx:[1,"minWidthPx"],iconSize:[1,"iconSize"]}})};var T=(n=>(n[n.None=0]="None",n[n.MealOne=1]="MealOne",n[n.MealTwo=2]="MealTwo",n[n.MealThree=3]="MealThree",n[n.MealFour=4]="MealFour",n[n.Snacks=5]="Snacks",n))(T||{}),O={0:"None",1:"Meal I",2:"Meal II",3:"Meal III",4:"Meal IV",5:"Snacks"};var b=class{constructor(t=0,e=0,r=0,o=0,s=0,n=0){this.proteins=t;this.carbs=e;this.fats=r;this.fiber=o;this.calories=s;this.weight=n}};var f=class{constructor(t="",e="",r=[],o="",s){this.id=t;this.name=e;this.foods=r;this.note=o;this.time=s}};function Z(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.protein*e.weight*.01,0):0}function ee(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.carbs*e.weight*.01,0):0}function te(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.fats*e.weight*.01,0):0}function ie(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.fiber*e.weight*.01,0):0}function re(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.calories*e.weight*.01,0):0}function ne(a){return a?.foods?.length?a.foods.reduce((t,e)=>t+e.weight,0):0}function Te(a){return new b(Z(a),ee(a),te(a),ie(a),re(a),ne(a))}var x=class extends f{constructor(e="",r="",o=[],s=1,n=""){super(e,r,o,n);this.portions=s}};function Ie(a){return a&&typeof a=="object"&&typeof a.id=="string"&&typeof a.name=="string"&&typeof a.portions=="number"&&typeof a.note=="string"&&Array.isArray(a.foods)&&a.foods.every(t=>H(t))}var g=Q(X());var R=class{diaryDays=[]};var u=class{entries=[];weight;note;waterMl;activities=[]},w=class{constructor(t=0,e=new f,r=[]){this.position=t;this.meal=e;this.recipes=r}};var m=class{constructor(t,e=new u){this.date=t;this.dayTemplate=e}};var E=class{constructor(t,e=0,r=15,o){this.time=t;this.type=e;this.durationMinutes=r;this.note=o}},G=(i=>(i[i.None=0]="None",i[i.Walk=1]="Walk",i[i.Aerobics=2]="Aerobics",i[i.Cardio=3]="Cardio",i[i.Sports=4]="Sports",i[i.Workout=5]="Workout",i[i.Other=6]="Other",i))(G||{}),Ve={0:{icon:"fluent:border-none-24-filled"},1:{icon:"fa-solid:walking"},2:{icon:"icon-park-solid:sport"},3:{icon:"tabler:run"},4:{icon:"icon-park-solid:sporting"},5:{icon:"streamline-plump:dumbell-solid"},6:{icon:"hugeicons:activity-01"}};var K=class a{diaryLog=S(void 0);constructor(){this.setDiaryLog(),this.loadDiaryLog()}setDiaryLog(){if(!localStorage.getItem("diaryLog")){let e=new R;localStorage.setItem("diaryLog",JSON.stringify(e))}}loadDiaryLog(){this.diaryLog.set(JSON.parse(localStorage.getItem("diaryLog")))}getRespectiveMeal(t,e){return this.diaryLog()?.diaryDays.find(r=>r.date===t)?.dayTemplate.entries.find(r=>r.position===e)?.meal}updateMealTime(t,e){e=Number(e),this.diaryLog.update(r=>{let o=p({},r),s=o.diaryDays.find(d=>d.date===t);if(!s)return r;let n=s.dayTemplate.entries.find(d=>d.position===e);if(!n)return r;let i=(0,g.default)();return n.meal.time={hour:i.hour(),minute:i.minute(),second:0},o}),this.saveDiaryLog()}getRespectiveRecipes(t,e){return this.diaryLog()?.diaryDays.find(r=>r.date===t)?.dayTemplate.entries.find(r=>r.position===e)?.recipes}addFood(t,e,r){r=p({},r),e=Number(e),this.diaryLog.update(o=>{let s=p({},o),n=s.diaryDays.find(d=>d.date===t);if(!n){let d=new m(t,new u);s.diaryDays.push(d),n=d}let i=n.dayTemplate.entries.find(d=>d.position===e);return i?i.meal.foods.push(r):(i=new w(e,new f(D(),O[e],[r]),[]),n.dayTemplate.entries.push(i)),s}),this.saveDiaryLog()}saveDiaryLog(){localStorage.setItem("diaryLog",JSON.stringify(this.diaryLog(),(t,e)=>t==="position"&&typeof e=="string"?T[e]:e))}updateMealName(t,e,r){this.diaryLog.update(o=>{let s=p({},o),n=s.diaryDays.find(d=>d.date===t);if(!n)return o;let i=n.dayTemplate.entries.find(d=>d.position===e);return i?(i.meal.name=r,s):o}),this.saveDiaryLog()}removeFood(t,e,r){this.diaryLog.update(o=>{let s=p({},o),n=s.diaryDays.find(d=>d.date===t);if(!n)return o;let i=n.dayTemplate.entries.find(d=>d.position===e);return i?(i.meal.foods=i.meal.foods.filter((d,l)=>l!==r),s):o}),this.saveDiaryLog()}removeRecipeFromPosition(t,e,r){this.diaryLog.update(o=>{let s=p({},o),n=s.diaryDays.find(d=>d.date===t);if(!n)return o;let i=n.dayTemplate.entries.find(d=>d.position===e);return i?(i.recipes=i.recipes.filter((d,l)=>l!==r),s):o}),this.saveDiaryLog()}updateRecipeFoodWeight(t,e,r,o,s){this.diaryLog.update(n=>{let i=p({},n),d=i.diaryDays.find(v=>v.date===t);if(!d)return n;let l=d.dayTemplate.entries.find(v=>v.position===e);if(!l)return n;let c=l.recipes?.[r];if(!c)return n;let h=c.foods?.[o];return h?(h.weight=Number(s),i):n}),this.saveDiaryLog()}removeFoodFromRecipe(t,e,r,o){this.diaryLog.update(s=>{let n=p({},s),i=n.diaryDays.find(h=>h.date===t);if(!i)return s;let d=i.dayTemplate.entries.find(h=>h.position===e);if(!d)return s;let l=d.recipes?.[r];return!l||!l.foods?.[o]?s:(l.foods=l.foods.filter((h,v)=>v!==o),n)}),this.saveDiaryLog()}clearMeal(t,e){this.diaryLog.update(r=>{let o=p({},r),s=o.diaryDays.find(i=>i.date===t);return!s||!s.dayTemplate.entries.find(i=>i.position===e)?r:(s.dayTemplate.entries=s.dayTemplate.entries.filter(i=>i.position!==e),o)}),this.saveDiaryLog()}updateFoodWeight(t,e,r,o){this.diaryLog.update(s=>{let n=p({},s),i=n.diaryDays.find(l=>l.date===t);if(!i)return s;let d=i.dayTemplate.entries.find(l=>l.position===e);return d?(d.meal.foods[r].weight=Number(o),n):s}),this.saveDiaryLog()}getDayStats(t){let e=this.diaryLog()?.diaryDays.find(o=>o.date===t),r=new b;if(!e)return r;for(let o of e.dayTemplate.entries){let s=[...o.meal.foods,...o.recipes.flatMap(n=>n.foods)];r.proteins+=s.reduce((n,i)=>n+i.protein*i.weight*.01,0),r.carbs+=s.reduce((n,i)=>n+i.carbs*i.weight*.01,0),r.fats+=s.reduce((n,i)=>n+i.fats*i.weight*.01,0),r.fiber+=s.reduce((n,i)=>n+i.fiber*i.weight*.01,0),r.calories+=s.reduce((n,i)=>n+i.calories*i.weight*.01,0),r.weight+=s.reduce((n,i)=>n+i.weight,0)}return r}getDayNote(t){return this.diaryLog()?.diaryDays?.find(e=>e.date===t)?.dayTemplate?.note??null}updateDayNote(t,e){this.diaryLog.update(r=>{let o=p({},r),s=o.diaryDays.find(n=>n.date===t);if(!s){let n=new m(t,new u);o.diaryDays.push(n),s=n}return s.dayTemplate.note=e,o}),this.saveDiaryLog()}getDayWater(t){return this.diaryLog()?.diaryDays?.find(e=>e.date===t)?.dayTemplate?.waterMl??null}updateDayWater(t,e){this.diaryLog.update(r=>{let o=p({},r),s=o.diaryDays.find(n=>n.date===t);if(!s){let n=new m(t,new u);o.diaryDays.push(n),s=n}return e?s.dayTemplate.waterMl=Number(e):delete s.dayTemplate.waterMl,o}),this.saveDiaryLog()}addDayWater(t,e){this.updateDayWater(t,(this.getDayWater(t)+e).toString())}subtractDayWater(t,e){let r=this.getDayWater(t);r<=e?this.updateDayWater(t,""):this.updateDayWater(t,(r-e).toString())}getPositionStats(t,e){let r=this.diaryLog()?.diaryDays.find(i=>i.date===t),o=new b;if(!r)return o;let s=r.dayTemplate.entries.find(i=>i.position===e);if(!s)return o;let n=[...s.meal.foods,...s.recipes.flatMap(i=>i.foods)];return{proteins:n.reduce((i,d)=>i+d.protein*d.weight*.01,0),carbs:n.reduce((i,d)=>i+d.carbs*d.weight*.01,0),fats:n.reduce((i,d)=>i+d.fats*d.weight*.01,0),fiber:n.reduce((i,d)=>i+d.fiber*d.weight*.01,0),calories:n.reduce((i,d)=>i+d.calories*d.weight*.01,0),weight:n.reduce((i,d)=>i+d.weight,0)}}updateMealNote(t,e,r){this.diaryLog.update(o=>{let s=p({},o),n=s.diaryDays.find(d=>d.date===t);if(!n)return o;let i=n.dayTemplate.entries.find(d=>d.meal.id===e);return i?(i.meal.note=r,s):o}),this.saveDiaryLog()}getExpandedMeal(){let t=localStorage.getItem("expandedMeal");return t?JSON.parse(t):null}toggleExpandedMeal(t,e){let r=this.getExpandedMeal();localStorage.setItem("expandedMeal",JSON.stringify({isoDate:r?.isoDate===t&&r?.mealPosition===e?"":t,mealPosition:r?.isoDate===t&&r?.mealPosition===e?0:e}))}expandMeal(t,e){localStorage.setItem("expandedMeal",JSON.stringify({isoDate:t,mealPosition:e}))}addRecipe(t,e,r,o){this.diaryLog.update(s=>{let n=p({},s),i=n.diaryDays.find(c=>c.date===t);if(!i){let c=new m(t,new u);n.diaryDays.push(c),i=c}let d=i.dayTemplate.entries.find(c=>c.position===e),l=new x(D(),o.name,o.foods.map(c=>new N(c.id,c.name,c.macroCategory,c.protein,c.carbs,c.fats,c.fiber,c.calories,c.weight*(r/o.portions),c.note)),r,o.note);return d?d.recipes.push(l):(d=new w(e,new f(D(),O[e],[]),[l]),i.dayTemplate.entries.push(d)),n}),this.saveDiaryLog()}hasFoodOnDate(t){let e=this.diaryLog()?.diaryDays.find(r=>r.date===t);if(!e)return!1;for(let r of e.dayTemplate.entries)if(r.meal.foods.length>0||r.recipes.length>0)return!0;return!1}hasWeightInOnDate(t){return!!this.diaryLog()?.diaryDays.find(e=>e.date===t)?.dayTemplate?.weight}hasWaterOnDate(t){return!!this.diaryLog()?.diaryDays.find(e=>e.date===t)?.dayTemplate?.waterMl}hasActivitiesOnDate(t){return!!this.diaryLog()?.diaryDays.find(e=>e.date===t)?.dayTemplate?.activities?.some(e=>!!e.durationMinutes&&e.type!==0)}getCurrentWeight(t){let e=this.diaryLog()?.diaryDays.find(r=>r.date===t);return e?e.dayTemplate.weight??null:null}updateCurrentWeight(t,e){this.diaryLog.update(r=>{let o=p({},r),s=o.diaryDays.find(n=>n.date===t);if(!s){let n=new m(t,new u);o.diaryDays.push(n),s=n}return e?s.dayTemplate.weight=Number(e):delete s.dayTemplate.weight,o}),this.saveDiaryLog()}getWeightByFormula(t,e){let r=(0,g.default)(t).utc().startOf("day"),o=[];for(let n=0;n<e;n++){let i=r.subtract(n,"day").toISOString(),d=this.getCurrentWeight(i);d&&o.push(d)}if(!o.length)return 0;if(o.sort(),o.length<=3)return o.reduce((n,i)=>n+i,0)/o.length;let s=Math.floor(o.length/2);return o.length%2===0?(o[s-1]+o[s])/2:(o[s-1]+o[s]+o[s+1])/3}getWeights(t,e){let r=g.default.min((0,g.default)(t).utc().startOf("day"),(0,g.default)().utc().startOf("day")),o=[],s=0;for(let n=0;n<e;n++){let i=r.subtract(n,"day").toISOString();s=this.getCurrentWeight(i),s&&o.push(s)}return o.reverse(),o}getCalorie(t){return this.getDayStats(t).calories}getCalories(t,e){let r=g.default.min((0,g.default)(t).utc().startOf("day"),(0,g.default)().utc().startOf("day")),o=[],s=0;for(let n=0;n<e;n++){let i=r.subtract(n,"day").toISOString();s=this.getCalorie(i),s&&o.push(s)}return o.reverse(),o}getActivities(t){return this.diaryLog()?.diaryDays.find(e=>e.date===t)?.dayTemplate.activities??[]}addActivity(t){this.diaryLog.update(e=>{let r=p({},e),o=r.diaryDays.find(d=>d.date===t);if(!o){let d=new m(t,new u);r.diaryDays.push(d),o=d}let s=o.dayTemplate.activities,n=(0,g.default)(),i=new E({hour:n.hour(),minute:n.minute(),second:0});return s?.length?s.push(i):o.dayTemplate.activities=[i],r}),this.saveDiaryLog()}removeActivity(t,e){this.diaryLog.update(r=>{let o=p({},r),s=o.diaryDays.find(n=>n.date===t);return s?(s.dayTemplate.activities=s.dayTemplate.activities.filter((n,i)=>i!==e),o):r}),this.saveDiaryLog()}setActivityType(t,e,r){this.diaryLog.update(o=>{let s=p({},o),n=s.diaryDays.find(i=>i.date===t);return n?(n.dayTemplate.activities[e].type=r,s):o}),this.saveDiaryLog()}downloadDiary(){let t=JSON.stringify(this.diaryLog()),e=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(e),o=document.createElement("a");o.href=r,o.download="diary.json",o.click(),URL.revokeObjectURL(r)}setDiary(t){localStorage.setItem("diaryLog",JSON.stringify(t)),this.loadDiaryLog()}static \u0275fac=function(e){return new(e||a)};static \u0275prov=M({token:a,factory:a.\u0275fac,providedIn:"root"})};export{C as a,j as b,q as c,fe as d,N as e,H as f,$ as g,T as h,O as i,f as j,Z as k,ee as l,te as m,ie as n,re as o,ne as p,Te as q,u as r,x as s,Ie as t,G as u,Ve as v,K as w};
