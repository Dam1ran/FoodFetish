import{a as je,b as I}from"./chunk-VW7V5NUT.js";import{b as Je,c as ze,d as le,e as Be,f as $}from"./chunk-KNHICQDQ.js";import{c as He,e as Fe,h as Te,j as We,k as Ee,l as ke,m as Z,n as Ne,o as Re,q as Ve,r as Oe}from"./chunk-QS2R3ZVL.js";import{a as L,f as P,h as j,o as Ae}from"./chunk-JS4BREIP.js";import{a as $e}from"./chunk-7QS2YA2B.js";import{b as Ce,f as Ie,i as Le,k as Pe,s as de}from"./chunk-URU73YWR.js";import{$a as me,$b as xe,Eb as y,Fa as r,Gb as l,Nb as ge,Ob as ue,Pb as ye,Qb as fe,Rb as A,Tb as W,Ub as c,Vb as _e,Wa as w,Wb as g,X as U,Xb as R,Yb as V,Zb as O,_b as ve,aa as x,ac as X,e as Ge,eb as T,ec as z,fa as p,fc as he,ga as m,gc as we,ha as K,hc as be,ib as M,ic as De,jb as C,jc as se,kb as b,mb as D,mc as E,nb as S,ob as f,pb as s,pc as B,qb as d,qc as h,ra as F,rb as v,rc as Se,sa as pe,sb as k,sc as Y,tb as N,vc as Me,xb as _}from"./chunk-IEPN4JXQ.js";var Qe=(n,i)=>({"opacity-25":n,"opacity-5":i}),q=class n{food=h.required();isOdd=h(!1);removeFood=B();updateFoodWeight=B();noRemove=h(!1,{transform:Me});static \u0275fac=function(e){return new(e||n)};static \u0275cmp=w({type:n,selectors:[["food-row"]],inputs:{food:[1,"food"],isOdd:[1,"isOdd"],noRemove:[1,"noRemove"]},outputs:{removeFood:"removeFood",updateFoodWeight:"updateFoodWeight"},decls:17,vars:16,consts:[[1,"d-flex"],["iconSize","16px",1,"btn","btn-outline-warning","mx-1","align-self-center",3,"click","disabled","buttonIcon"],[1,"d-flex","align-items-center","ps-1",2,"min-width","100px","width","20%","font-size","12px"],[1,"row","g-0","fw-light","fst-italic","flex-grow-1","align-self-stretch",2,"font-size","12px"],[1,"col","col-2","align-self-stretch","text-center","align-content-center","m-0"],[1,"col","col-2","align-self-stretch","text-center","align-content-center"],["type","number","inputmode","numeric",1,"form-control","form-control-sm","text-center","p-0","border","border-success-subtle","bg-body","shadow-none",2,"border-radius","4px",3,"blur","value"]],template:function(e,t){if(e&1){let o=_();s(0,"div",0)(1,"button",1),y("click",function(){return p(o),m(!t.noRemove()&&t.removeFood.emit())}),d(),s(2,"div",2),c(3),d(),s(4,"div",3)(5,"div",4),c(6),d(),s(7,"div",5),c(8),d(),s(9,"div",5),c(10),d(),s(11,"div",5),c(12),d(),s(13,"div",5),c(14),d(),s(15,"div",5)(16,"input",6),y("blur",function(u){return p(o),m(t.updateFoodWeight.emit(u.target.value))}),d()()()()}if(e&2){A("bg-body-tertiary",t.isOdd()),r(),W(z(13,Qe,!t.noRemove(),t.noRemove())),f("disabled",t.noRemove())("buttonIcon",t.noRemove()?"":"iconoir:trash"),r(2),g(" ",t.food().name," ");let o=t.food().weight*.01;r(3),g(" ",(t.food().protein*o).toFixed(1)," "),r(2),g(" ",(t.food().carbs*o).toFixed(1)," "),r(2),g(" ",(t.food().fats*o).toFixed(1)," "),r(2),g(" ",(t.food().fiber*o).toFixed(1)," "),r(2),g(" ",(t.food().calories*o).toFixed(1)," "),r(2),f("value",t.food().weight)}},dependencies:[P],encapsulation:2})};var H=class n{stats=h.required();fixedDecimals=h(1);static \u0275fac=function(e){return new(e||n)};static \u0275cmp=w({type:n,selectors:[["total-row"]],inputs:{stats:[1,"stats"],fixedDecimals:[1,"fixedDecimals"]},decls:16,vars:6,consts:[[1,"d-flex"],[1,"fw-bold","text-muted","opacity-75","fst-italic",2,"width","130px"],[1,"row","g-0","flex-grow-1","fw-bold","text-muted","fst-italic","opacity-75",2,"font-size","12px"],[1,"col","col-2","text-center","align-content-center","bg-body-secondary"],[1,"col","col-2","text-center","align-content-center"]],template:function(e,t){e&1&&(k(0,"div",0)(1,"div",1),c(2,"Total"),N(),k(3,"div",2)(4,"div",3),c(5),N(),k(6,"div",4),c(7),N(),k(8,"div",3),c(9),N(),k(10,"div",4),c(11),N(),k(12,"div",3),c(13),N(),k(14,"div",4),c(15),N()()()),e&2&&(r(5),g(" ",t.stats().proteins.toFixed(t.fixedDecimals())," "),r(2),g(" ",t.stats().carbs.toFixed(t.fixedDecimals())," "),r(2),g(" ",t.stats().fats.toFixed(t.fixedDecimals())," "),r(2),g(" ",t.stats().fiber.toFixed(t.fixedDecimals())," "),r(2),g(" ",t.stats().calories.toFixed(t.fixedDecimals())," "),r(2),g(" ",t.stats().weight.toFixed(t.fixedDecimals())," "))},encapsulation:2})};function Ke(n,i){if(n&1){let e=_();s(0,"food-row",15),y("updateFoodWeight",function(o){let a=p(e).$index,u=l();return m(u.updateFoodWeight.emit({foodIndex:a,newWeight:+o}))}),d()}if(n&2){let e=i.$implicit,t=i.$index;f("food",e)("isOdd",t%2!==0)}}var ee=class n{id=F($e());recipe=h.required();updateFoodWeight=B();removeRecipe=B();recipeStats(){return Ae(this.recipe())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=w({type:n,selectors:[["diary-recipe"]],inputs:{recipe:[1,"recipe"]},outputs:{updateFoodWeight:"updateFoodWeight",removeRecipe:"removeRecipe"},decls:18,vars:8,consts:[["collapsible",""],[1,"accordion","accordion-flush",2,"--bs-accordion-active-bg","rgba(7, 60, 130, 0.5)",3,"id"],[1,"accordion-item"],[1,"accordion-header","d-flex","align-items-center"],["buttonIcon","iconoir:trash","iconSize","16px",1,"btn","btn-outline-warning","btn-sm","opacity-25","mx-1",3,"click"],["type","button","data-bs-toggle","collapse",1,"accordion-button","collapsed","p-1","shadow-none"],[1,"opacity-75","w-100","d-flex"],[1,"mx-auto","text-center","text-primary-emphasis","text-truncate"],[1,"d-flex","align-items-center","gap-1","justify-content-center",2,"width","34px"],["icon","icon-park-outline:chart-proportion","size","16px",1,"text-success"],[1,"text-muted",2,"font-size","10px"],[1,"accordion-collapse","collapse","bg-body-secondary",3,"id"],["noRemove","",3,"food","isOdd"],[1,"bg-body"],[3,"stats","fixedDecimals"],["noRemove","",3,"updateFoodWeight","food","isOdd"]],template:function(e,t){if(e&1){let o=_();s(0,"div",1)(1,"div",2)(2,"h2",3)(3,"button",4),y("click",function(){return p(o),m(t.removeRecipe.emit())}),d(),s(4,"button",5)(5,"div",6)(6,"div",7),c(7),d()()(),s(8,"div",8),v(9,"iconify",9),s(10,"div",10),c(11),d()()(),s(12,"div",11,0),D(14,Ke,1,2,"food-row",12,b),s(16,"div",13),v(17,"total-row",14),d()()()()}e&2&&(f("id","accordionFlushRecipe-"+t.id()),r(4),T("data-bs-target","#flush-collapse-"+t.id()),r(3),g(" ",t.recipe().name," "),r(4),_e(t.recipe().portions),r(),f("id","flush-collapse-"+t.id()),T("data-bs-parent","#accordionFlushRecipe-"+t.id()),r(2),S(t.recipe().foods),r(3),f("stats",t.recipeStats())("fixedDecimals",0))},dependencies:[q,H,L,P],encapsulation:2})};var Ue=(n,i,e,t,o)=>({"border-warning":n,"text-primary":i,"fw-bold":e,"fst-normal":t,"bg-body-secondary":o});function Xe(n,i){if(n&1){let e=_();s(0,"div",4),y("click",function(){let o=p(e).$implicit,a=l();return m(a.selectWeekDay(o))}),s(1,"div",5),c(2),d(),v(3,"div",6),d()}if(n&2){let e=i.$implicit,t=i.$index,o=l();W(we(5,Ue,o.isDaySelected(e),o.isTodayLbl(e),o.isTodayLbl(e),o.isTodayLbl(e),t===5||t===6)),r(2),g("",e,"."),r(),fe("background-color",o.getIndicatorStatusColor(e))}}var te=class n{weekdays=["Mo","Tu","We","Th","Fr","Sa","Su"];calendar=x(Re);selectedDate=Y();selectedDayJs=E(()=>I.fromNgbDateStruct(this.selectedDate()));ngOnInit(){this.selectedDate.set(this.calendar.getToday())}isDaySelected(i){let e=I.getStartOfToday();return i===this.weekdays[this.selectedDayJs().day()===0?6:this.selectedDayJs().day()-1]&&e.isoWeek()===this.selectedDayJs().isoWeek()}isTodayLbl(i){let e=I.getStartOfToday();return i===this.weekdays[e.day()===0?6:e.day()-1]}selectWeekDay(i){let e=this.weekdays.indexOf(i);if(I.getStartOfToday().isoWeek()!==this.selectedDayJs().isoWeek())return;let o=this.selectedDayJs().isoWeekday(e+1);this.selectedDate.set({day:o.date(),month:o.month()+1,year:o.year()})}diaryLogService=x($);getIndicatorStatusColor(i){let e=this.diaryLogService.hasFoodOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(i)+1).toISOString()),t=this.diaryLogService.hasWeightInOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(i)+1).toISOString()),o=this.diaryLogService.hasWaterOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(i)+1).toISOString()),a=this.diaryLogService.hasActivitiesOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(i)+1).toISOString());return e&&t&&o&&a?"rgba(60, 140, 70)":e||t||o||a?"rgba(150, 120, 70)":"rgba(90, 90, 90)"}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=w({type:n,selectors:[["weekdays"]],inputs:{selectedDate:[1,"selectedDate"]},outputs:{selectedDate:"selectedDateChange"},decls:5,vars:1,consts:[[1,"bg-secondary-subtle","p-1","user-select-none"],[1,"d-flex","justify-content-between"],[1,"weekday","bg-body","cursor-pointer",3,"class"],[3,"selectedDateChange","selectedDate"],[1,"weekday","bg-body","cursor-pointer",3,"click"],[1,"text-center"],[1,"rounded","m-auto",2,"width","10px","height","10px"]],template:function(e,t){e&1&&(s(0,"div",0)(1,"div",1),D(2,Xe,4,11,"div",2,b),s(4,"date-picker",3),O("selectedDateChange",function(a){return V(t.selectedDate,a)||(t.selectedDate=a),a}),d()()()),e&2&&(r(2),S(t.weekdays),r(2),R("selectedDate",t.selectedDate))},dependencies:[je],styles:[".weekday[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;font-size:14px;border:2px solid transparent;transition:border .3s;font-style:italic}"]})};var ce=Ge(He());var ie=class{weightFormulaBackDays=7};var oe=class n{options=F(new ie);constructor(){this.loadOptions()}loadOptions(){let i=localStorage.getItem("options");i&&this.options.set(JSON.parse(i))}saveOptions(){localStorage.setItem("options",JSON.stringify(this.options()))}setOptions(i){this.options.set(i),this.saveOptions()}static \u0275fac=function(e){return new(e||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ye=(n,i)=>({"text-info-emphasis":n,"text-warning-emphasis":i});function Ze(n,i){if(n&1&&(K(),v(0,"line",10)),n&2){let e=l(),t=e.$implicit,o=e.$index,a=l(3);T("x1",`${96/(a.weights().length-1)*o+2}%`)("y1",`${a.weightsRange()===0?50:(a.weightsMax()+a.weightsRange()*.1-t)/(a.weightsRange()*1.5)*100}%`)("x2",`${96/(a.weights().length-1)*(o+1)+2}%`)("y2",`${a.weightsRange()===0?50:(a.weightsMax()+a.weightsRange()*.1-a.weights()[o+1])/(a.weightsRange()*1.5)*100}%`)}}function et(n,i){if(n&1&&(K(),s(0,"text",11),c(1),d()),n&2){let e=l(),t=e.$implicit,o=e.$index,a=l(3);T("x",`${88/a.Math.max(a.weights().length-1,1)*o+6}%`),r(),g(" ",t.toFixed(1)," ")}}function tt(n,i){if(n&1&&(K(),v(0,"circle",9),M(1,Ze,1,4,":svg:line",10),M(2,et,2,2,":svg:text",11)),n&2){let e=i.$implicit,t=i.$index,o=l(3);T("cx",`${96/o.Math.max(o.weights().length-1,1)*t+2}%`)("cy",`${o.weightsRange()===0?50:(o.weightsMax()+o.weightsRange()*.1-e)/(o.weightsRange()*1.5)*100}%`),r(),C(t<o.weights().length-1?1:-1),r(),C(e?2:-1)}}function it(n,i){if(n&1&&(K(),s(0,"svg",1),D(1,tt,3,4,null,null,b),d()),n&2){let e=l(2);r(),S(e.weights())}}function ot(n,i){if(n&1){let e=_();M(0,it,3,0,":svg:svg",1),s(1,"div",2)(2,"div",3),v(3,"iconify",4),s(4,"div",5),c(5),d()(),s(6,"div",6),v(7,"iconify",7),s(8,"input",8),y("blur",function(o){p(e);let a=l();return m(a.diaryLogService.updateCurrentWeight(a.isoDate(),o.target.value))}),d()()()}if(n&2){let e=l();C(e.weights().length?0:-1),r(5),g(" ",e.diaryLogService.getWeightByFormula(e.isoDate(),e.optionsService.options().weightFormulaBackDays).toFixed(1)," kg "),r(2),W(z(7,Ye,e.diaryLogService.getCurrentWeight(e.isoDate()),!e.diaryLogService.getCurrentWeight(e.isoDate()))),r(),f("placeholder",e.diaryLogService.getCurrentWeight(e.isoDate())?"kg":"?")("disabled",e.weightInputDisabled())("value",e.diaryLogService.getCurrentWeight(e.isoDate()))}}var ne=class n{Math=Math;diaryLogService=x($);optionsService=x(oe);isoDate=h("");weights(){return this.isoDate()?this.diaryLogService.getWeights(this.isoDate(),11):[]}weightsMax=E(()=>Math.max(...this.weights()));weightsMin=E(()=>Math.min(...this.weights()));weightsRange=E(()=>this.weightsMax()-this.weightsMin());weightInputDisabled(){return(0,ce.default)().utc().startOf("day").isBefore((0,ce.default)(this.isoDate()).utc())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=w({type:n,selectors:[["weight-in-widget"]],inputs:{isoDate:[1,"isoDate"]},decls:2,vars:1,consts:[[1,"rounded","bg-body-secondary"],[1,"w-100",2,"pointer-events","none","height","64px"],[1,"d-flex"],[1,"flex-grow-1","px-1","d-flex","align-items-center","mt-3"],["icon","ph:tilde-fill",1,"opacity-50"],[1,"ms-1","fw-semibold","opacity-75",2,"font-size","14px"],[1,"position-relative","d-flex","justify-content-center","align-items-center","overflow-hidden","me-1",2,"width","48px","height","48px"],["icon","iconoir:weight","size","3rem",1,"position-absolute","z-0","opacity-55",2,"transform","scaleX(1.25)"],["type","number","inputmode","numeric",1,"form-control","text-center","p-0","shadow-none","z-1","border-0",2,"width","44px","background-color","transparent","margin-top","10px",3,"blur","placeholder","disabled","value"],["r","4","fill","rgba(from var(--bs-info-text-emphasis) r g b / 0.5)"],["stroke","rgba(from var(--bs-info-text-emphasis) r g b / 0.4)","stroke-width","1"],["y","96%","fill","rgba(from var(--bs-info-text-emphasis) r g b / 0.5)","font-size","12px","font-style","italic","text-anchor","middle"]],template:function(e,t){e&1&&(s(0,"div",0),M(1,ot,9,10),d()),e&2&&(r(),C(t.weightInputDisabled()?-1:1))},dependencies:[L],styles:["input[_ngcontent-%COMP%]{color:var(--bs-info-text-emphasis)}[_ngcontent-%COMP%]::placeholder{color:var(--bs-info-text-emphasis);font-style:italic;opacity:.4}"]})};function nt(n,i){if(n&1){let e=_();s(0,"li")(1,"span",16),y("click",function(){p(e);let o=l().$implicit,a=l().$index,u=l();return m(u.diaryLogService.setActivityType(u.isoDate(),a,o.value))}),c(2),d()()}if(n&2){let e=l().$implicit;r(2),g(" ",e.label," ")}}function at(n,i){if(n&1&&M(0,nt,3,1,"li"),n&2){let e=i.$implicit;C(e.value?0:-1)}}function rt(n,i){if(n&1){let e=_();s(0,"div",5)(1,"button",6),y("click",function(){let o=p(e).$index,a=l();return m(a.diaryLogService.removeActivity(a.isoDate(),o))}),d(),s(2,"div",7)(3,"button",8)(4,"div",9),v(5,"iconify",10),c(6),d()(),s(7,"ul",11),D(8,at,1,1,null,null,b),d(),s(10,"div",12)(11,"ngb-timepicker",13),O("ngModelChange",function(o){let a=p(e).$implicit;return V(a.time,o)||(a.time=o),m(o)}),y("change",function(){p(e);let o=l();return m(o.diaryLogService.saveDiaryLog())}),d()(),s(12,"input",14),O("ngModelChange",function(o){let a=p(e).$implicit;return V(a.durationMinutes,o)||(a.durationMinutes=o),m(o)}),y("blur",function(){p(e);let o=l();return m(o.diaryLogService.saveDiaryLog())}),d()()(),s(13,"div")(14,"input",15),O("ngModelChange",function(o){let a=p(e).$implicit;return V(a.note,o)||(a.note=o),m(o)}),y("blur",function(){p(e);let o=l();return m(o.diaryLogService.saveDiaryLog())}),d()()}if(n&2){let e=i.$implicit,t=l();r(5),f("icon",t.activityTypeIconMap[e.type].icon),r(),g(" ",t.activitiesTypes[e.type].label," "),r(2),S(t.activitiesTypes),r(3),f("spinners",!1),R("ngModel",e.time),r(),R("ngModel",e.durationMinutes),r(2),R("ngModel",e.note)}}var ae=class n{diaryLogService=x($);isoDate=h("");activityTypeIconMap=Be;activitiesTypes=Object.keys(le).filter(i=>!isNaN(Number(i))).map(i=>({label:le[i],value:+i}));static \u0275fac=function(e){return new(e||n)};static \u0275cmp=w({type:n,selectors:[["activity-widget"]],inputs:{isoDate:[1,"isoDate"]},decls:8,vars:0,consts:[[1,"bg-body","rounded","mt-1","rounded","overflow-hidden"],[1,"d-flex","align-items-center","bg-body-tertiary"],[1,"text-muted","text-center","flex-grow-1","opacity-50",2,"font-size","12px"],["iconSize","24px","buttonIcon","iconamoon:sign-plus-bold",1,"btn","btn-sm",3,"click"],[1,"d-flex","flex-column",2,"gap","1px","padding","1px 0px"],[1,"d-flex","align-items-center","rounded-top","overflow-hidden","bg-body-secondary"],["buttonIcon","iconoir:trash","iconSize","16px",1,"btn","btn-outline-warning","btn-sm","opacity-25","ms-1",3,"click"],[1,"px-1","d-flex","align-items-center","justify-content-between","flex-grow-1","p-1","pe-0"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-secondary","dropdown-toggle","flex-grow-1","mx-auto","after-none",2,"max-width","150px","padding","2px 4px"],[1,"d-flex","justify-content-between"],[3,"icon"],[1,"dropdown-menu","p-0","overflow-hidden","shadow-sm",2,"min-width","150px"],[1,"mx-1",2,"padding","2px 0"],["size","small",3,"ngModelChange","change","spinners","ngModel"],["type","number","inputmode","numeric","step","1","min","0","placeholder","m",1,"form-control","form-control-sm","shadow-none","text-center","border","border-info-subtle","rounded-circle","opacity-75","mx-1",2,"width","30px","padding","0",3,"ngModelChange","blur","ngModel"],["type","text","placeholder","Activity note",1,"form-control","form-control-sm","shadow-none","text-center","border-none","rounded-top-0","opacity-75",3,"ngModelChange","blur","ngModel"],[1,"dropdown-item","cursor-pointer","px-2","text-center",3,"click"]],template:function(e,t){e&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),c(3," Activities "),d(),s(4,"button",3),y("click",function(){return t.diaryLogService.addActivity(t.isoDate())}),d()(),s(5,"div",4),D(6,rt,15,6,null,null,b),d()()),e&2&&(r(6),S(t.diaryLogService.getActivities(t.isoDate())))},dependencies:[P,Oe,Z,Fe,Ee,Te,ke,We,L],encapsulation:2})};var re=class n{dayTemplate=F(void 0);constructor(){this.setTemplate(),this.loadDayTemplate()}setTemplate(){if(!localStorage.getItem("dayTemplate")){let e=new ze;e.entries.push({position:1,meal:new j("","Meal I"),recipes:[]}),e.entries.push({position:2,meal:new j("","Meal II"),recipes:[]}),e.entries.push({position:3,meal:new j("","Meal III"),recipes:[]}),e.entries.push({position:4,meal:new j("","Meal IV"),recipes:[]}),e.entries.push({position:5,meal:new j("","Snacks"),recipes:[]}),localStorage.setItem("dayTemplate",JSON.stringify(e))}}loadDayTemplate(){this.dayTemplate.set(JSON.parse(localStorage.getItem("dayTemplate")))}getDayTemplate(){return this.dayTemplate()}static \u0275fac=function(e){return new(e||n)};static \u0275prov=U({token:n,factory:n.\u0275fac,providedIn:"root"})};var st=["editMealNoteDialog"],dt=(n,i,e)=>({"fst-italic":n,"fw-semibold":i,"text-muted":e}),lt=(n,i)=>({"bg-body-secondary":n,"bg-dark-subtle":i});function ct(n,i){n&1&&c(0),n&2&&g(" ",(i/1e3).toFixed(1),"L ")}function pt(n,i){n&1&&c(0," ? ")}function mt(n,i){if(n&1){let e=_();s(0,"div",29)(1,"button",35),y("click",function(){p(e),l();let o=X(0),a=l();return m(a.toggleEditMealNoteDialog(o.id,o.note))}),d(),s(2,"input",36),y("input",function(o){p(e);let a=l().$implicit,u=l();return m(u.updateMealName(a.position,o.target.value))}),d()()}if(n&2){l();let e=X(0);r(),A("btn-outline-success",e.note),r(),f("value",e.name)}}function gt(n,i){if(n&1){let e=_();s(0,"diary-recipe",37),y("updateFoodWeight",function(o){let a=p(e).$index,u=l().$implicit,Q=l();return m(Q.updateRecipeFoodWeight(u.position,a,o.foodIndex,o.newWeight))})("removeRecipe",function(){let o=p(e).$index,a=l().$implicit,u=l();return m(u.removeRecipeFromPosition(a.position,o))}),d()}if(n&2){let e=i.$implicit;f("recipe",e)}}function ut(n,i){if(n&1){let e=_();s(0,"food-row",38),y("removeFood",function(){let o=p(e).$index,a=l().$implicit,u=X(0),Q=l();return m(Q.removeFood(a.position,o,u))})("updateFoodWeight",function(o){let a=p(e).$index,u=l().$implicit,Q=l();return m(Q.updateFoodWeight(u.position,a,o))}),d()}if(n&2){let e=i.$implicit,t=i.$index;f("food",e)("isOdd",t%2!==0)}}function yt(n,i){if(n&1){let e=_();ve(0),s(1,"div",20)(2,"h2",24)(3,"button",25),y("click",function(){let o=p(e).$implicit,a=l();return m(a.toggleExpandedMeal(o.position))}),c(4),d(),s(5,"div",26)(6,"div",27)(7,"div",18),c(8),d(),s(9,"div",18),c(10),d(),s(11,"div",18),c(12),d(),s(13,"div",18),c(14),d(),s(15,"div",18),c(16),d(),s(17,"div",18),c(18),d()()()(),s(19,"div",28,2),M(21,mt,3,3,"div",29),D(22,gt,1,1,"diary-recipe",30,b),D(24,ut,1,2,"food-row",31,b),s(26,"div",32)(27,"button",33),y("click",function(o){let a=p(e).$implicit,u=l();return o.stopPropagation(),m(u.addRecipe(a.position))}),c(28," Add recipe "),d(),s(29,"button",34),y("click",function(o){let a=p(e).$implicit,u=l();return o.stopPropagation(),m(u.addFood(a.position))}),c(30," Add food "),d()()()()}if(n&2){let e=i.$implicit,t=i.$index,o=l(),a=xe(o.getRespectiveMeal(e.position));r(3),A("collapsed",!o.isMealExpanded(e.position)),T("data-bs-target","#flush-collapse"+t),r(),g(" ",o.mealPositionMap[e.position]," "),r(2),W(z(17,lt,!o.isMealExpanded(e.position),o.isMealExpanded(e.position)));let u=o.getPositionStats(e.position);r(2),g(" ",u.proteins.toFixed()," "),r(2),g(" ",u.carbs.toFixed()," "),r(2),g(" ",u.fats.toFixed()," "),r(2),g(" ",u.fiber.toFixed()," "),r(2),g(" ",u.calories.toFixed()," "),r(2),g(" ",u.weight.toFixed()," "),r(),A("show",o.isMealExpanded(e.position)),f("id","flush-collapse"+t),r(2),C(a?21:-1),r(),S(o.getRespectiveRecipes(e.position)),r(2),S(a==null?null:a.foods)}}function ft(n,i){if(n&1){let e=_();s(0,"textarea",39),y("input",function(o){p(e);let a=l();return m(a.updateMealNote(a.editNoteMealId(),o.target.value))}),d()}if(n&2){let e=l();f("value",e.editNoteMeal())}}function _t(n,i){if(n&1){let e=_();s(0,"textarea",40),y("input",function(o){p(e);let a=l();return m(a.diaryLogService.updateDayNote(a.selectedDayJs().toISOString(),o.target.value))}),d()}if(n&2){let e=l();f("value",e.diaryLogService.getDayNote(e.selectedDayJs().toISOString()))}}var qe=class n{diaryDate=h("");selectedDate=Y(void 0);selectedDayJs=E(()=>this.selectedDate()&&I.fromNgbDateStruct(this.selectedDate()));isTodaySelected=E(()=>this.selectedDate()&&I.fromNgbDateStruct(this.selectedDate()).isSame(I.getStartOfToday(),"day"));ngAfterViewInit(){this.diaryDate()&&this.selectedDate.set(I.toNgbDateStruct(this.diaryDate()))}location=x(Ce);activatedRoute=x(Le);constructor(){pe(()=>{if(!this.selectedDate())return;let i=this.selectedDayJs();if(i){let e=this.router.createUrlTree([],{relativeTo:this.activatedRoute,queryParams:{diaryDate:i.toISOString()}}).toString();this.location.go(e)}})}dayTemplateService=x(re);router=x(Pe);addFood(i){this.router.navigate([de.myFoods],{queryParams:{diaryDate:this.selectedDayJs().toISOString(),mealPosition:i}})}addRecipe(i){this.router.navigate([de.recipes],{queryParams:{diaryDate:this.selectedDayJs().toISOString(),mealPosition:i}})}diaryLogService=x($);mealPositionMap=Je;getRespectiveMeal(i){return this.diaryLogService.getRespectiveMeal(this.selectedDayJs().toISOString(),i)}getRespectiveRecipes(i){return this.diaryLogService.getRespectiveRecipes(this.selectedDayJs().toISOString(),i)}updateMealName(i,e){this.diaryLogService.updateMealName(this.selectedDayJs().toISOString(),i,e)}removeFood(i,e,t){this.diaryLogService.removeFood(this.selectedDayJs().toISOString(),i,e),t.foods.length||this.diaryLogService.clearMeal(this.selectedDayJs().toISOString(),i)}updateFoodWeight(i,e,t){this.diaryLogService.updateFoodWeight(this.selectedDayJs().toISOString(),i,e,+t)}getPositionStats(i){return this.diaryLogService.getPositionStats(this.selectedDayJs().toISOString(),i)}getDayStats(){return this.diaryLogService.getDayStats(this.selectedDayJs().toISOString())}toggleExpandedMeal(i){this.diaryLogService.toggleExpandedMeal(this.selectedDayJs().toISOString(),i)}isMealExpanded(i){let e=this.diaryLogService.getExpandedMeal();return e?.isoDate===this.selectedDayJs().toISOString()&&e?.mealPosition===i}modalService=x(Ve);editMealNoteDialogRef=Se("editMealNoteDialog");editNoteMealId=F("");editNoteMeal=F("");toggleEditMealNoteDialog(i,e){this.editNoteMealId.set(i),this.editNoteMeal.set(e),this.modalService.open(this.editMealNoteDialogRef(),{size:"sm",centered:!0}).result.catch(()=>{this.editNoteMealId.set(""),this.editNoteMeal.set("")})}updateMealNote(i,e){this.diaryLogService.updateMealNote(this.selectedDayJs().toISOString(),i,e)}updateRecipeFoodWeight(i,e,t,o){this.diaryLogService.updateRecipeFoodWeight(this.selectedDayJs().toISOString(),i,e,t,o)}removeRecipeFromPosition(i,e){this.diaryLogService.removeRecipeFromPosition(this.selectedDayJs().toISOString(),i,e)}toggleEditDayNoteDialog(i){this.modalService.open(i,{size:"sm",centered:!0})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=w({type:n,selectors:[["diary"]],viewQuery:function(e,t){e&1&&ge(t.editMealNoteDialogRef,st,5),e&2&&ue()},inputs:{diaryDate:[1,"diaryDate"],selectedDate:[1,"selectedDate"]},outputs:{selectedDate:"selectedDateChange"},decls:44,vars:17,consts:[["editMealNoteDialog",""],["editDayNoteDialog",""],["collapsible",""],[1,"content-wrapper"],[1,"bg-body-tertiary","text-center","opacity-75",2,"font-size","14px","line-height","16px"],[3,"selectedDateChange","selectedDate"],[1,"border-bottom"],[1,"d-flex"],[1,"d-flex","justify-content-between","align-items-center","p-1",2,"width","130px"],[1,"btn","p-0","opacity-75","d-flex","justify-content-between","rounded",2,"border","1px solid transparent",3,"click"],["icon","iconoir:notes"],[1,"d-flex","align-items-center"],[1,"btn","p-0","d-flex","justify-content-between","position-relative",2,"width","fit-content",3,"click"],["size","16px","icon","iconamoon:sign-minus-bold",1,"position-absolute","z-1","translate-middle","top-50","start-50","text-info-emphasis"],["icon","mdi:glass-outline",1,"z-0","opacity-30"],[1,"text-center","rounded",2,"width","40px"],["size","16px","icon","iconamoon:sign-plus-bold",1,"position-absolute","z-1","translate-middle","top-50","start-50","text-info-emphasis"],[1,"row","g-0","flex-grow-1","fw-bold","text-muted","fst-italic","opacity-25","bg-body-secondary",2,"font-size","12px"],[1,"col","col-2","align-self-center","text-center"],["id","accordionFlush",1,"accordion","accordion-flush"],[1,"accordion-item"],[3,"stats","fixedDecimals"],[1,"mt-1","d-block",3,"isoDate"],[3,"isoDate"],[1,"accordion-header","d-flex","align-items-center"],["type","button","data-bs-toggle","collapse",1,"accordion-button","p-1","text-truncate","text-muted","fw-bold","opacity-75","shadow-none",2,"width","130px",3,"click"],[1,"flex-grow-1","align-self-stretch"],[1,"row","g-0","h-100","fw-light","fst-italic",2,"font-size","12px","transition","background-color 0.3s"],["data-bs-parent","#accordionFlush",1,"accordion-collapse","collapse","bg-body-secondary","rounded",3,"id"],[1,"d-flex","align-items-center","p-1","gap-1","bg-body-tertiary"],[3,"recipe"],[3,"food","isOdd"],[1,"p-1","bg-body-tertiary","d-flex","gap-1"],["buttonIcon","pajamas:recipe","iconSize","24px",1,"btn","btn-outline-primary","btn-sm","opacity-60","flex-grow-1",3,"click"],["buttonIcon","iconoir:lens-plus","iconSize","24px",1,"btn","btn-outline-success","btn-sm","opacity-80","flex-grow-1",3,"click"],["buttonIcon","iconoir:notes","iconSize","16px",1,"btn","btn-outline-secondary",3,"click"],["type","text",1,"form-control","form-control-sm","shadow-none","text-center","bg-dark-subtle",3,"input","value"],[3,"updateFoodWeight","removeRecipe","recipe"],[3,"removeFood","updateFoodWeight","food","isOdd"],["rows","3","placeholder","Meal note",1,"form-control","form-control-sm","text-center",3,"input","value"],["rows","3","placeholder","Day note",1,"form-control","form-control-sm","text-center",3,"input","value"]],template:function(e,t){if(e&1){let o=_();s(0,"div",3)(1,"div",4),c(2),be(3,"date"),d(),s(4,"weekdays",5),O("selectedDateChange",function(u){return p(o),V(t.selectedDate,u)||(t.selectedDate=u),m(u)}),d(),v(5,"div",6),s(6,"div",7)(7,"div",8)(8,"button",9),y("click",function(){p(o);let u=ye(43);return m(t.toggleEditDayNoteDialog(u))}),v(9,"iconify",10),d(),s(10,"div",11)(11,"button",12),y("click",function(){return p(o),m(t.diaryLogService.subtractDayWater(t.selectedDayJs().toISOString(),100))}),v(12,"iconify",13)(13,"iconify",14),d(),s(14,"div",15),M(15,ct,1,1)(16,pt,1,0),d(),s(17,"button",12),y("click",function(){return p(o),m(t.diaryLogService.addDayWater(t.selectedDayJs().toISOString(),100))}),v(18,"iconify",16)(19,"iconify",14),d()()(),s(20,"div",17)(21,"div",18),c(22,"P"),d(),s(23,"div",18),c(24,"C"),d(),s(25,"div",18),c(26,"Fa"),d(),s(27,"div",18),c(28,"Fi"),d(),s(29,"div",18),c(30,"KCal"),d(),s(31,"div",18),c(32,"G"),d()()(),v(33,"div",6),s(34,"div",19),D(35,yt,31,20,"div",20,b),d(),v(37,"total-row",21)(38,"weight-in-widget",22)(39,"activity-widget",23),d(),me(40,ft,1,1,"ng-template",null,0,se)(42,_t,1,1,"ng-template",null,1,se)}if(e&2){let o,a;r(),W(he(13,dt,!t.isTodaySelected(),t.isTodaySelected(),!t.isTodaySelected())),r(),g(" ",De(3,11,(o=t.selectedDayJs())==null?null:o.toISOString())," "),r(2),R("selectedDate",t.selectedDate),r(4),A("btn-outline-info",t.diaryLogService.getDayNote(t.selectedDayJs().toISOString())),r(7),C((a=t.diaryLogService.getDayWater(t.selectedDayJs().toISOString()))?15:16,a),r(20),S(t.dayTemplateService.getDayTemplate().entries),r(2),f("stats",t.getDayStats())("fixedDecimals",0),r(),f("isoDate",t.selectedDayJs().toISOString()),r(),f("isoDate",t.selectedDayJs().toISOString())}},dependencies:[P,Ne,Z,q,ee,H,te,ne,L,ae,Ie],encapsulation:2})};export{qe as Diary};
