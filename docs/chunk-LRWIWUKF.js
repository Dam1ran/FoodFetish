import{p as h}from"./chunk-ZSUZL2E2.js";import{a as l}from"./chunk-7QS2YA2B.js";import{X as p,a as d,aa as g,b as a,ra as f}from"./chunk-4ENOABGI.js";var m=class r{foods=f([]);constructor(){this.loadFoods()}loadFoods(){let o=localStorage.getItem("foods");o?this.foods.set(JSON.parse(o)):this.foods.set([])}addEditFood(o){this.foods().find(t=>t.id===o.id)?this.foods.update(t=>t.map(e=>e.id===o.id?o:e)):this.foods.update(t=>[...t,a(d({},o),{id:o.id||l()})]),localStorage.setItem("foods",JSON.stringify(this.foods()))}deleteFood(o){this.foods.update(s=>s.filter(t=>t.id!==o.id)),localStorage.setItem("foods",JSON.stringify(this.foods()))}downloadFoods(){let o=JSON.stringify(this.foods()),s=new Blob([o],{type:"application/json"}),t=URL.createObjectURL(s),e=document.createElement("a");e.href=t,e.download="foods.json",e.click(),URL.revokeObjectURL(t)}setFoods(o){localStorage.setItem("foods",JSON.stringify(o)),this.loadFoods()}getFoodById(o){return this.foods().find(s=>s.id===o)}static \u0275fac=function(s){return new(s||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})};var u=class r{foodsService=g(m);recipes=f([]);constructor(){this.loadRecipes()}loadRecipes(){let o=localStorage.getItem("recipes");o?this.recipes.set(JSON.parse(o)):this.recipes.set([])}saveRecipes(){localStorage.setItem("recipes",JSON.stringify(this.recipes()))}setRecipes(o){localStorage.setItem("recipes",JSON.stringify(o)),this.loadRecipes()}downloadRecipes(){let o=JSON.stringify(this.recipes()),s=new Blob([o],{type:"application/json"}),t=URL.createObjectURL(s),e=document.createElement("a");e.href=t,e.download="recipes.json",e.click(),URL.revokeObjectURL(t)}addRecipe(){this.recipes.update(o=>[new h(l(),"Empty recipe"),...o]),this.saveRecipes()}updateRecipeName(o,s){this.recipes.update(t=>t.map(e=>e.id===o?a(d({},e),{name:s}):e)),this.saveRecipes()}updateRecipeNote(o,s){this.recipes.update(t=>t.map(e=>e.id===o?a(d({},e),{note:s}):e)),this.saveRecipes()}addFood(o,s){this.recipes.update(t=>t.map(e=>{if(e.id===o){let i=this.foodsService.getFoodById(s);if(i)return a(d({},e),{foods:[...e.foods,d({},i)]})}return e})),this.saveRecipes()}updateFoodWeight(o,s,t){this.recipes.update(e=>e.map(i=>i.id===o?a(d({},i),{foods:i.foods.map((n,c)=>c===s?a(d({},n),{weight:+t}):n)}):i)),this.saveRecipes()}updateRecipePortions(o,s){this.recipes.update(t=>t.map(e=>e.id===o?a(d({},e),{portions:+s}):e)),this.saveRecipes()}removeFood(o,s){this.recipes.update(t=>t.map(e=>e.id===o?a(d({},e),{foods:e.foods.filter((i,n)=>n!==s)}):e)),this.recipes().find(t=>t.id===o&&t.foods.length===0)&&this.recipes.update(t=>t.filter(e=>e.id!==o)),this.saveRecipes()}changeFoodOrder(o,s,t){this.recipes.update(e=>e.map(i=>i.id===o?a(d({},i),{foods:i.foods.map((n,c)=>c===s?i.foods[t]:c===t?i.foods[s]:i.foods[c])}):i)),this.saveRecipes()}getRecipeById(o){return this.recipes().find(s=>s.id===o)}static \u0275fac=function(s){return new(s||r)};static \u0275prov=p({token:r,factory:r.\u0275fac,providedIn:"root"})};export{m as a,u as b};
