import{c as E}from"./chunk-QS2R3ZVL.js";import{d as W,g as b,h as m,p as C}from"./chunk-JS4BREIP.js";import{a as h}from"./chunk-7QS2YA2B.js";import{X as S,a as y,e as I,ra as N}from"./chunk-IEPN4JXQ.js";var D=(e=>(e[e.None=0]="None",e[e.MealOne=1]="MealOne",e[e.MealTwo=2]="MealTwo",e[e.MealThree=3]="MealThree",e[e.MealFour=4]="MealFour",e[e.Snacks=5]="Snacks",e))(D||{}),L={0:"None",1:"Meal I",2:"Meal II",3:"Meal III",4:"Meal IV",5:"Snacks"};var g=I(E());var v=class{diaryDays=[]};var p=class{entries=[];weight;note;waterMl;activities=[]},f=class{constructor(i=0,r=new m,a=[]){this.position=i;this.meal=r;this.recipes=a}};var l=class{constructor(i,r=new p){this.date=i;this.dayTemplate=r}};var w=class{constructor(i,r=0,a=15,n){this.time=i;this.type=r;this.durationMinutes=a;this.note=n}},O=(t=>(t[t.None=0]="None",t[t.Walk=1]="Walk",t[t.Aerobics=2]="Aerobics",t[t.Cardio=3]="Cardio",t[t.Sports=4]="Sports",t[t.Workout=5]="Workout",t[t.Other=6]="Other",t))(O||{}),B={0:{icon:"fluent:border-none-24-filled"},1:{icon:"fa-solid:walking"},2:{icon:"icon-park-solid:sport"},3:{icon:"tabler:run"},4:{icon:"icon-park-solid:sporting"},5:{icon:"streamline-plump:dumbell-solid"},6:{icon:"hugeicons:activity-01"}};var x=class u{diaryLog=N(void 0);constructor(){this.setDiaryLog(),this.loadDiaryLog()}setDiaryLog(){if(!localStorage.getItem("diaryLog")){let r=new v;localStorage.setItem("diaryLog",JSON.stringify(r))}}loadDiaryLog(){this.diaryLog.set(JSON.parse(localStorage.getItem("diaryLog")))}getRespectiveMeal(i,r){return this.diaryLog()?.diaryDays.find(a=>a.date===i)?.dayTemplate.entries.find(a=>a.position===r)?.meal}getRespectiveRecipes(i,r){return this.diaryLog()?.diaryDays.find(a=>a.date===i)?.dayTemplate.entries.find(a=>a.position===r)?.recipes}addFood(i,r,a){a=y({},a),r=Number(r),this.diaryLog.update(n=>{let s=y({},n),e=s.diaryDays.find(o=>o.date===i);if(!e){let o=new l(i,new p);s.diaryDays.push(o),e=o}let t=e.dayTemplate.entries.find(o=>o.position===r);return t?t.meal.foods.push(a):(t=new f(r,new m(h(),L[r],[a]),[]),e.dayTemplate.entries.push(t)),s}),this.saveDiaryLog()}saveDiaryLog(){localStorage.setItem("diaryLog",JSON.stringify(this.diaryLog(),(i,r)=>i==="position"&&typeof r=="string"?D[r]:r))}updateMealName(i,r,a){this.diaryLog.update(n=>{let s=y({},n),e=s.diaryDays.find(o=>o.date===i);if(!e)return n;let t=e.dayTemplate.entries.find(o=>o.position===r);return t?(t.meal.name=a,s):n}),this.saveDiaryLog()}removeFood(i,r,a){this.diaryLog.update(n=>{let s=y({},n),e=s.diaryDays.find(o=>o.date===i);if(!e)return n;let t=e.dayTemplate.entries.find(o=>o.position===r);return t?(t.meal.foods=t.meal.foods.filter((o,c)=>c!==a),s):n}),this.saveDiaryLog()}removeRecipeFromPosition(i,r,a){this.diaryLog.update(n=>{let s=y({},n),e=s.diaryDays.find(o=>o.date===i);if(!e)return n;let t=e.dayTemplate.entries.find(o=>o.position===r);return t?(t.recipes=t.recipes.filter((o,c)=>c!==a),s):n}),this.saveDiaryLog()}updateRecipeFoodWeight(i,r,a,n,s){this.diaryLog.update(e=>{let t=y({},e),o=t.diaryDays.find(M=>M.date===i);if(!o)return e;let c=o.dayTemplate.entries.find(M=>M.position===r);if(!c)return e;let d=c.recipes?.[a];if(!d)return e;let T=d.foods?.[n];return T?(T.weight=Number(s),t):e}),this.saveDiaryLog()}clearMeal(i,r){this.diaryLog.update(a=>{let n=y({},a),s=n.diaryDays.find(t=>t.date===i);return!s||!s.dayTemplate.entries.find(t=>t.position===r)?a:(s.dayTemplate.entries=s.dayTemplate.entries.filter(t=>t.position!==r),n)}),this.saveDiaryLog()}updateFoodWeight(i,r,a,n){this.diaryLog.update(s=>{let e=y({},s),t=e.diaryDays.find(c=>c.date===i);if(!t)return s;let o=t.dayTemplate.entries.find(c=>c.position===r);return o?(o.meal.foods[a].weight=Number(n),e):s}),this.saveDiaryLog()}getDayStats(i){let r=this.diaryLog()?.diaryDays.find(n=>n.date===i),a=new b;if(!r)return a;for(let n of r.dayTemplate.entries){let s=[...n.meal.foods,...n.recipes.flatMap(e=>e.foods)];a.proteins+=s.reduce((e,t)=>e+t.protein*t.weight*.01,0),a.carbs+=s.reduce((e,t)=>e+t.carbs*t.weight*.01,0),a.fats+=s.reduce((e,t)=>e+t.fats*t.weight*.01,0),a.fiber+=s.reduce((e,t)=>e+t.fiber*t.weight*.01,0),a.calories+=s.reduce((e,t)=>e+t.calories*t.weight*.01,0),a.weight+=s.reduce((e,t)=>e+t.weight,0)}return a}getDayNote(i){return this.diaryLog()?.diaryDays?.find(r=>r.date===i)?.dayTemplate?.note??null}updateDayNote(i,r){this.diaryLog.update(a=>{let n=y({},a),s=n.diaryDays.find(e=>e.date===i);if(!s){let e=new l(i,new p);n.diaryDays.push(e),s=e}return s.dayTemplate.note=r,n}),this.saveDiaryLog()}getDayWater(i){return this.diaryLog()?.diaryDays?.find(r=>r.date===i)?.dayTemplate?.waterMl??null}updateDayWater(i,r){this.diaryLog.update(a=>{let n=y({},a),s=n.diaryDays.find(e=>e.date===i);if(!s){let e=new l(i,new p);n.diaryDays.push(e),s=e}return r?s.dayTemplate.waterMl=Number(r):delete s.dayTemplate.waterMl,n}),this.saveDiaryLog()}addDayWater(i,r){this.updateDayWater(i,(this.getDayWater(i)+r).toString())}subtractDayWater(i,r){let a=this.getDayWater(i);a<=r?this.updateDayWater(i,""):this.updateDayWater(i,(a-r).toString())}getPositionStats(i,r){let a=this.diaryLog()?.diaryDays.find(t=>t.date===i),n=new b;if(!a)return n;let s=a.dayTemplate.entries.find(t=>t.position===r);if(!s)return n;let e=[...s.meal.foods,...s.recipes.flatMap(t=>t.foods)];return{proteins:e.reduce((t,o)=>t+o.protein*o.weight*.01,0),carbs:e.reduce((t,o)=>t+o.carbs*o.weight*.01,0),fats:e.reduce((t,o)=>t+o.fats*o.weight*.01,0),fiber:e.reduce((t,o)=>t+o.fiber*o.weight*.01,0),calories:e.reduce((t,o)=>t+o.calories*o.weight*.01,0),weight:e.reduce((t,o)=>t+o.weight,0)}}updateMealNote(i,r,a){this.diaryLog.update(n=>{let s=y({},n),e=s.diaryDays.find(o=>o.date===i);if(!e)return n;let t=e.dayTemplate.entries.find(o=>o.meal.id===r);return t?(t.meal.note=a,s):n}),this.saveDiaryLog()}getExpandedMeal(){let i=localStorage.getItem("expandedMeal");return i?JSON.parse(i):null}toggleExpandedMeal(i,r){let a=this.getExpandedMeal();localStorage.setItem("expandedMeal",JSON.stringify({isoDate:a?.isoDate===i&&a?.mealPosition===r?"":i,mealPosition:a?.isoDate===i&&a?.mealPosition===r?0:r}))}expandMeal(i,r){localStorage.setItem("expandedMeal",JSON.stringify({isoDate:i,mealPosition:r}))}addRecipe(i,r,a,n){this.diaryLog.update(s=>{let e=y({},s),t=e.diaryDays.find(d=>d.date===i);if(!t){let d=new l(i,new p);e.diaryDays.push(d),t=d}let o=t.dayTemplate.entries.find(d=>d.position===r),c=new C(h(),n.name,n.foods.map(d=>new W(d.id,d.name,d.macroCategory,d.protein,d.carbs,d.fats,d.fiber,d.calories,d.weight*(a/n.portions),d.note)),a,n.note);return o?o.recipes.push(c):(o=new f(r,new m(h(),L[r],[]),[c]),t.dayTemplate.entries.push(o)),e}),this.saveDiaryLog()}hasFoodOnDate(i){let r=this.diaryLog()?.diaryDays.find(a=>a.date===i);if(!r)return!1;for(let a of r.dayTemplate.entries)if(a.meal.foods.length>0||a.recipes.length>0)return!0;return!1}hasWeightInOnDate(i){return!!this.diaryLog()?.diaryDays.find(r=>r.date===i)?.dayTemplate?.weight}hasWaterOnDate(i){return!!this.diaryLog()?.diaryDays.find(r=>r.date===i)?.dayTemplate?.waterMl}getCurrentWeight(i){let r=this.diaryLog()?.diaryDays.find(a=>a.date===i);return r?r.dayTemplate.weight??null:null}updateCurrentWeight(i,r){this.diaryLog.update(a=>{let n=y({},a),s=n.diaryDays.find(e=>e.date===i);if(!s){let e=new l(i,new p);n.diaryDays.push(e),s=e}return r?s.dayTemplate.weight=Number(r):delete s.dayTemplate.weight,n}),this.saveDiaryLog()}getWeightByFormula(i,r){let a=(0,g.default)(i).utc(),n=[];for(let e=0;e<r;e++){let t=a.subtract(e,"day").toISOString(),o=this.getCurrentWeight(t);o&&n.push(o)}if(!n.length)return 0;if(n.sort(),n.length<=3)return n.reduce((e,t)=>e+t,0)/n.length;let s=Math.floor(n.length/2);return n.length%2===0?(n[s-1]+n[s])/2:(n[s-1]+n[s]+n[s+1])/3}getWeights(i,r){let a=g.default.min((0,g.default)(i).utc().startOf("day"),(0,g.default)().utc().startOf("day")),n=[],s=0;for(let e=0;e<r;e++){let t=a.subtract(e,"day").toISOString();s=this.getCurrentWeight(t),s&&n.push(s)}return n.reverse(),n}getActivities(i){return this.diaryLog()?.diaryDays.find(r=>r.date===i)?.dayTemplate.activities??[]}addActivity(i){this.diaryLog.update(r=>{let a=y({},r),n=a.diaryDays.find(o=>o.date===i);if(!n){let o=new l(i,new p);a.diaryDays.push(o),n=o}let s=n.dayTemplate.activities,e=(0,g.default)(),t=new w({hour:e.hour(),minute:e.minute(),second:0});return s?.length?s.push(t):n.dayTemplate.activities=[t],a}),this.saveDiaryLog()}removeActivity(i,r){this.diaryLog.update(a=>{let n=y({},a),s=n.diaryDays.find(e=>e.date===i);return s?(s.dayTemplate.activities=s.dayTemplate.activities.filter((e,t)=>t!==r),n):a}),this.saveDiaryLog()}setActivityType(i,r,a){this.diaryLog.update(n=>{let s=y({},n),e=s.diaryDays.find(t=>t.date===i);return e?(e.dayTemplate.activities[r].type=a,s):n}),this.saveDiaryLog()}static \u0275fac=function(r){return new(r||u)};static \u0275prov=S({token:u,factory:u.\u0275fac,providedIn:"root"})};export{D as a,L as b,p as c,O as d,B as e,x as f};
