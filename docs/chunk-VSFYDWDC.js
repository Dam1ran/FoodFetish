import{a as it,b as ot,c as nt,d as rt}from"./chunk-GNB2QRYG.js";import{a as gt,b as ut}from"./chunk-MF6VI77C.js";import{e as ne}from"./chunk-KUOMSHLI.js";import{a as pt}from"./chunk-WQBYX4JC.js";import{a as J,b as mt}from"./chunk-ET3JPIE6.js";import{a as A}from"./chunk-3OJFEKT3.js";import{B as se,C as ve,D as at,K as dt,L as lt,N as We,O as st,P as V,Q as ct,c as xt,e as _e,h as ie,j as oe,k as He,l as Qe,m as H,n as Xe,o as Ze,q as Ue,r as ye,s as fe,v as xe,w as et,z as tt}from"./chunk-PXXMBKHJ.js";import{b as Ge,f as qe,j as Ye,l as Ke,t as ke}from"./chunk-MAWMYTZY.js";import{a as Q}from"./chunk-TTUD5ZDE.js";import{$b as Te,Fb as u,Ga as a,Hb as s,Ob as pe,Pb as me,Qb as Fe,Rb as j,Sb as B,Tb as Le,Ub as z,Vb as c,Wb as Oe,X as Re,Xa as D,Xb as _,Yb as L,Zb as O,_b as $,aa as b,ab as Pe,ac as Ie,bc as G,e as ft,ec as $e,fa as m,fb as W,fc as ee,ga as g,gc as Be,ha as Y,hc as ge,ic as ze,jb as f,jc as Ae,kb as x,kc as Ee,lb as T,nb as I,nc as k,ob as E,pb as y,qb as d,qc as Z,ra as P,rb as l,rc as S,sa as ce,sb as v,sc as ue,tb as C,ub as w,uc as te,vb as K,vc as Je,xc as je,yb as h}from"./chunk-HXGKTDM5.js";var vt=["weightInput"],bt=(n,i)=>({"opacity-25":n,"opacity-5":i}),re=class n{food=S.required();isOdd=S(!1);removeFood=Z();updateFoodWeight=Z();noRemove=S(!1,{transform:je});focusWeight=S(!1);weightInput=ue("weightInput");ngAfterViewInit(){this.focusWeight()&&this.weightInput().nativeElement.focus()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["food-row"]],viewQuery:function(e,t){e&1&&pe(t.weightInput,vt,5),e&2&&me()},inputs:{food:[1,"food"],isOdd:[1,"isOdd"],noRemove:[1,"noRemove"],focusWeight:[1,"focusWeight"]},outputs:{removeFood:"removeFood",updateFoodWeight:"updateFoodWeight"},decls:18,vars:16,consts:[["weightInput",""],[1,"d-flex"],["iconSize","16px",1,"btn","btn-outline-warning","mx-1","align-self-center","border-0",3,"click","disabled","buttonIcon"],[1,"d-flex","align-items-center","ps-1",2,"min-width","100px","width","20%","font-size","12px"],[1,"row","g-0","fw-light","fst-italic","flex-grow-1","align-self-stretch",2,"font-size","12px"],[1,"col","col-2","align-self-stretch","text-center","align-content-center","m-0"],[1,"col","col-2","align-self-stretch","text-center","align-content-center"],["type","number","inputmode","numeric",1,"form-control","form-control-sm","text-center","p-0","border","border-success-subtle","bg-body","shadow-none",2,"border-radius","4px",3,"blur","value"]],template:function(e,t){if(e&1){let o=h();d(0,"div",1)(1,"button",2),u("click",function(){return m(o),g(!t.noRemove()&&t.removeFood.emit())}),l(),d(2,"div",3),c(3),l(),d(4,"div",4)(5,"div",5),c(6),l(),d(7,"div",6),c(8),l(),d(9,"div",6),c(10),l(),d(11,"div",6),c(12),l(),d(13,"div",6),c(14),l(),d(15,"div",6)(16,"input",7,0),u("blur",function(p){return m(o),g(t.updateFoodWeight.emit(p.target.value))}),l()()()()}if(e&2){B("bg-body-tertiary",t.isOdd()),a(),z(ee(13,bt,!t.noRemove(),t.noRemove())),y("disabled",t.noRemove())("buttonIcon",t.noRemove()?"":"iconoir:trash"),a(2),_(" ",t.food().name," ");let o=t.food().weight*.01;a(3),_(" ",(t.food().protein*o).toFixed(1)," "),a(2),_(" ",(t.food().carbs*o).toFixed(1)," "),a(2),_(" ",(t.food().fats*o).toFixed(1)," "),a(2),_(" ",(t.food().fiber*o).toFixed(1)," "),a(2),_(" ",(t.food().calories*o).toFixed(1)," "),a(2),y("value",t.food().weight)}},dependencies:[A],encapsulation:2})};function ht(n,i){if(n&1&&c(0),n&2){let e=s();_(" ",i.toFixed(e.fixedDecimals())," ")}}function wt(n,i){if(n&1&&c(0),n&2){let e=s();_(" ",i.toFixed(e.fixedDecimals())," ")}}function St(n,i){if(n&1&&c(0),n&2){let e=s();_(" ",i.toFixed(e.fixedDecimals())," ")}}function Dt(n,i){if(n&1&&c(0),n&2){let e=s();_(" ",i.toFixed(e.fixedDecimals())," ")}}function Ct(n,i){if(n&1&&c(0),n&2){let e=s();_(" ",i.toFixed(e.fixedDecimals())," ")}}function Mt(n,i){if(n&1&&c(0),n&2){let e=s();_(" ",i.toFixed(e.fixedDecimals())," ")}}var ae=class n{stats=S.required();fixedDecimals=S(1);static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["total-row"]],inputs:{stats:[1,"stats"],fixedDecimals:[1,"fixedDecimals"]},decls:16,vars:6,consts:[[1,"d-flex"],[1,"fw-semibold","text-muted","opacity-35","fst-italic","text-center",2,"width","130px"],[1,"row","g-0","flex-grow-1","fw-bold","text-muted","fst-italic","opacity-75",2,"font-size","13px"],[1,"col","col-2","text-center","align-content-center",2,"color","rgb(80, 100, 240)"],[1,"col","col-2","text-center","align-content-center",2,"color","rgb(220, 220, 90)"],[1,"col","col-2","text-center","align-content-center",2,"color","rgb(200, 160, 30)"],[1,"col","col-2","text-center","align-content-center",2,"color","rgb(100, 130, 20)"],[1,"col","col-2","text-center","align-content-center",2,"color","rgb(150, 140, 180)"],[1,"col","col-2","text-center","align-content-center",2,"color","rgb(90, 90, 90)"]],template:function(e,t){if(e&1&&(C(0,"div",0)(1,"div",1),c(2," Total "),w(),C(3,"div",2)(4,"div",3),f(5,ht,1,1),w(),C(6,"div",4),f(7,wt,1,1),w(),C(8,"div",5),f(9,St,1,1),w(),C(10,"div",6),f(11,Dt,1,1),w(),C(12,"div",7),f(13,Ct,1,1),w(),C(14,"div",8),f(15,Mt,1,1),w()()()),e&2){let o,r,p,N,de,le;a(5),x((o=t.stats().proteins)?5:-1,o),a(2),x((r=t.stats().carbs)?7:-1,r),a(2),x((p=t.stats().fats)?9:-1,p),a(2),x((N=t.stats().fiber)?11:-1,N),a(2),x((de=t.stats().calories)?13:-1,de),a(2),x((le=t.stats().weight)?15:-1,le)}},encapsulation:2})};function Ft(n,i){if(n&1){let e=h();d(0,"food-row",17),u("updateFoodWeight",function(o){let r=m(e).$index,p=s();return g(p.updateFoodWeight.emit({foodIndex:r,newWeight:+o}))})("removeFood",function(){let o=m(e).$index,r=s();return g(r.removeFood.emit(o))}),l()}if(n&2){let e,t=i.$implicit,o=i.$index,r=s();y("food",t)("isOdd",o%2!==0)("noRemove",((e=r.recipe().foods)==null?null:e.length)===1)}}var be=class n{id=P(xe());recipe=S.required();updateFoodWeight=Z();removeFood=Z();removeRecipe=Z();recipeStats(){return dt(this.recipe())}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["diary-recipe"]],inputs:{recipe:[1,"recipe"]},outputs:{updateFoodWeight:"updateFoodWeight",removeFood:"removeFood",removeRecipe:"removeRecipe"},decls:20,vars:8,consts:[["collapsible",""],[1,"accordion","accordion-flush",2,"--bs-accordion-active-bg","rgba(7, 60, 130, 0.5)",3,"id"],[1,"accordion-item"],[1,"accordion-header","d-flex","align-items-stretch"],[1,"d-flex","align-items-center",2,"background-color","rgba(40, 20, 30, 0.5)"],["buttonIcon","iconoir:trash","iconSize","16px",1,"btn","btn-outline-warning","btn-sm","opacity-25","mx-1","border-0",3,"click"],["type","button","data-bs-toggle","collapse",1,"accordion-button","collapsed","p-2","shadow-none",2,"background-color","rgba(40, 20, 30, 0.5)"],[1,"opacity-75","w-100","d-flex"],[1,"mx-auto","text-center","text-primary-emphasis","text-truncate","fst-italic"],[1,"d-flex","align-items-center","gap-1","justify-content-center","flex-shrink-0","flex-grow-1",2,"width","11.5%","max-width","98px","background-color","rgba(40, 20, 30, 0.5)"],["icon","icon-park-outline:chart-proportion","size","16px",1,"text-success-emphasis"],[1,"text-muted","fst-italic",2,"font-size","10px","margin-left","-2px"],[1,"accordion-collapse","collapse",3,"id"],[1,"d-flex","flex-column","py-1","gap-1"],[3,"food","isOdd","noRemove"],[1,"bg-body"],[3,"stats","fixedDecimals"],[3,"updateFoodWeight","removeFood","food","isOdd","noRemove"]],template:function(e,t){if(e&1){let o=h();d(0,"div",1)(1,"div",2)(2,"h2",3)(3,"div",4)(4,"button",5),u("click",function(){return m(o),g(t.removeRecipe.emit())}),l()(),d(5,"button",6)(6,"div",7)(7,"div",8),c(8),l()()(),d(9,"div",9),v(10,"iconify",10),d(11,"div",11),c(12),l()()(),d(13,"div",12,0)(15,"div",13),I(16,Ft,1,3,"food-row",14,T),l(),d(18,"div",15),v(19,"total-row",16),l()()()()}e&2&&(y("id","accordionFlushRecipe-"+t.id()),a(5),W("data-bs-target","#flush-collapse-"+t.id()),a(3),_(" ",t.recipe().name," "),a(4),_(" ",t.recipe().portions," "),a(),y("id","flush-collapse-"+t.id()),W("data-bs-parent","#accordionFlushRecipe-"+t.id()),a(3),E(t.recipe().foods),a(3),y("stats",t.recipeStats())("fixedDecimals",0))},dependencies:[re,ae,Q,A],encapsulation:2})};var Tt=(n,i,e,t,o)=>({"border-warning":n,"text-primary":i,"fw-bold":e,"fst-normal":t,"bg-body-secondary":o});function It(n,i){if(n&1){let e=h();d(0,"div",4),u("click",function(){let o=m(e).$implicit,r=s();return g(r.selectWeekDay(o))}),d(1,"div",5),c(2),l(),v(3,"div",6),l()}if(n&2){let e=i.$implicit,t=i.$index,o=s();z(ge(5,Tt,o.isDaySelected(e),o.isTodayLbl(e),o.isTodayLbl(e),o.isTodayLbl(e),t===5||t===6)),a(2),_("",e,"."),a(),j("background-color",o.getIndicatorStatusColor(e))}}var he=class n{weekdays=["Mo","Tu","We","Th","Fr","Sa","Su"];calendar=b(Ze);selectedDate=te();selectedDayJs=k(()=>J.fromNgbDateStruct(this.selectedDate()));ngOnInit(){this.selectedDate.set(this.calendar.getToday())}isDaySelected(i){let e=J.getStartOfToday();return i===this.weekdays[this.selectedDayJs().day()===0?6:this.selectedDayJs().day()-1]&&e.isoWeek()===this.selectedDayJs().isoWeek()}isTodayLbl(i){let e=J.getStartOfToday();return i===this.weekdays[e.day()===0?6:e.day()-1]}selectWeekDay(i){let e=this.weekdays.indexOf(i);if(J.getStartOfToday().isoWeek()!==this.selectedDayJs().isoWeek())return;let o=this.selectedDayJs().isoWeekday(e+1);this.selectedDate.set({day:o.date(),month:o.month()+1,year:o.year()})}diaryLogService=b(V);getIndicatorStatusColor(i){let e=this.diaryLogService.hasFoodOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(i)+1).toISOString()),t=this.diaryLogService.hasWeightInOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(i)+1).toISOString()),o=this.diaryLogService.hasWaterOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(i)+1).toISOString()),r=this.diaryLogService.hasActivitiesOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(i)+1).toISOString());return e&&t&&o&&r?"rgba(60, 140, 70)":e||t||o||r?"rgba(150, 120, 70)":"rgba(90, 90, 90)"}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["weekdays"]],inputs:{selectedDate:[1,"selectedDate"]},outputs:{selectedDate:"selectedDateChange"},decls:5,vars:1,consts:[[1,"bg-body-tertiary","p-1","user-select-none"],[1,"d-flex","justify-content-between"],[1,"weekday","bg-body","cursor-pointer","opacity-85",3,"class"],[3,"selectedDateChange","selectedDate"],[1,"weekday","bg-body","cursor-pointer","opacity-85",3,"click"],[1,"text-center"],[1,"rounded","m-auto",2,"width","10px","height","10px"]],template:function(e,t){e&1&&(d(0,"div",0)(1,"div",1),I(2,It,4,11,"div",2,T),d(4,"date-picker",3),$("selectedDateChange",function(r){return O(t.selectedDate,r)||(t.selectedDate=r),r}),l()()()),e&2&&(a(2),E(t.weekdays),a(2),L("selectedDate",t.selectedDate))},dependencies:[pt],styles:[".weekday[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;font-size:14px;border:2px solid transparent;transition:border .3s;font-style:italic}"]})};var Ve=ft(xt());var Et=(n,i)=>({"text-info-emphasis":n,"text-warning-emphasis":i});function kt(n,i){if(n&1&&(Y(),v(0,"line",19)),n&2){let e=s(),t=e.$implicit,o=e.$index,r=s(3);W("x1",`${96/(r.weights().length-1)*o+2}%`)("y1",`${r.weightsRange()===0?50:(r.weightsMax()+r.weightsRange()*.1-t)/(r.weightsRange()*1.5)*100}%`)("x2",`${96/(r.weights().length-1)*(o+1)+2}%`)("y2",`${r.weightsRange()===0?50:(r.weightsMax()+r.weightsRange()*.1-r.weights()[o+1])/(r.weightsRange()*1.5)*100}%`)}}function Wt(n,i){if(n&1&&(Y(),d(0,"text",20),c(1),l()),n&2){let e=s(),t=e.$implicit,o=e.$index,r=s(3);W("x",`${88/r.Math.max(r.weights().length-1,1)*o+6}%`),a(),_(" ",t.toFixed(1)," ")}}function Vt(n,i){if(n&1&&(Y(),v(0,"circle",18),f(1,kt,1,4,":svg:line",19),f(2,Wt,2,2,":svg:text",20)),n&2){let e=i.$implicit,t=i.$index,o=s(3);W("cx",`${96/o.Math.max(o.weights().length-1,1)*t+2}%`)("cy",`${o.weightsRange()===0?50:(o.weightsMax()+o.weightsRange()*.1-e)/(o.weightsRange()*1.5)*100}%`),a(),x(t<o.weights().length-1?1:-1),a(),x(e?2:-1)}}function Nt(n,i){if(n&1&&(Y(),v(0,"line",21)),n&2){let e=s(),t=e.$implicit,o=e.$index,r=s(3);W("x1",`${96/(r.calories().length-1)*o+2}%`)("y1",`${r.caloriesRange()===0?50:(r.caloriesMax()+r.caloriesRange()*.1-t)/(r.caloriesRange()*1.5)*100}%`)("x2",`${96/(r.calories().length-1)*(o+1)+2}%`)("y2",`${r.caloriesRange()===0?50:(r.caloriesMax()+r.caloriesRange()*.1-r.calories()[o+1])/(r.caloriesRange()*1.5)*100}%`)}}function Rt(n,i){if(n&1&&f(0,Nt,1,4,":svg:line",21),n&2){let e=i.$index,t=s(3);x(e<t.calories().length-1?0:-1)}}function Pt(n,i){if(n&1&&(Y(),d(0,"svg",2),I(1,Vt,3,4,null,null,T),I(3,Rt,1,1,null,null,T),l()),n&2){let e=s(2);a(),E(e.weights()),a(2),E(e.calories())}}function Lt(n,i){if(n&1){let e=h();f(0,Pt,5,0,":svg:svg",2),d(1,"div",3)(2,"div",4)(3,"div",5)(4,"div",6)(5,"span",7),c(6,"\u2192"),l(),c(7),d(8,"span",7),c(9,"\u2190"),l()(),v(10,"div",8),d(11,"div",9),c(12),v(13,"div",10),l()()(),d(14,"div")(15,"div",11),c(16," avg "),l(),d(17,"div",12),v(18,"iconify",13),d(19,"div",14),c(20),l()()(),d(21,"div",15),v(22,"iconify",16),d(23,"input",17),u("blur",function(o){m(e);let r=s();return g(r.diaryLogService.updateCurrentWeight(r.isoDate(),o.target.value))}),l()()()}if(n&2){let e=s();x(e.weights().length?0:-1);let t=e.optionsService.getCaloriesForWeightGoal(e.diaryLogService.getWeightByFormula(void 0,e.optionsService.options().weightFormulaBackDays));a(7),_(" ",t.toFixed()," "),a(4),j("left",e.getCalorieAverageLeftPositionPercent(e.diaryLogService.getCalorieAveragePer7Days(e.isoDate()),t),"%"),a(),_(" ",e.diaryLogService.getCalorieAveragePer7Days(e.isoDate()).toFixed()," "),a(8),_(" ",e.diaryLogService.getWeightByFormula(e.isoDate(),e.optionsService.options().weightFormulaBackDays).toFixed(1)," kg "),a(2),z(ee(11,Et,e.diaryLogService.getCurrentWeight(e.isoDate()),!e.diaryLogService.getCurrentWeight(e.isoDate()))),a(),y("placeholder",e.diaryLogService.getCurrentWeight(e.isoDate())?"kg":"?")("disabled",e.weightInputDisabled())("value",e.diaryLogService.getCurrentWeight(e.isoDate()))}}var we=class n{Math=Math;diaryLogService=b(V);optionsService=b(ne);isoDate=S("");weights(){return this.isoDate()?this.diaryLogService.getWeights(this.isoDate(),11):[]}weightsMax=k(()=>Math.max(...this.weights()));weightsMin=k(()=>Math.min(...this.weights()));weightsRange=k(()=>this.weightsMax()-this.weightsMin());weightInputDisabled(){return(0,Ve.default)().utc().startOf("day").isBefore((0,Ve.default)(this.isoDate()).utc())}calories(){return this.isoDate()?this.diaryLogService.getCalories(this.isoDate(),11):[]}caloriesMax=k(()=>Math.max(...this.calories()));caloriesMin=k(()=>Math.min(...this.calories()));caloriesRange=k(()=>this.caloriesMax()-this.caloriesMin());getCalorieAverageLeftPositionPercent(i,e){let o=e-250,r=e+250;return(Math.max(o,Math.min(r,i))-o)/500*65+17.5}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["weight-in-widget"]],inputs:{isoDate:[1,"isoDate"]},decls:3,vars:1,consts:[[1,"rounded","bg-body-secondary","position-relative","main-wrapper"],[1,"overlay"],[1,"w-100",2,"pointer-events","none","height","64px"],[1,"d-flex","gap-1","justify-content-between","align-items-center"],[1,"flex-grow-1"],[1,"m-1","bg-body-tertiary","rounded-pill","position-relative",2,"height","24px"],[1,"text-center","fw-semibold","bg-body-secondary","px-2","position-absolute","rounded-pill","top-0","translate-middle","start-50","z-2",2,"font-size","10px","color","rgb(150, 150, 255)","text-shadow","0 0 5px rgba(10, 10, 10, 0.9)","border-top","1px solid rgba(10, 10, 10, 0.5)","border-bottom","1px solid rgba(130, 130, 130, 0.2)","white-space","nowrap"],[1,"opacity-75",2,"font-size","14px","line-height","14px"],[1,"position-absolute","translate-midsdle-x","start-50",2,"width","1px","height","100%","background-color","rgb(150, 150, 255)"],[1,"fw-semibold","px-3","rounded-pill","position-absolute","translate-middle-x","align-content-end","opacity-95","position-relative",2,"font-size","10px","border","1px solid rgb(150, 110, 160, 0.1)","background-color","rgb(240, 180, 230, 0.25)","text-shadow","0 0 5px rgba(10, 10, 10, 0.9)","height","calc(100% - 2px)","box-shadow","inset 0 0 10px rgba(10, 10, 10, 0.75)","top","1px"],[1,"position-absolute","translate-midsdle-x","start-50","top-0",2,"width","1px","height","100%","background-color","rgb(240, 180, 230, 0.75)"],[1,"opacity-50","text-center",2,"font-size","10px","line-height","12px","margin-bottom","-6px"],[1,"px-1","d-flex","align-items-center"],["icon","ph:tilde-fill",1,"opacity-50"],[1,"ms-1","fw-semibold","opacity-75",2,"font-size","14px"],[1,"position-relative","d-flex","justify-content-center","align-items-center","overflow-hidden","me-1",2,"width","48px","height","48px"],["icon","iconoir:weight","size","3rem",1,"position-absolute","z-0","opacity-55",2,"transform","scaleX(1.25)"],["type","number","inputmode","numeric",1,"form-control","text-center","p-0","shadow-none","z-1","border-0",2,"width","44px","background-color","transparent","margin-top","10px",3,"blur","placeholder","disabled","value"],["r","4","fill","rgba(from var(--bs-info-text-emphasis) r g b / 0.5)"],["stroke","rgba(from var(--bs-info-text-emphasis) r g b / 0.4)","stroke-width","1"],["y","96%","fill","rgba(from var(--bs-info-text-emphasis) r g b / 0.5)","font-size","12px","font-style","italic","text-anchor","middle"],["stroke","rgb(130, 100, 140)","stroke-width","1"]],template:function(e,t){e&1&&(d(0,"div",0),v(1,"div",1),f(2,Lt,24,14),l()),e&2&&(a(2),x(t.weightInputDisabled()?-1:2))},dependencies:[Q],styles:[".main-wrapper[_ngcontent-%COMP%]{border:2px solid rgb(from var(--bs-info-text-emphasis) r g b/.1)}input[_ngcontent-%COMP%]{color:var(--bs-info-text-emphasis)}[_ngcontent-%COMP%]::placeholder{color:var(--bs-info-text-emphasis);font-style:italic;opacity:.4}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0000;background:linear-gradient(#00000040,#c8a0c80d);z-index:1000;pointer-events:none}"]})};function Ot(n,i){if(n&1){let e=h();d(0,"li",27)(1,"span",28),u("click",function(){m(e);let o=s().$implicit,r=s().$index,p=s();return g(p.diaryLogService.setActivityType(p.isoDate(),r,o.value))}),c(2),l()()}if(n&2){let e=s(),t=e.$implicit,o=e.$index;B("bg-body-tertiary",o%2===0),a(2),_(" ",t.label," ")}}function $t(n,i){if(n&1&&f(0,Ot,3,3,"li",26),n&2){let e=i.$implicit;x(e.value?0:-1)}}function Bt(n,i){if(n&1){let e=h();d(0,"div",6)(1,"h2",7)(2,"button",8),u("click",function(){let o=m(e).$index,r=s();return g(r.diaryLogService.removeActivity(r.isoDate(),o))}),l(),d(3,"button",9),c(4),l(),d(5,"ul",10),I(6,$t,1,1,null,null,T),l(),d(8,"button",11)(9,"div",12),v(10,"iconify",13),d(11,"span",14),v(12,"iconify",15),l(),d(13,"input",16),$("ngModelChange",function(o){let r=m(e).$implicit;return O(r.durationMinutes,o)||(r.durationMinutes=o),g(o)}),u("blur",function(){m(e);let o=s();return g(o.diaryLogService.saveDiaryLog())}),l()()()(),d(14,"div",17,0)(16,"div",18)(17,"div",19)(18,"span",20),v(19,"iconify",21),l(),d(20,"div",22)(21,"ngb-timepicker",23),$("ngModelChange",function(o){let r=m(e).$implicit;return O(r.time,o)||(r.time=o),g(o)}),u("change",function(){m(e);let o=s();return g(o.diaryLogService.saveDiaryLog())}),l()()(),d(22,"div",24)(23,"input",25),$("ngModelChange",function(o){let r=m(e).$implicit;return O(r.note,o)||(r.note=o),g(o)}),u("blur",function(){m(e);let o=s();return g(o.diaryLogService.saveDiaryLog())}),l()()()()()}if(n&2){let e=i.$implicit,t=i.$index,o=s();a(4),_(" ",o.activitiesTypes[e.type].label," "),a(2),E(o.activitiesTypes),a(2),W("data-bs-target","#flush-activity-collapse"+t),a(2),y("icon",o.activityTypeIconMap[e.type].icon),a(3),L("ngModel",e.durationMinutes),a(),y("id","flush-activity-collapse"+t),a(7),y("spinners",!1),L("ngModel",e.time),a(2),L("ngModel",e.note)}}var Se=class n{diaryLogService=b(V);isoDate=S("");activityTypeIconMap=st;activitiesTypes=Object.keys(We).filter(i=>!isNaN(Number(i))).map(i=>({label:We[i],value:+i}));static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["activity-widget"]],inputs:{isoDate:[1,"isoDate"]},decls:8,vars:0,consts:[["collapsible",""],[1,"bg-body","rounded","mt-1","rounded","overflow-hidden"],[1,"d-flex","align-items-center","bg-body-secondary"],[1,"text-muted","text-center","flex-grow-1","opacity-50",2,"font-size","12px"],["iconSize","24px","buttonIcon","iconamoon:sign-plus-bold",1,"btn","btn-sm",3,"click"],["id","accordionActivityFlush",1,"d-flex","flex-column","accordion","accordion-flush",2,"gap","1px","padding","1px 0px"],[1,"accordion-item","rounded","overflow-hidden","border-0"],[1,"accordion-header","d-flex","align-content-center","gap-1"],["buttonIcon","iconoir:trash","iconSize","16px",1,"btn","btn-outline-warning","btn-sm","opacity-25","mx-1","align-self-center",3,"click"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-outline-secondary","bg-body-secondary","border-0","dropdown-toggle","mx-auto","opacity-60","my-1",2,"min-width","120px","font-size","18px"],[1,"dropdown-menu","p-0","pb-1","overflow-hidden","shadow-sm",2,"min-width","120px"],["type","button","data-bs-toggle","collapse",1,"accordion-button","p-1","my-1","bg-body-tertiary","collapsed","text-truncate","text-muted","fw-bold","shadow-none","rounded"],[1,"d-flex","justify-content-around","flex-grow-1","align-items-center"],[3,"icon"],[1,"opacity-15"],["icon","icon-park-outline:timer","size","24px"],["type","number","inputmode","numeric","step","1","min","0","placeholder","m",1,"form-control","form-control-sm","shadow-none","text-center","border","border-info-subtle","rounded-circle","opacity-65",2,"width","30px","padding","0",3,"ngModelChange","blur","ngModel"],["data-bs-parent","#accordionActivityFlush",1,"accordion-collapse","collapse","bg-body-tertiary",3,"id"],[1,"p-1","d-flex","gap-2","justify-content-between"],[1,"d-flex","align-items-center","gap-1"],[1,"opacity-15",2,"margin","0px 1px"],["icon","mingcute:time-line","size","24px"],[1,"opacity-85",2,"padding","2px 0"],["size","small",3,"ngModelChange","change","spinners","ngModel"],[1,"flex-grow-1",2,"padding","2px"],["type","text","placeholder","Note",1,"form-control","form-control-sm","shadow-none","text-center","border-none","opacity-70","bg-dark-subtle",3,"ngModelChange","blur","ngModel"],[1,"mt-1",3,"bg-body-tertiary"],[1,"mt-1"],[1,"dropdown-item","cursor-pointer","px-2","text-center",3,"click"]],template:function(e,t){e&1&&(d(0,"div",1)(1,"div",2)(2,"div",3),c(3," Activities "),l(),d(4,"button",4),u("click",function(){return t.diaryLogService.addActivity(t.isoDate())}),l()(),d(5,"div",5),I(6,Bt,24,8,"div",6,T),l()()),e&2&&(a(6),E(t.diaryLogService.getActivities(t.isoDate())))},dependencies:[A,fe,H,_e,He,ie,Qe,oe,Q],encapsulation:2})};function zt(n,i){if(n&1){let e=h();v(0,"div",1),d(1,"div",2)(2,"zxing-scanner",3),u("scanSuccess",function(o){m(e);let r=s();return g(r.onCodeResult(o))}),l(),d(3,"div",4)(4,"div",5),v(5,"div",6),l()()()}if(n&2){let e=s();a(2),y("formats",e.formats)("autofocusEnabled",!0)}}function At(n,i){if(n&1){let e=h();d(0,"div",0)(1,"button",7),u("click",function(){m(e);let o=s();return o.code.set(""),g(o.isScanning.set(!0))}),c(2," Re-scan "),l()(),d(3,"div",8)(4,"input",9),$("ngModelChange",function(o){m(e);let r=s();return O(r.code,o)||(r.code=o),g(o)}),u("click",function(o){return m(e),g(o.stopPropagation())}),l()()}if(n&2){let e=s();a(),y("disabled",e.isScanning()),a(3),L("ngModel",e.code)}}function Jt(n,i){if(n&1){let e=h();d(0,"div",0)(1,"button",10),u("click",function(){m(e);let o=s();return g(o.onAddAsNewFood(o.code()))}),c(2," Add as new food "),l()()}if(n&2){let e=s();a(),y("disabled",e.isScanning())}}var De=class n{foodsService=b(et);diaryLogService=b(V);modalService=b(ye);activeModal=b(Ue);formats=[it.EAN_13];isScanning=P(!0);isoDate=P("");mealPosition=P(0);code=te("");respectiveFood=k(()=>this.code()&&this.foodsService.getFoodByBarcode(this.code()));isFoodAdded=!1;constructor(){ce(()=>{let i=this.respectiveFood();i&&!this.isFoodAdded&&(this.addFoodToDiary(i),this.isFoodAdded=!0)})}onCodeResult(i){this.code.set(i),this.isScanning.set(!1)}addFoodToDiary(i){this.diaryLogService.addFood(this.isoDate(),this.mealPosition(),i),this.diaryLogService.updateMealTime(this.isoDate(),this.mealPosition()),this.activeModal.close()}onAddAsNewFood(i){this.modalService.open(rt).componentInstance.food.set(new tt(void 0,"new food",0,0,0,0,0,0,100,i,""))}ngOnDestroy(){navigator.mediaDevices&&navigator.mediaDevices.stop&&navigator.mediaDevices.stop()}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["ng-component"]],inputs:{code:[1,"code"]},outputs:{code:"codeChange"},decls:3,vars:3,consts:[[1,"d-flex","opacity-50","p-1","gap-1"],[1,"mt-2"],[1,"position-relative"],[3,"scanSuccess","formats","autofocusEnabled"],[1,"position-absolute","d-flex","align-items-center",2,"inset","0","pointer-events","none"],[1,"border-top","border-bottom","border-warning","w-75","m-auto","position-relative",2,"height","60%"],[1,"laser"],[1,"btn","btn-sm","btn-outline-warning","mx-auto","flex-grow-1",3,"click","disabled"],[1,"m-1"],[1,"form-control","form-control-sm","border-warning-subtle","text-center","opacity-75","fs-5",3,"ngModelChange","click","ngModel"],["buttonIcon","mdi:plus",1,"btn","btn-sm","btn-outline-success","mx-auto","flex-grow-1",3,"click","disabled"]],template:function(e,t){e&1&&(f(0,zt,6,2),f(1,At,5,2),f(2,Jt,3,1,"div",0)),e&2&&(x(t.isScanning()&&!t.respectiveFood()?0:-1),a(),x(!t.isScanning()&&!t.respectiveFood()?1:-1),a(),x(t.code()&&!t.respectiveFood()?2:-1))},dependencies:[nt,ot,H,_e,ie,oe,A],styles:["zxing-scanner[_ngcontent-%COMP%]{margin-top:2rem;max-width:min(60%,300px);margin:auto}.laser[_ngcontent-%COMP%]{position:absolute;width:100%;height:2px;background-color:#f0323280;box-shadow:0 0 8px #f0323280;top:50%;animation:_ngcontent-%COMP%_scan 1s infinite ease-in-out}@keyframes _ngcontent-%COMP%_scan{0%{top:5%}50%{top:95%}to{top:5%}}"]})};var Ce=class n{isoDate=S("");stats=S.required();diaryLogService=b(V);optionsService=b(ne);getProteinScrollbarBg(i,e){if(!e)return"rgba(120, 120, 120, 0.5)";let t=e*1.5,o=e*2.5,r=e*.8,p=e*3.2;return i>=t&&i<=o?"rgba(60, 160, 70, 0.6)":i>=r&&i<=p?"rgba(180, 150, 50, 0.6)":"rgba(220, 140, 40, 0.5)"}getCarbScrollbarBg(i,e){if(!e)return"rgba(120, 120, 120, 0.5)";let t=e*1.6,o=e*3.2,r=e*.7,p=e*3.7;return i>=t&&i<=o?"rgba(60, 160, 70, 0.6)":i>=r&&i<=p?"rgba(180, 150, 50, 0.6)":"rgba(220, 140, 40, 0.5)"}getFatScrollbarBg(i,e){if(!e)return"rgba(120, 120, 120, 0.5)";let t=e*.6,o=e*1.2,r=e*.4,p=e*1.4;return i>=t&&i<=o?"rgba(60, 160, 70, 0.6)":i>=r&&i<=p?"rgba(180, 150, 50, 0.6)":"rgba(220, 140, 40, 0.5)"}getKCalScrollbarBg(i,e){if(!e)return"rgba(120, 120, 120, 0.5)";let t=e*25,o=e*30,r=e*18,p=e*37;return i>=t&&i<=o?"rgba(60, 160, 70, 0.6)":i>=r&&i<=p?"rgba(180, 150, 50, 0.6)":"rgba(220, 140, 40, 0.5)"}darkenColor(i){let e=i.match(/\d+/g);if(!e||e.length<3)return i;let t=Math.max(0,parseInt(e[0])-50),o=Math.max(0,parseInt(e[1])-50),r=Math.max(0,parseInt(e[2])-50),p=e[3]?parseInt(e[3])/255:1;return`rgba(${t}, ${o}, ${r}, ${p})`}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["macros-widget"]],inputs:{isoDate:[1,"isoDate"],stats:[1,"stats"]},decls:27,vars:12,consts:[[1,"rounded","overflow-hidden","position-relative"],[1,"overlay"],[1,"row","align-items-center","bg-body-secondary","fst-italic"],[1,"col","text-center","text-muted","opacity-50",2,"font-size","12px"],[1,"p-2","d-flex","flex-column","gap-3"],[1,"d-flex","align-items-center","gap-2"],[1,"flex-grow-1","position-relative"],[1,"text-center","mx-auto","rounded","fw-bold","position-absolute","start-50","top-50","translate-middle",2,"font-size","14px","line-height","14px","width","40px","color","rgb(80, 100, 240)","padding","3px 0px","background-color","rgb(30, 30, 30, 0.7)","border","1px solid rgba(150, 150, 150, 0.5)"],[1,"rounded-pill",2,"height","14px"],[1,"text-center","rounded","mx-auto","fw-bold","position-absolute","start-50","top-50","translate-middle",2,"font-size","14px","line-height","14px","width","40px","color","rgb(220, 220, 90)","padding","3px 0px","background-color","rgb(30, 30, 30, 0.7)","border","1px solid rgba(150, 150, 150, 0.5)"],[1,"text-center","rounded","mx-auto","fw-bold","position-absolute","start-50","top-50","translate-middle",2,"font-size","14px","line-height","14px","width","40px","color","rgb(200, 160, 30)","padding","3px 0px","background-color","rgb(30, 30, 30, 0.7)","border","1px solid rgba(150, 150, 150, 0.5)"],[1,"flex-grow-1","position-relative","w-50","mx-auto"],[1,"text-center","rounded","mx-auto","fw-bold","position-absolute","start-50","top-50","translate-middle","fst-italic",2,"font-size","14px","line-height","14px","letter-spacing","1px","width","fit-content","min-width","40px","color","rgb(150, 140, 180)","padding","3px 6px","background-color","rgb(30, 30, 30, 0.7)","border","1px solid rgba(150, 150, 150, 0.5)"]],template:function(e,t){e&1&&(C(0,"div",0),K(1,"div",1),C(2,"div",2)(3,"div",3),c(4,"Proteins"),w(),C(5,"div",3),c(6,"Carbs"),w(),C(7,"div",3),c(8,"Fats"),w()(),C(9,"div",4)(10,"div",5)(11,"div",6)(12,"div",7),c(13),w(),K(14,"div",8),w(),C(15,"div",6)(16,"div",9),c(17),w(),K(18,"div",8),w(),C(19,"div",6)(20,"div",10),c(21),w(),K(22,"div",8),w()(),C(23,"div",11)(24,"div",12),c(25),w(),K(26,"div",8),w()()()),e&2&&(a(13),_(" ",t.stats().proteins.toFixed()," "),a(),j("background-color",t.getProteinScrollbarBg(t.stats().proteins,t.diaryLogService.getWeightByFormula(void 0,t.optionsService.options().weightFormulaBackDays))),a(3),_(" ",t.stats().carbs.toFixed()," "),a(),j("background-color",t.getCarbScrollbarBg(t.stats().carbs,t.diaryLogService.getWeightByFormula(void 0,t.optionsService.options().weightFormulaBackDays))),a(3),_(" ",t.stats().fats.toFixed()," "),a(),j("background-color",t.getFatScrollbarBg(t.stats().fats,t.diaryLogService.getWeightByFormula(void 0,t.optionsService.options().weightFormulaBackDays))),a(3),_(" ",t.stats().calories.toFixed()," "),a(),j("background-color",t.getKCalScrollbarBg(t.stats().calories,t.diaryLogService.getWeightByFormula(void 0,t.optionsService.options().weightFormulaBackDays))))},dependencies:[H],styles:[".overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0000;background:linear-gradient(#0a0a0a40,#c8a0c80d);z-index:1000;pointer-events:none}"]})};var Me=class n{dayTemplate=P(void 0);constructor(){this.setTemplate()}setTemplate(){localStorage.removeItem("dayTemplate");let i=Object.keys(se).filter(t=>!isNaN(Number(t))).map(t=>Number(t)).filter(t=>t!==0).map(t=>({label:ve[t],value:+t})),e=new lt;i.forEach(t=>{e.entries.push({position:t.value,meal:new at("",t.label),recipes:[]})}),this.dayTemplate.set(e)}getDayTemplate(){return this.dayTemplate()}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Re({token:n,factory:n.\u0275fac,providedIn:"root"})};var jt=["editMealNoteDialog"],Gt=(n,i,e)=>({"fst-italic":n,"fw-semibold":i,"text-muted":e}),qt=n=>({"background-color":n}),Ht=(n,i,e,t,o)=>({collapsed:n,"fw-semibold":i,"opacity-50":e,"opacity-30":t,"opacity-70":o}),Qt=(n,i)=>({"bg-body-tertiary":n,"bg-dark-subtle":i});function Xt(n,i){if(n&1&&c(0),n&2){s();let e=G(15);_(" ",(e/1e3).toFixed(2),"L ")}}function Zt(n,i){n&1&&c(0," ? ")}function Ut(n,i){n&1&&c(0),n&2&&_(" ",i.toFixed()," ")}function Yt(n,i){n&1&&c(0),n&2&&_(" ",i.toFixed()," ")}function Kt(n,i){n&1&&c(0),n&2&&_(" ",i.toFixed()," ")}function ei(n,i){n&1&&c(0),n&2&&_(" ",i.toFixed()," ")}function ti(n,i){n&1&&c(0),n&2&&_(" ",i.toFixed()," ")}function ii(n,i){n&1&&c(0),n&2&&_(" ",i.toFixed()," ")}function oi(n,i){if(n&1){let e=h();d(0,"div",39)(1,"button",49),u("click",function(){m(e),s(2);let o=G(0),r=s();return g(r.toggleEditMealNoteDialog(o.id,o.note))}),l(),d(2,"input",50),u("input",function(o){m(e);let r=s(2).$implicit,p=s();return g(p.updateMealName(r.position,o.target.value))}),l(),d(3,"ngb-timepicker",51),$("ngModelChange",function(o){m(e),s(2);let r=G(0);return O(r.time,o)||(r.time=o),g(o)}),u("change",function(){m(e);let o=s(3);return g(o.diaryLogService.saveDiaryLog())}),l()()}if(n&2){s(2);let e=G(0);a(),B("btn-outline-success",e.note),a(),y("value",e.name),a(),y("spinners",!1),L("ngModel",e.time)}}function ni(n,i){if(n&1){let e=h();d(0,"diary-recipe",52),u("updateFoodWeight",function(o){let r=m(e).$index,p=s(2).$implicit,N=s();return g(N.updateRecipeFoodWeight(p.position,r,o.foodIndex,o.newWeight))})("removeRecipe",function(){let o=m(e).$index,r=s(2).$implicit,p=s();return g(p.removeRecipeFromPosition(r.position,o))})("removeFood",function(o){let r=m(e).$index,p=s(2).$implicit,N=s();return g(N.removeFoodFromRecipe(p.position,r,o))}),l()}if(n&2){let e=i.$implicit;y("recipe",e)}}function ri(n,i){if(n&1){let e=h();d(0,"food-row",53),u("removeFood",function(){let o=m(e).$index,r=s(2).$implicit,p=s();return g(p.removeFood(r.position,o))})("updateFoodWeight",function(o){let r=m(e).$index,p=s(2).$implicit,N=s();return g(N.updateFoodWeight(p.position,r,o))}),l()}if(n&2){let e=i.$implicit,t=i.$index,o=i.$count,r=s(2).$implicit,p=s();y("food",e)("isOdd",t%2!==0)("focusWeight",p.isMealExpanded(r.position)&&t===o-1)}}function ai(n,i){if(n&1){let e=h();d(0,"div",44)(1,"div",54)(2,"button",55),u("click",function(){m(e),s(2);let o=G(0),r=s();return g(r.deleteImage(o.imageId))}),l(),d(3,"meal-thumb",56),u("deleteChange",function(o){m(e);let r=s(3);return g(r.deleteImage(o))}),l()(),d(4,"div",57),v(5,"meal-thumb",58),l()()}if(n&2){s(2);let e=G(0);a(2),y("iconSize","16px"),a(),y("imageId",e.imageId),a(2),y("imageId",e.imageId)}}function di(n,i){if(n&1){let e=h();d(0,"input",59,3),u("change",function(o){m(e),s(2);let r=G(0),p=s();return g(p.onImageSelected(o,r))}),l(),d(2,"button",60),u("click",function(){m(e);let o=Fe(1);return g(o.click())}),l()}}function li(n,i){if(n&1){let e=h();d(0,"div",27)(1,"h2",28)(2,"button",29),u("click",function(){m(e);let o=s().$implicit,r=s();return g(r.toggleExpandedMeal(o.position))}),c(3),l(),d(4,"div",30)(5,"div",31)(6,"div",32),f(7,Ut,1,1),l(),d(8,"div",33),f(9,Yt,1,1),l(),d(10,"div",34),f(11,Kt,1,1),l(),d(12,"div",35),f(13,ei,1,1),l(),d(14,"div",36),f(15,ti,1,1),l(),d(16,"div",37),f(17,ii,1,1),l()()()(),d(18,"div",38,2),f(20,oi,4,5,"div",39),I(21,ni,1,1,"diary-recipe",40,T),d(23,"div",41),I(24,ri,1,3,"food-row",42,T),l(),d(26,"div",43),f(27,ai,6,3,"div",44)(28,di,3,0),l(),d(29,"div",45)(30,"button",46),u("click",function(o){m(e);let r=s().$implicit,p=s();return o.stopPropagation(),g(p.addRecipe(r.position))}),c(31," Recipe "),l(),d(32,"button",47),u("click",function(o){m(e);let r=s().$implicit,p=s();return o.stopPropagation(),g(p.onScanBarcodeClick(r.position))}),c(33," Barcode "),l(),d(34,"button",48),u("click",function(o){m(e);let r=s().$implicit,p=s();return o.stopPropagation(),g(p.addFood(r.position))}),c(35," Food "),l()()()()}if(n&2){let e,t,o,r,p,N,de,le=s(),M=le.$implicit,Ne=le.$index,R=G(0),F=s();a(2),z(ge(22,Ht,!F.isMealExpanded(M.position),M.position!==F.mealPosition.Snacks,M.position!==F.mealPosition.Snacks&&!F.isMealExpanded(M.position),M.position===F.mealPosition.Snacks,F.isMealExpanded(M.position))),W("data-bs-target","#flush-collapse"+Ne),a(),_(" ",F.mealPositionMap[M.position]," "),a(2),z(ee(28,Qt,!F.isMealExpanded(M.position),F.isMealExpanded(M.position)));let U=F.getPositionStats(M.position);a(2),x((e=U.proteins)?7:-1,e),a(2),x((t=U.carbs)?9:-1,t),a(2),x((o=U.fats)?11:-1,o),a(2),x((r=U.fiber)?13:-1,r),a(2),x((p=U.calories)?15:-1,p),a(2),x((N=U.weight)?17:-1,N),a(),B("show",F.isMealExpanded(M.position)),y("id","flush-collapse"+Ne),a(2),x(R&&M.position!==F.mealPosition.Snacks?20:-1),a(),E(F.getRespectiveRecipes(M.position)),a(2),B("py-1",R==null||R.foods==null?null:R.foods.length),a(),E(R==null?null:R.foods),a(3),x(R!=null&&R.imageId?27:!(R==null||R.foods==null)&&R.foods.length||(de=F.getRespectiveRecipes(M.position))!=null&&de.length?28:-1),a(3),y("minWidthPx",90),a(2),y("minWidthPx",90),a(2),y("minWidthPx",90)}}function si(n,i){if(n&1&&(Te(0),f(1,li,36,31,"div",27)),n&2){let e=i.$implicit,t=s();Ie(t.getRespectiveMeal(e.position)),a(),x(t.isMealShown(e.position)?1:-1)}}function ci(n,i){if(n&1){let e=h();d(0,"textarea",61),u("input",function(o){m(e);let r=s();return g(r.updateMealNote(r.editNoteMealId(),o.target.value))}),l()}if(n&2){let e=s();y("value",e.editNoteMeal())}}function pi(n,i){if(n&1){let e=h();d(0,"textarea",62),u("input",function(o){m(e);let r=s();return g(r.diaryLogService.updateDayNote(r.selectedDayJs().toISOString(),o.target.value))}),l()}if(n&2){let e=s();y("value",e.diaryLogService.getDayNote(e.selectedDayJs().toISOString()))}}var yt=class n{mealPosition=se;diaryDate=S("");selectedDate=te(void 0);selectedDayJs=k(()=>this.selectedDate()&&J.fromNgbDateStruct(this.selectedDate()));isTodaySelected=k(()=>this.selectedDate()&&J.fromNgbDateStruct(this.selectedDate()).isSame(J.getStartOfToday(),"day"));ngAfterViewInit(){this.diaryDate()&&this.selectedDate.set(J.toNgbDateStruct(this.diaryDate()))}location=b(Ge);activatedRoute=b(Ye);constructor(){ce(()=>{if(!this.selectedDate())return;let i=this.selectedDayJs();if(i){let e=this.router.createUrlTree([],{relativeTo:this.activatedRoute,queryParams:{diaryDate:i.toISOString()}}).toString();this.location.go(e)}})}dayTemplateService=b(Me);router=b(Ke);addFood(i){this.router.navigate([ke.myFoods],{queryParams:{diaryDate:this.selectedDayJs().toISOString(),mealPosition:i}})}addRecipe(i){this.router.navigate([ke.recipes],{queryParams:{diaryDate:this.selectedDayJs().toISOString(),mealPosition:i}})}diaryLogService=b(V);mealPositionMap=ve;getRespectiveMeal(i){return this.diaryLogService.getRespectiveMeal(this.selectedDayJs().toISOString(),i)}isMealShown(i){return i===1||i===7||!this.diaryLogService.isPrevPositionMealEmpty(this.selectedDayJs().toISOString(),i)}getRespectiveRecipes(i){return this.diaryLogService.getRespectiveRecipes(this.selectedDayJs().toISOString(),i)}updateMealName(i,e){this.diaryLogService.updateMealName(this.selectedDayJs().toISOString(),i,e)}removeFood(i,e){this.diaryLogService.removeFood(this.selectedDayJs().toISOString(),i,e)}updateFoodWeight(i,e,t){this.diaryLogService.updateFoodWeight(this.selectedDayJs().toISOString(),i,e,+t)}getPositionStats(i){return this.diaryLogService.getPositionStats(this.selectedDayJs().toISOString(),i)}getDayStats(){return this.diaryLogService.getDayStats(this.selectedDayJs().toISOString())}toggleExpandedMeal(i){this.diaryLogService.toggleExpandedMeal(this.selectedDayJs().toISOString(),i)}isMealExpanded(i){let e=this.diaryLogService.getExpandedMeal();return e?.isoDate===this.selectedDayJs().toISOString()&&e?.mealPosition===i}modalService=b(ye);editMealNoteDialogRef=ue("editMealNoteDialog");editNoteMealId=P("");editNoteMeal=P("");toggleEditMealNoteDialog(i,e){this.editNoteMealId.set(i),this.editNoteMeal.set(e),this.modalService.open(this.editMealNoteDialogRef(),{size:"sm",centered:!0}).result.catch(()=>{this.editNoteMealId.set(""),this.editNoteMeal.set("")})}updateMealNote(i,e){this.diaryLogService.updateMealNote(this.selectedDayJs().toISOString(),i,e)}updateRecipeFoodWeight(i,e,t,o){this.diaryLogService.updateRecipeFoodWeight(this.selectedDayJs().toISOString(),i,e,t,o)}removeFoodFromRecipe(i,e,t){this.diaryLogService.removeFoodFromRecipe(this.selectedDayJs().toISOString(),i,e,t)}removeRecipeFromPosition(i,e){this.diaryLogService.removeRecipeFromPosition(this.selectedDayJs().toISOString(),i,e)}toggleEditDayNoteDialog(i){this.modalService.open(i,{size:"sm",centered:!0})}onScanBarcodeClick(i){let e=this.modalService.open(De,{size:"sm",centered:!0});e.componentInstance.isoDate.set(this.selectedDayJs().toISOString()),e.componentInstance.mealPosition.set(i)}optionsService=b(ne);getWaterBg(i,e){let t=this.diaryLogService.getWeightByFormula(void 0,e);if(!t)return"rgba(0, 0, 0, 0)";let o=Math.min(i/(t*.325),100);return`rgba(${140-o*1.5}, ${50+o*.8}, ${o*2}, 0.5)`}waterThresholdMet(i,e){let t=this.diaryLogService.getWeightByFormula(void 0,e);return t?i>t*32.5:!1}imageStoreService=b(mt);cdr=b(Je);async onImageSelected(i,e){let o=i.target?.files?.[0];if(!o)return;let r=await ut(o),p=xe();this.imageStoreService.put(p,r).then(()=>{e.imageId=p,this.diaryLogService.saveDiaryLog(),this.cdr.detectChanges()})}recipesService=b(ct);async deleteImage(i){this.diaryLogService.deleteMealImage(i),this.recipesService.anyImage(i)||await this.imageStoreService.delete(i)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=D({type:n,selectors:[["diary"]],viewQuery:function(e,t){e&1&&pe(t.editMealNoteDialogRef,jt,5),e&2&&me()},inputs:{diaryDate:[1,"diaryDate"],selectedDate:[1,"selectedDate"]},outputs:{selectedDate:"selectedDateChange"},decls:48,vars:26,consts:[["editMealNoteDialog",""],["editDayNoteDialog",""],["collapsible",""],["imgInput",""],[1,"content-wrapper"],[1,"bg-body-tertiary","text-center",2,"font-size","14px","line-height","18px"],[1,"opacity-85"],[3,"selectedDateChange","selectedDate"],[1,"border-bottom"],[1,"d-flex"],[1,"d-flex","justify-content-between","align-items-center","p-1",2,"width","130px"],[1,"btn","p-0","opacity-75","d-flex","justify-content-between","rounded",2,"border","1px solid transparent",3,"click"],["icon","iconoir:notes"],[1,"d-flex","align-items-center"],[1,"btn","p-0","d-flex","justify-content-between","position-relative","opacity-70",2,"width","fit-content",3,"click"],["size","16px","icon","iconamoon:sign-minus-bold",1,"position-absolute","z-1","translate-middle","top-50","start-50","text-info-emphasis"],["icon","mdi:glass-outline",1,"z-0","opacity-20"],[1,"text-center","rounded","fw-semibold","opacity-70",2,"width","43px","border","1px solid transparent","font-size","14px"],["size","16px","icon","iconamoon:sign-plus-bold",1,"position-absolute","z-1","translate-middle","top-50","start-50","text-info-emphasis"],[1,"row","g-0","flex-grow-1","fw-bold","text-muted","fst-italic","opacity-25","bg-body-secondary",2,"font-size","12px"],[1,"col","col-2","align-self-center","text-center"],["id","accordionFlush",1,"accordion","accordion-flush","position-relative"],[1,"overlay"],[3,"stats","fixedDecimals"],[1,"mt-1","d-block","opacity-95",3,"isoDate","stats"],[1,"mt-1","d-block",3,"isoDate"],[3,"isoDate"],[1,"accordion-item"],[1,"accordion-header","d-flex","align-items-center"],["type","button","data-bs-toggle","collapse",1,"accordion-button","p-2","text-truncate","text-muted","shadow-none",2,"width","130px",3,"click"],[1,"flex-grow-1","align-self-stretch"],[1,"row","g-0","h-100","fw-light","fst-italic",2,"font-size","12px","transition","background-color 0.3s"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(80, 100, 240)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(220, 220, 90)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(200, 160, 30)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(100, 130, 20)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(150, 140, 180)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(100, 100, 100)"],["data-bs-parent","#accordionFlush",1,"accordion-collapse","collapse","rounded",3,"id"],[1,"d-flex","align-items-center","p-2","gap-1","bg-body-tertiary"],[3,"recipe"],[1,"d-flex","flex-column","gap-1"],[3,"food","isOdd","focusWeight"],[1,"mx-auto","d-flex","justify-content-center","align-items-center"],[1,"d-flex","justify-content-evenly","align-items-center","w-100","position-relative","overflow-hidden"],[1,"p-2","bg-body-tertiary","d-flex","gap-2","justify-content-between"],["buttonIcon","pajamas:recipe","iconSize","24px",1,"btn","btn-outline-primary","btn-sm","opacity-60","flex-grow-1",3,"click","minWidthPx"],["buttonIcon","si:barcode-fill","iconSize","24px",1,"btn","btn-outline-success","btn-sm","opacity-50","flex-grow-1",3,"click","minWidthPx"],["buttonIcon","iconoir:lens-plus","iconSize","24px",1,"btn","btn-outline-success","btn-sm","opacity-80","flex-grow-1",3,"click","minWidthPx"],["buttonIcon","iconoir:notes","iconSize","24px",1,"btn","btn-outline-secondary","border-0",3,"click"],["type","text",1,"form-control","form-control-sm","shadow-none","text-center","bg-dark",3,"input","value"],["size","small",3,"ngModelChange","change","spinners","ngModel"],[3,"updateFoodWeight","removeRecipe","removeFood","recipe"],[3,"removeFood","updateFoodWeight","food","isOdd","focusWeight"],[1,"overflow-hidden","d-flex","justify-content-center","align-items-center","position-relative",2,"box-shadow","0 0 2px 3px rgba(30, 30, 30, 0.5)","border-radius","6px"],["buttonIcon","mdi:close",1,"btn","text-black","border","p-0","position-absolute","end-0","top-0","me-1","mt-1","z-2","opacity-75",3,"click","iconSize"],[1,"z-1",3,"deleteChange","imageId"],[1,"position-absolute","z-0","w-100"],["stretched","",3,"imageId"],["type","file","accept","image/*","autofocus","false","tabindex","-1",1,"d-none",3,"change"],["buttonIcon","streamline-logos:food-spotting-logo-2-block","iconSize","48px",1,"btn","opacity-50",3,"click"],["rows","3","placeholder","Meal note",1,"form-control","form-control-sm","text-center",3,"input","value"],["rows","3","placeholder","Day note",1,"form-control","form-control-sm","text-center",3,"input","value"]],template:function(e,t){if(e&1){let o=h();d(0,"div",4)(1,"div",5)(2,"span",6),c(3),ze(4,"date"),l()(),d(5,"weekdays",7),$("selectedDateChange",function(p){return m(o),O(t.selectedDate,p)||(t.selectedDate=p),g(p)}),l(),v(6,"div",8),d(7,"div",9)(8,"div",10)(9,"button",11),u("click",function(){m(o);let p=Fe(47);return g(t.toggleEditDayNoteDialog(p))}),v(10,"iconify",12),l(),d(11,"div",13)(12,"button",14),u("click",function(){return m(o),g(t.diaryLogService.subtractDayWater(t.selectedDayJs().toISOString(),250))}),v(13,"iconify",15)(14,"iconify",16),l(),Te(15),d(16,"div",17),f(17,Xt,1,1)(18,Zt,1,0),l(),d(19,"button",14),u("click",function(){return m(o),g(t.diaryLogService.addDayWater(t.selectedDayJs().toISOString(),250))}),v(20,"iconify",18)(21,"iconify",16),l()()(),d(22,"div",19)(23,"div",20),c(24,"P"),l(),d(25,"div",20),c(26,"C"),l(),d(27,"div",20),c(28,"Fa"),l(),d(29,"div",20),c(30,"Fi"),l(),d(31,"div",20),c(32,"KCal"),l(),d(33,"div",20),c(34,"G"),l()()(),v(35,"div",8),d(36,"div",21),v(37,"div",22),I(38,si,2,2,null,null,T),l(),v(40,"total-row",23)(41,"macros-widget",24)(42,"weight-in-widget",25)(43,"activity-widget",26),l(),Pe(44,ci,1,1,"ng-template",null,0,Ee)(46,pi,1,1,"ng-template",null,1,Ee)}if(e&2){let o;a(),z(Be(20,Gt,!t.isTodaySelected(),t.isTodaySelected(),!t.isTodaySelected())),a(2),Oe(Ae(4,17,(o=t.selectedDayJs())==null?null:o.toISOString())),a(2),L("selectedDate",t.selectedDate),a(4),B("btn-outline-info",t.diaryLogService.getDayNote(t.selectedDayJs().toISOString())),a(6);let r=Ie(t.diaryLogService.getDayWater(t.selectedDayJs().toISOString()));a(),Le($e(24,qt,t.getWaterBg(r,t.optionsService.options().weightFormulaBackDays))),B("border-info-subtle",t.waterThresholdMet(r,t.optionsService.options().weightFormulaBackDays)),a(),x(r?17:18),a(21),E(t.dayTemplateService.getDayTemplate().entries),a(2),y("stats",t.getDayStats())("fixedDecimals",0),a(),y("isoDate",t.selectedDayJs().toISOString())("stats",t.getDayStats()),a(),y("isoDate",t.selectedDayJs().toISOString()),a(),y("isoDate",t.selectedDayJs().toISOString())}},dependencies:[A,Xe,ie,H,oe,re,be,ae,he,we,Q,Se,Ce,gt,fe,qe],styles:[".overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0000;background:linear-gradient(#f0c8f00d,#1414140d);z-index:1000;pointer-events:none}"]})};export{yt as Diary};
