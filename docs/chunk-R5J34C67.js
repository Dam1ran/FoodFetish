import{a as Xe,b as Ze,c as Ue,d as Ye}from"./chunk-5GP2HP3A.js";import{a as nt,b as B,c as at,d as dt}from"./chunk-XLKO6DT3.js";import{d as ce,g as K,i as ee,j as Be,k as Ae,l as J,m as ze,n as Je,p as je,q as pe,r as me}from"./chunk-MNQVDAGX.js";import{a as te}from"./chunk-UEJSXAPY.js";import{a as rt}from"./chunk-KUZ52WNQ.js";import{a as $}from"./chunk-3OJFEKT3.js";import{a as pt,b as ge,c as Qe,f as He,h as ne,i as ue,j as Ke,q as et,r as tt,t as Fe,u as it,v as W,w as ot}from"./chunk-G7KJV4CT.js";import{b as Oe,f as $e,j as Ge,l as qe,t as Me}from"./chunk-MAWMYTZY.js";import{a as j}from"./chunk-TTUD5ZDE.js";import{$b as Se,Fb as u,Ga as a,Hb as l,Ob as ae,Pb as de,Qb as we,Rb as q,Sb as L,Tb as ke,Ub as O,Vb as p,X as Ie,Xa as S,Xb as y,Yb as N,Zb as R,_b as P,aa as x,ab as Ee,ac as De,bc as A,e as ct,ec as We,fa as m,fb as k,fc as U,ga as g,gc as Ve,ha as X,hc as se,ic as Ne,jb as D,jc as Re,kb as C,kc as Ce,lb as F,nb as T,nc as E,ob as I,pb as _,qb as d,qc as Q,ra as V,rb as s,rc as w,sa as re,sb as f,sc as le,tb as M,ub as h,uc as Y,vb as Z,vc as Pe,xc as Le,yb as v}from"./chunk-HXGKTDM5.js";var mt=["weightInput"],gt=(r,o)=>({"opacity-25":r,"opacity-5":o}),ie=class r{food=w.required();isOdd=w(!1);removeFood=Q();updateFoodWeight=Q();noRemove=w(!1,{transform:Le});focusWeight=w(!1);weightInput=le("weightInput");ngAfterViewInit(){this.focusWeight()&&this.weightInput().nativeElement.focus()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["food-row"]],viewQuery:function(e,t){e&1&&ae(t.weightInput,mt,5),e&2&&de()},inputs:{food:[1,"food"],isOdd:[1,"isOdd"],noRemove:[1,"noRemove"],focusWeight:[1,"focusWeight"]},outputs:{removeFood:"removeFood",updateFoodWeight:"updateFoodWeight"},decls:18,vars:16,consts:[["weightInput",""],[1,"d-flex"],["iconSize","16px",1,"btn","btn-outline-warning","mx-1","align-self-center","border-0",3,"click","disabled","buttonIcon"],[1,"d-flex","align-items-center","ps-1",2,"min-width","100px","width","20%","font-size","12px"],[1,"row","g-0","fw-light","fst-italic","flex-grow-1","align-self-stretch",2,"font-size","12px"],[1,"col","col-2","align-self-stretch","text-center","align-content-center","m-0"],[1,"col","col-2","align-self-stretch","text-center","align-content-center"],["type","number","inputmode","numeric",1,"form-control","form-control-sm","text-center","p-0","border","border-success-subtle","bg-body","shadow-none",2,"border-radius","4px",3,"blur","value"]],template:function(e,t){if(e&1){let i=v();d(0,"div",1)(1,"button",2),u("click",function(){return m(i),g(!t.noRemove()&&t.removeFood.emit())}),s(),d(2,"div",3),p(3),s(),d(4,"div",4)(5,"div",5),p(6),s(),d(7,"div",6),p(8),s(),d(9,"div",6),p(10),s(),d(11,"div",6),p(12),s(),d(13,"div",6),p(14),s(),d(15,"div",6)(16,"input",7,0),u("blur",function(c){return m(i),g(t.updateFoodWeight.emit(c.target.value))}),s()()()()}if(e&2){L("bg-body-tertiary",t.isOdd()),a(),O(U(13,gt,!t.noRemove(),t.noRemove())),_("disabled",t.noRemove())("buttonIcon",t.noRemove()?"":"iconoir:trash"),a(2),y(" ",t.food().name," ");let i=t.food().weight*.01;a(3),y(" ",(t.food().protein*i).toFixed(1)," "),a(2),y(" ",(t.food().carbs*i).toFixed(1)," "),a(2),y(" ",(t.food().fats*i).toFixed(1)," "),a(2),y(" ",(t.food().fiber*i).toFixed(1)," "),a(2),y(" ",(t.food().calories*i).toFixed(1)," "),a(2),_("value",t.food().weight)}},dependencies:[$],encapsulation:2})};var oe=class r{stats=w.required();fixedDecimals=w(1);static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["total-row"]],inputs:{stats:[1,"stats"],fixedDecimals:[1,"fixedDecimals"]},decls:16,vars:6,consts:[[1,"d-flex"],[1,"fw-semibold","text-muted","opacity-35","fst-italic","text-center","bg-body-tertiary",2,"width","130px"],[1,"row","g-0","flex-grow-1","fw-bold","text-muted","fst-italic","opacity-75",2,"font-size","13px"],[1,"col","col-2","text-center","align-content-center","bg-body-secondary",2,"color","rgb(80, 100, 240)"],[1,"col","col-2","text-center","align-content-center",2,"color","rgb(220, 220, 90)"],[1,"col","col-2","text-center","align-content-center","bg-body-secondary",2,"color","rgb(200, 160, 30)"],[1,"col","col-2","text-center","align-content-center",2,"color","rgb(100, 130, 20)"],[1,"col","col-2","text-center","align-content-center","bg-body-secondary",2,"color","rgb(150, 140, 180)"],[1,"col","col-2","text-center","align-content-center",2,"color","rgb(100, 100, 100)"]],template:function(e,t){e&1&&(M(0,"div",0)(1,"div",1),p(2," Total "),h(),M(3,"div",2)(4,"div",3),p(5),h(),M(6,"div",4),p(7),h(),M(8,"div",5),p(9),h(),M(10,"div",6),p(11),h(),M(12,"div",7),p(13),h(),M(14,"div",8),p(15),h()()()),e&2&&(a(5),y(" ",t.stats().proteins.toFixed(t.fixedDecimals())," "),a(2),y(" ",t.stats().carbs.toFixed(t.fixedDecimals())," "),a(2),y(" ",t.stats().fats.toFixed(t.fixedDecimals())," "),a(2),y(" ",t.stats().fiber.toFixed(t.fixedDecimals())," "),a(2),y(" ",t.stats().calories.toFixed(t.fixedDecimals())," "),a(2),y(" ",t.stats().weight.toFixed(t.fixedDecimals())," "))},encapsulation:2})};function ut(r,o){if(r&1){let e=v();d(0,"food-row",17),u("updateFoodWeight",function(i){let n=m(e).$index,c=l();return g(c.updateFoodWeight.emit({foodIndex:n,newWeight:+i}))})("removeFood",function(){let i=m(e).$index,n=l();return g(n.removeFood.emit(i))}),s()}if(r&2){let e,t=o.$implicit,i=o.$index,n=l();_("food",t)("isOdd",i%2!==0)("noRemove",((e=n.recipe().foods)==null?null:e.length)===1)}}var ye=class r{id=V(ge());recipe=w.required();updateFoodWeight=Q();removeFood=Q();removeRecipe=Q();recipeStats(){return et(this.recipe())}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["diary-recipe"]],inputs:{recipe:[1,"recipe"]},outputs:{updateFoodWeight:"updateFoodWeight",removeFood:"removeFood",removeRecipe:"removeRecipe"},decls:20,vars:8,consts:[["collapsible",""],[1,"accordion","accordion-flush",2,"--bs-accordion-active-bg","rgba(7, 60, 130, 0.5)",3,"id"],[1,"accordion-item"],[1,"accordion-header","d-flex","align-items-stretch"],[1,"d-flex","align-items-center",2,"background-color","rgba(40, 20, 30, 0.5)"],["buttonIcon","iconoir:trash","iconSize","16px",1,"btn","btn-outline-warning","btn-sm","opacity-25","mx-1","border-0",3,"click"],["type","button","data-bs-toggle","collapse",1,"accordion-button","collapsed","p-2","shadow-none",2,"background-color","rgba(40, 20, 30, 0.5)"],[1,"opacity-75","w-100","d-flex"],[1,"mx-auto","text-center","text-primary-emphasis","text-truncate","fst-italic"],[1,"d-flex","align-items-center","gap-1","justify-content-center","flex-shrink-0","flex-grow-1",2,"width","11.5%","max-width","98px","background-color","rgba(40, 20, 30, 0.5)"],["icon","icon-park-outline:chart-proportion","size","16px",1,"text-success-emphasis"],[1,"text-muted","fst-italic",2,"font-size","10px","margin-left","-2px"],[1,"accordion-collapse","collapse",3,"id"],[1,"d-flex","flex-column","py-1","gap-1"],[3,"food","isOdd","noRemove"],[1,"bg-body"],[3,"stats","fixedDecimals"],[3,"updateFoodWeight","removeFood","food","isOdd","noRemove"]],template:function(e,t){if(e&1){let i=v();d(0,"div",1)(1,"div",2)(2,"h2",3)(3,"div",4)(4,"button",5),u("click",function(){return m(i),g(t.removeRecipe.emit())}),s()(),d(5,"button",6)(6,"div",7)(7,"div",8),p(8),s()()(),d(9,"div",9),f(10,"iconify",10),d(11,"div",11),p(12),s()()(),d(13,"div",12,0)(15,"div",13),T(16,ut,1,3,"food-row",14,F),s(),d(18,"div",15),f(19,"total-row",16),s()()()()}e&2&&(_("id","accordionFlushRecipe-"+t.id()),a(5),k("data-bs-target","#flush-collapse-"+t.id()),a(3),y(" ",t.recipe().name," "),a(4),y(" ",t.recipe().portions," "),a(),_("id","flush-collapse-"+t.id()),k("data-bs-parent","#accordionFlushRecipe-"+t.id()),a(3),I(t.recipe().foods),a(3),_("stats",t.recipeStats())("fixedDecimals",0))},dependencies:[ie,oe,j,$],encapsulation:2})};var yt=(r,o,e,t,i)=>({"border-warning":r,"text-primary":o,"fw-bold":e,"fst-normal":t,"bg-body-secondary":i});function _t(r,o){if(r&1){let e=v();d(0,"div",4),u("click",function(){let i=m(e).$implicit,n=l();return g(n.selectWeekDay(i))}),d(1,"div",5),p(2),s(),f(3,"div",6),s()}if(r&2){let e=o.$implicit,t=o.$index,i=l();O(se(5,yt,i.isDaySelected(e),i.isTodayLbl(e),i.isTodayLbl(e),i.isTodayLbl(e),t===5||t===6)),a(2),y("",e,"."),a(),q("background-color",i.getIndicatorStatusColor(e))}}var _e=class r{weekdays=["Mo","Tu","We","Th","Fr","Sa","Su"];calendar=x(Je);selectedDate=Y();selectedDayJs=E(()=>B.fromNgbDateStruct(this.selectedDate()));ngOnInit(){this.selectedDate.set(this.calendar.getToday())}isDaySelected(o){let e=B.getStartOfToday();return o===this.weekdays[this.selectedDayJs().day()===0?6:this.selectedDayJs().day()-1]&&e.isoWeek()===this.selectedDayJs().isoWeek()}isTodayLbl(o){let e=B.getStartOfToday();return o===this.weekdays[e.day()===0?6:e.day()-1]}selectWeekDay(o){let e=this.weekdays.indexOf(o);if(B.getStartOfToday().isoWeek()!==this.selectedDayJs().isoWeek())return;let i=this.selectedDayJs().isoWeekday(e+1);this.selectedDate.set({day:i.date(),month:i.month()+1,year:i.year()})}diaryLogService=x(W);getIndicatorStatusColor(o){let e=this.diaryLogService.hasFoodOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(o)+1).toISOString()),t=this.diaryLogService.hasWeightInOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(o)+1).toISOString()),i=this.diaryLogService.hasWaterOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(o)+1).toISOString()),n=this.diaryLogService.hasActivitiesOnDate(this.selectedDayJs().isoWeekday(this.weekdays.indexOf(o)+1).toISOString());return e&&t&&i&&n?"rgba(60, 140, 70)":e||t||i||n?"rgba(150, 120, 70)":"rgba(90, 90, 90)"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["weekdays"]],inputs:{selectedDate:[1,"selectedDate"]},outputs:{selectedDate:"selectedDateChange"},decls:5,vars:1,consts:[[1,"bg-secondary-subtle","p-1","user-select-none"],[1,"d-flex","justify-content-between"],[1,"weekday","bg-body","cursor-pointer","opacity-85",3,"class"],[3,"selectedDateChange","selectedDate"],[1,"weekday","bg-body","cursor-pointer","opacity-85",3,"click"],[1,"text-center"],[1,"rounded","m-auto",2,"width","10px","height","10px"]],template:function(e,t){e&1&&(d(0,"div",0)(1,"div",1),T(2,_t,4,11,"div",2,F),d(4,"date-picker",3),P("selectedDateChange",function(n){return R(t.selectedDate,n)||(t.selectedDate=n),n}),s()()()),e&2&&(a(2),I(t.weekdays),a(2),N("selectedDate",t.selectedDate))},dependencies:[nt],styles:[".weekday[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;font-size:14px;border:2px solid transparent;transition:border .3s;font-style:italic}"]})};var Te=ct(pt());var ft=(r,o)=>({"text-info-emphasis":r,"text-warning-emphasis":o});function xt(r,o){if(r&1&&(X(),f(0,"line",11)),r&2){let e=l(),t=e.$implicit,i=e.$index,n=l(3);k("x1",`${96/(n.weights().length-1)*i+2}%`)("y1",`${n.weightsRange()===0?50:(n.weightsMax()+n.weightsRange()*.1-t)/(n.weightsRange()*1.5)*100}%`)("x2",`${96/(n.weights().length-1)*(i+1)+2}%`)("y2",`${n.weightsRange()===0?50:(n.weightsMax()+n.weightsRange()*.1-n.weights()[i+1])/(n.weightsRange()*1.5)*100}%`)}}function vt(r,o){if(r&1&&(X(),d(0,"text",12),p(1),s()),r&2){let e=l(),t=e.$implicit,i=e.$index,n=l(3);k("x",`${88/n.Math.max(n.weights().length-1,1)*i+6}%`),a(),y(" ",t.toFixed(1)," ")}}function bt(r,o){if(r&1&&(X(),f(0,"circle",10),D(1,xt,1,4,":svg:line",11),D(2,vt,2,2,":svg:text",12)),r&2){let e=o.$implicit,t=o.$index,i=l(3);k("cx",`${96/i.Math.max(i.weights().length-1,1)*t+2}%`)("cy",`${i.weightsRange()===0?50:(i.weightsMax()+i.weightsRange()*.1-e)/(i.weightsRange()*1.5)*100}%`),a(),C(t<i.weights().length-1?1:-1),a(),C(e?2:-1)}}function ht(r,o){if(r&1&&(X(),f(0,"line",13)),r&2){let e=l(),t=e.$implicit,i=e.$index,n=l(3);k("x1",`${96/(n.calories().length-1)*i+2}%`)("y1",`${n.caloriesRange()===0?50:(n.caloriesMax()+n.caloriesRange()*.1-t)/(n.caloriesRange()*1.5)*100}%`)("x2",`${96/(n.calories().length-1)*(i+1)+2}%`)("y2",`${n.caloriesRange()===0?50:(n.caloriesMax()+n.caloriesRange()*.1-n.calories()[i+1])/(n.caloriesRange()*1.5)*100}%`)}}function wt(r,o){if(r&1&&D(0,ht,1,4,":svg:line",13),r&2){let e=o.$index,t=l(3);C(e<t.calories().length-1?0:-1)}}function St(r,o){if(r&1&&(X(),d(0,"svg",2),T(1,bt,3,4,null,null,F),T(3,wt,1,1,null,null,F),s()),r&2){let e=l(2);a(),I(e.weights()),a(2),I(e.calories())}}function Dt(r,o){if(r&1){let e=v();D(0,St,5,0,":svg:svg",2),d(1,"div",3)(2,"div",4),f(3,"iconify",5),d(4,"div",6),p(5),s()(),d(6,"div",7),f(7,"iconify",8),d(8,"input",9),u("blur",function(i){m(e);let n=l();return g(n.diaryLogService.updateCurrentWeight(n.isoDate(),i.target.value))}),s()()()}if(r&2){let e=l();C(e.weights().length?0:-1),a(5),y(" ",e.diaryLogService.getWeightByFormula(e.isoDate(),e.optionsService.options().weightFormulaBackDays).toFixed(1)," kg "),a(2),O(U(7,ft,e.diaryLogService.getCurrentWeight(e.isoDate()),!e.diaryLogService.getCurrentWeight(e.isoDate()))),a(),_("placeholder",e.diaryLogService.getCurrentWeight(e.isoDate())?"kg":"?")("disabled",e.weightInputDisabled())("value",e.diaryLogService.getCurrentWeight(e.isoDate()))}}var fe=class r{Math=Math;diaryLogService=x(W);optionsService=x(te);isoDate=w("");weights(){return this.isoDate()?this.diaryLogService.getWeights(this.isoDate(),11):[]}weightsMax=E(()=>Math.max(...this.weights()));weightsMin=E(()=>Math.min(...this.weights()));weightsRange=E(()=>this.weightsMax()-this.weightsMin());weightInputDisabled(){return(0,Te.default)().utc().startOf("day").isBefore((0,Te.default)(this.isoDate()).utc())}calories(){return this.isoDate()?this.diaryLogService.getCalories(this.isoDate(),11):[]}caloriesMax=E(()=>Math.max(...this.calories()));caloriesMin=E(()=>Math.min(...this.calories()));caloriesRange=E(()=>this.caloriesMax()-this.caloriesMin());static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["weight-in-widget"]],inputs:{isoDate:[1,"isoDate"]},decls:3,vars:1,consts:[[1,"rounded","bg-body-secondary","position-relative","main-wrapper"],[1,"overlay"],[1,"w-100",2,"pointer-events","none","height","64px"],[1,"d-flex"],[1,"flex-grow-1","px-1","d-flex","align-items-center","mt-3"],["icon","ph:tilde-fill",1,"opacity-50"],[1,"ms-1","fw-semibold","opacity-75",2,"font-size","14px"],[1,"position-relative","d-flex","justify-content-center","align-items-center","overflow-hidden","me-1",2,"width","48px","height","48px"],["icon","iconoir:weight","size","3rem",1,"position-absolute","z-0","opacity-55",2,"transform","scaleX(1.25)"],["type","number","inputmode","numeric",1,"form-control","text-center","p-0","shadow-none","z-1","border-0",2,"width","44px","background-color","transparent","margin-top","10px",3,"blur","placeholder","disabled","value"],["r","4","fill","rgba(from var(--bs-info-text-emphasis) r g b / 0.5)"],["stroke","rgba(from var(--bs-info-text-emphasis) r g b / 0.4)","stroke-width","1"],["y","96%","fill","rgba(from var(--bs-info-text-emphasis) r g b / 0.5)","font-size","12px","font-style","italic","text-anchor","middle"],["stroke","rgb(110, 100, 140)","stroke-width","1"]],template:function(e,t){e&1&&(d(0,"div",0),f(1,"div",1),D(2,Dt,9,10),s()),e&2&&(a(2),C(t.weightInputDisabled()?-1:2))},dependencies:[j],styles:[".main-wrapper[_ngcontent-%COMP%]{border:2px solid rgb(from var(--bs-info-text-emphasis) r g b/.1)}input[_ngcontent-%COMP%]{color:var(--bs-info-text-emphasis)}[_ngcontent-%COMP%]::placeholder{color:var(--bs-info-text-emphasis);font-style:italic;opacity:.4}.overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0000;background:linear-gradient(#00000040,#c8a0c80d);z-index:1000;pointer-events:none}"]})};function Ct(r,o){if(r&1){let e=v();d(0,"li",27)(1,"span",28),u("click",function(){m(e);let i=l().$implicit,n=l().$index,c=l();return g(c.diaryLogService.setActivityType(c.isoDate(),n,i.value))}),p(2),s()()}if(r&2){let e=l(),t=e.$implicit,i=e.$index;L("bg-body-tertiary",i%2===0),a(2),y(" ",t.label," ")}}function Mt(r,o){if(r&1&&D(0,Ct,3,3,"li",26),r&2){let e=o.$implicit;C(e.value?0:-1)}}function Ft(r,o){if(r&1){let e=v();d(0,"div",6)(1,"h2",7)(2,"button",8),u("click",function(){let i=m(e).$index,n=l();return g(n.diaryLogService.removeActivity(n.isoDate(),i))}),s(),d(3,"button",9),p(4),s(),d(5,"ul",10),T(6,Mt,1,1,null,null,F),s(),d(8,"button",11)(9,"div",12),f(10,"iconify",13),d(11,"span",14),f(12,"iconify",15),s(),d(13,"input",16),P("ngModelChange",function(i){let n=m(e).$implicit;return R(n.durationMinutes,i)||(n.durationMinutes=i),g(i)}),u("blur",function(){m(e);let i=l();return g(i.diaryLogService.saveDiaryLog())}),s()()()(),d(14,"div",17,0)(16,"div",18)(17,"div",19)(18,"span",20),f(19,"iconify",21),s(),d(20,"div",22)(21,"ngb-timepicker",23),P("ngModelChange",function(i){let n=m(e).$implicit;return R(n.time,i)||(n.time=i),g(i)}),u("change",function(){m(e);let i=l();return g(i.diaryLogService.saveDiaryLog())}),s()()(),d(22,"div",24)(23,"input",25),P("ngModelChange",function(i){let n=m(e).$implicit;return R(n.note,i)||(n.note=i),g(i)}),u("blur",function(){m(e);let i=l();return g(i.diaryLogService.saveDiaryLog())}),s()()()()()}if(r&2){let e=o.$implicit,t=o.$index,i=l();a(4),y(" ",i.activitiesTypes[e.type].label," "),a(2),I(i.activitiesTypes),a(2),k("data-bs-target","#flush-activity-collapse"+t),a(2),_("icon",i.activityTypeIconMap[e.type].icon),a(3),N("ngModel",e.durationMinutes),a(),_("id","flush-activity-collapse"+t),a(7),_("spinners",!1),N("ngModel",e.time),a(2),N("ngModel",e.note)}}var xe=class r{diaryLogService=x(W);isoDate=w("");activityTypeIconMap=it;activitiesTypes=Object.keys(Fe).filter(o=>!isNaN(Number(o))).map(o=>({label:Fe[o],value:+o}));static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["activity-widget"]],inputs:{isoDate:[1,"isoDate"]},decls:8,vars:0,consts:[["collapsible",""],[1,"bg-body","rounded","mt-1","rounded","overflow-hidden"],[1,"d-flex","align-items-center","bg-body-secondary"],[1,"text-muted","text-center","flex-grow-1","opacity-50",2,"font-size","12px"],["iconSize","24px","buttonIcon","iconamoon:sign-plus-bold",1,"btn","btn-sm",3,"click"],["id","accordionActivityFlush",1,"d-flex","flex-column","accordion","accordion-flush",2,"gap","1px","padding","1px 0px"],[1,"accordion-item","rounded","overflow-hidden","border-0"],[1,"accordion-header","d-flex","align-content-center","gap-1"],["buttonIcon","iconoir:trash","iconSize","16px",1,"btn","btn-outline-warning","btn-sm","opacity-25","mx-1","align-self-center",3,"click"],["type","button","data-bs-toggle","dropdown",1,"btn","btn-outline-secondary","bg-body-secondary","border-0","dropdown-toggle","mx-auto","opacity-60","my-1",2,"min-width","120px","font-size","18px"],[1,"dropdown-menu","p-0","pb-1","overflow-hidden","shadow-sm",2,"min-width","120px"],["type","button","data-bs-toggle","collapse",1,"accordion-button","p-1","my-1","bg-body-tertiary","collapsed","text-truncate","text-muted","fw-bold","shadow-none","rounded"],[1,"d-flex","justify-content-around","flex-grow-1","align-items-center"],[3,"icon"],[1,"opacity-15"],["icon","icon-park-outline:timer","size","24px"],["type","number","inputmode","numeric","step","1","min","0","placeholder","m",1,"form-control","form-control-sm","shadow-none","text-center","border","border-info-subtle","rounded-circle","opacity-65",2,"width","30px","padding","0",3,"ngModelChange","blur","ngModel"],["data-bs-parent","#accordionActivityFlush",1,"accordion-collapse","collapse","bg-body-tertiary",3,"id"],[1,"p-1","d-flex","gap-2","justify-content-between"],[1,"d-flex","align-items-center","gap-1"],[1,"opacity-15",2,"margin","0px 1px"],["icon","mingcute:time-line","size","24px"],[1,"opacity-85",2,"padding","2px 0"],["size","small",3,"ngModelChange","change","spinners","ngModel"],[1,"flex-grow-1",2,"padding","2px"],["type","text","placeholder","Note",1,"form-control","form-control-sm","shadow-none","text-center","border-none","opacity-70","bg-dark-subtle",3,"ngModelChange","blur","ngModel"],[1,"mt-1",3,"bg-body-tertiary"],[1,"mt-1"],[1,"dropdown-item","cursor-pointer","px-2","text-center",3,"click"]],template:function(e,t){e&1&&(d(0,"div",1)(1,"div",2)(2,"div",3),p(3," Activities "),s(),d(4,"button",4),u("click",function(){return t.diaryLogService.addActivity(t.isoDate())}),s()(),d(5,"div",5),T(6,Ft,24,8,"div",6,F),s()()),e&2&&(a(6),I(t.diaryLogService.getActivities(t.isoDate())))},dependencies:[$,me,J,ce,Be,K,Ae,ee,j],encapsulation:2})};function Tt(r,o){if(r&1){let e=v();f(0,"div",1),d(1,"div",2)(2,"zxing-scanner",3),u("scanSuccess",function(i){m(e);let n=l();return g(n.onCodeResult(i))}),s(),d(3,"div",4)(4,"div",5),f(5,"div",6),s()()()}if(r&2){let e=l();a(2),_("formats",e.formats)("autofocusEnabled",!0)}}function It(r,o){if(r&1){let e=v();d(0,"div",0)(1,"button",7),u("click",function(){m(e);let i=l();return i.code.set(""),g(i.isScanning.set(!0))}),p(2," Re-scan "),s()(),d(3,"div",8)(4,"input",9),P("ngModelChange",function(i){m(e);let n=l();return R(n.code,i)||(n.code=i),g(i)}),u("click",function(i){return m(e),g(i.stopPropagation())}),s()()}if(r&2){let e=l();a(),_("disabled",e.isScanning()),a(3),N("ngModel",e.code)}}function Et(r,o){if(r&1){let e=v();d(0,"div",0)(1,"button",10),u("click",function(){m(e);let i=l();return g(i.onAddAsNewFood(i.code()))}),p(2," Add as new food "),s()()}if(r&2){let e=l();a(),_("disabled",e.isScanning())}}var ve=class r{foodsService=x(Qe);diaryLogService=x(W);modalService=x(pe);activeModal=x(je);formats=[Xe.EAN_13];isScanning=V(!0);isoDate=V("");mealPosition=V(0);code=Y("");respectiveFood=E(()=>this.code()&&this.foodsService.getFoodByBarcode(this.code()));isFoodAdded=!1;constructor(){re(()=>{let o=this.respectiveFood();o&&!this.isFoodAdded&&(this.addFoodToDiary(o),this.isFoodAdded=!0)})}onCodeResult(o){this.code.set(o),this.isScanning.set(!1)}addFoodToDiary(o){this.diaryLogService.addFood(this.isoDate(),this.mealPosition(),o),this.diaryLogService.updateMealTime(this.isoDate(),this.mealPosition()),this.activeModal.close()}onAddAsNewFood(o){this.modalService.open(Ye).componentInstance.food.set(new He(void 0,"new food",0,0,0,0,0,0,100,o,""))}ngOnDestroy(){navigator.mediaDevices&&navigator.mediaDevices.stop&&navigator.mediaDevices.stop()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["ng-component"]],inputs:{code:[1,"code"]},outputs:{code:"codeChange"},decls:3,vars:3,consts:[[1,"d-flex","opacity-50","p-1","gap-1"],[1,"mt-2"],[1,"position-relative"],[3,"scanSuccess","formats","autofocusEnabled"],[1,"position-absolute","d-flex","align-items-center",2,"inset","0","pointer-events","none"],[1,"border-top","border-bottom","border-warning","w-75","m-auto","position-relative",2,"height","60%"],[1,"laser"],[1,"btn","btn-sm","btn-outline-warning","mx-auto","flex-grow-1",3,"click","disabled"],[1,"m-1"],[1,"form-control","form-control-sm","border-warning-subtle","text-center","opacity-75","fs-5",3,"ngModelChange","click","ngModel"],["buttonIcon","mdi:plus",1,"btn","btn-sm","btn-outline-success","mx-auto","flex-grow-1",3,"click","disabled"]],template:function(e,t){e&1&&(D(0,Tt,6,2),D(1,It,5,2),D(2,Et,3,1,"div",0)),e&2&&(C(t.isScanning()&&!t.respectiveFood()?0:-1),a(),C(!t.isScanning()&&!t.respectiveFood()?1:-1),a(),C(t.code()&&!t.respectiveFood()?2:-1))},dependencies:[Ue,Ze,J,ce,K,ee,$],styles:["zxing-scanner[_ngcontent-%COMP%]{margin-top:2rem;max-width:min(60%,300px);margin:auto}.laser[_ngcontent-%COMP%]{position:absolute;width:100%;height:2px;background-color:#f0323280;box-shadow:0 0 8px #f0323280;top:50%;animation:_ngcontent-%COMP%_scan 1s infinite ease-in-out}@keyframes _ngcontent-%COMP%_scan{0%{top:5%}50%{top:95%}to{top:5%}}"]})};var be=class r{isoDate=w("");stats=w.required();diaryLogService=x(W);optionsService=x(te);getProteinScrollbarBg(o,e){if(!e)return"rgba(120, 120, 120, 0.5)";let t=e*1.5,i=e*2.5,n=e*.8,c=e*3.2;return o>=t&&o<=i?"rgba(60, 160, 70, 0.6)":o>=n&&o<=c?"rgba(180, 150, 50, 0.6)":"rgba(220, 140, 40, 0.5)"}getCarbScrollbarBg(o,e){if(!e)return"rgba(120, 120, 120, 0.5)";let t=e*1.6,i=e*3.2,n=e*.7,c=e*3.7;return o>=t&&o<=i?"rgba(60, 160, 70, 0.6)":o>=n&&o<=c?"rgba(180, 150, 50, 0.6)":"rgba(220, 140, 40, 0.5)"}getFatScrollbarBg(o,e){if(!e)return"rgba(120, 120, 120, 0.5)";let t=e*.6,i=e*1.2,n=e*.4,c=e*1.4;return o>=t&&o<=i?"rgba(60, 160, 70, 0.6)":o>=n&&o<=c?"rgba(180, 150, 50, 0.6)":"rgba(220, 140, 40, 0.5)"}getKCalScrollbarBg(o,e){if(!e)return"rgba(120, 120, 120, 0.5)";let t=e*25,i=e*30,n=e*18,c=e*37;return o>=t&&o<=i?"rgba(60, 160, 70, 0.6)":o>=n&&o<=c?"rgba(180, 150, 50, 0.6)":"rgba(220, 140, 40, 0.5)"}darkenColor(o){let e=o.match(/\d+/g);if(!e||e.length<3)return o;let t=Math.max(0,parseInt(e[0])-50),i=Math.max(0,parseInt(e[1])-50),n=Math.max(0,parseInt(e[2])-50),c=e[3]?parseInt(e[3])/255:1;return`rgba(${t}, ${i}, ${n}, ${c})`}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["macros-widget"]],inputs:{isoDate:[1,"isoDate"],stats:[1,"stats"]},decls:27,vars:12,consts:[[1,"rounded","overflow-hidden","position-relative"],[1,"overlay"],[1,"row","align-items-center","bg-body-secondary","fst-italic"],[1,"col","text-center","text-muted","opacity-50",2,"font-size","12px"],[1,"p-2","d-flex","flex-column","gap-3"],[1,"d-flex","align-items-center","gap-2"],[1,"flex-grow-1","position-relative"],[1,"text-center","mx-auto","rounded","fw-bold","position-absolute","start-50","top-50","translate-middle",2,"font-size","14px","line-height","14px","width","40px","color","rgb(80, 100, 240)","padding","3px 0px","background-color","rgb(30, 30, 30, 0.7)","border","1px solid rgba(150, 150, 150, 0.5)"],[1,"rounded-pill",2,"height","14px"],[1,"text-center","rounded","mx-auto","fw-bold","position-absolute","start-50","top-50","translate-middle",2,"font-size","14px","line-height","14px","width","40px","color","rgb(220, 220, 90)","padding","3px 0px","background-color","rgb(30, 30, 30, 0.7)","border","1px solid rgba(150, 150, 150, 0.5)"],[1,"text-center","rounded","mx-auto","fw-bold","position-absolute","start-50","top-50","translate-middle",2,"font-size","14px","line-height","14px","width","40px","color","rgb(200, 160, 30)","padding","3px 0px","background-color","rgb(30, 30, 30, 0.7)","border","1px solid rgba(150, 150, 150, 0.5)"],[1,"flex-grow-1","position-relative","w-50","mx-auto"],[1,"text-center","rounded","mx-auto","fw-bold","position-absolute","start-50","top-50","translate-middle","fst-italic",2,"font-size","14px","line-height","14px","letter-spacing","1px","width","fit-content","min-width","40px","color","rgb(150, 140, 180)","padding","3px 6px","background-color","rgb(30, 30, 30, 0.7)","border","1px solid rgba(150, 150, 150, 0.5)"]],template:function(e,t){e&1&&(M(0,"div",0),Z(1,"div",1),M(2,"div",2)(3,"div",3),p(4,"Proteins"),h(),M(5,"div",3),p(6,"Carbs"),h(),M(7,"div",3),p(8,"Fats"),h()(),M(9,"div",4)(10,"div",5)(11,"div",6)(12,"div",7),p(13),h(),Z(14,"div",8),h(),M(15,"div",6)(16,"div",9),p(17),h(),Z(18,"div",8),h(),M(19,"div",6)(20,"div",10),p(21),h(),Z(22,"div",8),h()(),M(23,"div",11)(24,"div",12),p(25),h(),Z(26,"div",8),h()()()),e&2&&(a(13),y(" ",t.stats().proteins.toFixed()," "),a(),q("background-color",t.getProteinScrollbarBg(t.stats().proteins,t.diaryLogService.getWeightByFormula(void 0,t.optionsService.options().weightFormulaBackDays))),a(3),y(" ",t.stats().carbs.toFixed()," "),a(),q("background-color",t.getCarbScrollbarBg(t.stats().carbs,t.diaryLogService.getWeightByFormula(void 0,t.optionsService.options().weightFormulaBackDays))),a(3),y(" ",t.stats().fats.toFixed()," "),a(),q("background-color",t.getFatScrollbarBg(t.stats().fats,t.diaryLogService.getWeightByFormula(void 0,t.optionsService.options().weightFormulaBackDays))),a(3),y(" ",t.stats().calories.toFixed()," "),a(),q("background-color",t.getKCalScrollbarBg(t.stats().calories,t.diaryLogService.getWeightByFormula(void 0,t.optionsService.options().weightFormulaBackDays))))},dependencies:[J],styles:[".overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0000;background:linear-gradient(#0a0a0a40,#c8a0c80d);z-index:1000;pointer-events:none}"]})};var he=class r{dayTemplate=V(void 0);constructor(){this.setTemplate()}setTemplate(){localStorage.removeItem("dayTemplate");let o=Object.keys(ne).filter(t=>!isNaN(Number(t))).map(t=>Number(t)).filter(t=>t!==0).map(t=>({label:ue[t],value:+t})),e=new tt;o.forEach(t=>{e.entries.push({position:t.value,meal:new Ke("",t.label),recipes:[]})}),this.dayTemplate.set(e)}getDayTemplate(){return this.dayTemplate()}static \u0275fac=function(e){return new(e||r)};static \u0275prov=Ie({token:r,factory:r.\u0275fac,providedIn:"root"})};var kt=["editMealNoteDialog"],Wt=(r,o,e)=>({"fst-italic":r,"fw-semibold":o,"text-muted":e}),Vt=r=>({"background-color":r}),Nt=(r,o,e,t,i)=>({collapsed:r,"fw-semibold":o,"opacity-50":e,"opacity-30":t,"opacity-70":i}),Rt=(r,o)=>({"bg-body-secondary":r,"bg-dark-subtle":o});function Pt(r,o){if(r&1&&p(0),r&2){l();let e=A(14);y(" ",(e/1e3).toFixed(1),"L ")}}function Lt(r,o){r&1&&p(0," ? ")}function Ot(r,o){if(r&1){let e=v();d(0,"div",38)(1,"button",48),u("click",function(){m(e),l(2);let i=A(0),n=l();return g(n.toggleEditMealNoteDialog(i.id,i.note))}),s(),d(2,"input",49),u("input",function(i){m(e);let n=l(2).$implicit,c=l();return g(c.updateMealName(n.position,i.target.value))}),s(),d(3,"ngb-timepicker",50),P("ngModelChange",function(i){m(e),l(2);let n=A(0);return R(n.time,i)||(n.time=i),g(i)}),u("change",function(){m(e);let i=l(3);return g(i.diaryLogService.saveDiaryLog())}),s()()}if(r&2){l(2);let e=A(0);a(),L("btn-outline-success",e.note),a(),_("value",e.name),a(),_("spinners",!1),N("ngModel",e.time)}}function $t(r,o){if(r&1){let e=v();d(0,"diary-recipe",51),u("updateFoodWeight",function(i){let n=m(e).$index,c=l(2).$implicit,b=l();return g(b.updateRecipeFoodWeight(c.position,n,i.foodIndex,i.newWeight))})("removeRecipe",function(){let i=m(e).$index,n=l(2).$implicit,c=l();return g(c.removeRecipeFromPosition(n.position,i))})("removeFood",function(i){let n=m(e).$index,c=l(2).$implicit,b=l();return g(b.removeFoodFromRecipe(c.position,n,i))}),s()}if(r&2){let e=o.$implicit;_("recipe",e)}}function Bt(r,o){if(r&1){let e=v();d(0,"food-row",52),u("removeFood",function(){let i=m(e).$index,n=l(2).$implicit,c=l();return g(c.removeFood(n.position,i))})("updateFoodWeight",function(i){let n=m(e).$index,c=l(2).$implicit,b=l();return g(b.updateFoodWeight(c.position,n,i))}),s()}if(r&2){let e=o.$implicit,t=o.$index,i=o.$count,n=l(2).$implicit,c=l();_("food",e)("isOdd",t%2!==0)("focusWeight",c.isMealExpanded(n.position)&&t===i-1)}}function At(r,o){if(r&1){let e=v();d(0,"div",43)(1,"div",53)(2,"button",54),u("click",function(){m(e),l(2);let i=A(0),n=l();return g(n.deleteImage(i.imageId))}),s(),d(3,"meal-thumb",55),u("deleteChange",function(i){m(e);let n=l(3);return g(n.deleteImage(i))}),s()(),d(4,"div",56),f(5,"meal-thumb",57),s()()}if(r&2){l(2);let e=A(0);a(2),_("iconSize","16px"),a(),_("imageId",e.imageId),a(2),_("imageId",e.imageId)}}function zt(r,o){if(r&1){let e=v();d(0,"input",58,3),u("change",function(i){m(e),l(2);let n=A(0),c=l();return g(c.onImageSelected(i,n))}),s(),d(2,"button",59),u("click",function(){m(e);let i=we(1);return g(i.click())}),s()}}function Jt(r,o){if(r&1){let e=v();d(0,"div",26)(1,"h2",27)(2,"button",28),u("click",function(){m(e);let i=l().$implicit,n=l();return g(n.toggleExpandedMeal(i.position))}),p(3),s(),d(4,"div",29)(5,"div",30)(6,"div",31),p(7),s(),d(8,"div",32),p(9),s(),d(10,"div",33),p(11),s(),d(12,"div",34),p(13),s(),d(14,"div",35),p(15),s(),d(16,"div",36),p(17),s()()()(),d(18,"div",37,2),D(20,Ot,4,5,"div",38),T(21,$t,1,1,"diary-recipe",39,F),d(23,"div",40),T(24,Bt,1,3,"food-row",41,F),s(),d(26,"div",42),D(27,At,6,3,"div",43)(28,zt,3,0),s(),d(29,"div",44)(30,"button",45),u("click",function(i){m(e);let n=l().$implicit,c=l();return i.stopPropagation(),g(c.addRecipe(n.position))}),p(31," Recipe "),s(),d(32,"button",46),u("click",function(i){m(e);let n=l().$implicit,c=l();return i.stopPropagation(),g(c.onScanBarcodeClick(n.position))}),p(33," Barcode "),s(),d(34,"button",47),u("click",function(i){m(e);let n=l().$implicit,c=l();return i.stopPropagation(),g(c.addFood(n.position))}),p(35," Food "),s()()()()}if(r&2){let e,t=l(),i=t.$implicit,n=t.$index,c=A(0),b=l();a(2),O(se(22,Nt,!b.isMealExpanded(i.position),i.position!==b.mealPosition.Snacks,i.position!==b.mealPosition.Snacks&&!b.isMealExpanded(i.position),i.position===b.mealPosition.Snacks,b.isMealExpanded(i.position))),k("data-bs-target","#flush-collapse"+n),a(),y(" ",b.mealPositionMap[i.position]," "),a(2),O(U(28,Rt,!b.isMealExpanded(i.position),b.isMealExpanded(i.position)));let H=b.getPositionStats(i.position);a(2),y(" ",H.proteins.toFixed()," "),a(2),y(" ",H.carbs.toFixed()," "),a(2),y(" ",H.fats.toFixed()," "),a(2),y(" ",H.fiber.toFixed()," "),a(2),y(" ",H.calories.toFixed()," "),a(2),y(" ",H.weight.toFixed()," "),a(),L("show",b.isMealExpanded(i.position)),_("id","flush-collapse"+n),a(2),C(c&&i.position!==b.mealPosition.Snacks?20:-1),a(),I(b.getRespectiveRecipes(i.position)),a(2),L("py-1",c==null||c.foods==null?null:c.foods.length),a(),I(c==null?null:c.foods),a(3),C(c!=null&&c.imageId?27:!(c==null||c.foods==null)&&c.foods.length||(e=b.getRespectiveRecipes(i.position))!=null&&e.length?28:-1),a(3),_("minWidthPx",90),a(2),_("minWidthPx",90),a(2),_("minWidthPx",90)}}function jt(r,o){if(r&1&&(Se(0),D(1,Jt,36,31,"div",26)),r&2){let e=o.$implicit,t=o.$index,i=l(),n=i.diaryLogService.getRespectiveDayTemplate(i.selectedDayJs().toISOString());De(i.getRespectiveMeal(e.position)),a(),C(t===0||t===i.dayTemplateService.getDayTemplate().entries.length-1||!(n==null||n.entries[t-1]==null||n.entries[t-1].meal==null||n.entries[t-1].meal.foods==null)&&n.entries[t-1].meal.foods.length||!(n==null||n.entries[t-1]==null||n.entries[t-1].recipes==null)&&n.entries[t-1].recipes.length?1:-1)}}function Gt(r,o){if(r&1){let e=v();d(0,"textarea",60),u("input",function(i){m(e);let n=l();return g(n.updateMealNote(n.editNoteMealId(),i.target.value))}),s()}if(r&2){let e=l();_("value",e.editNoteMeal())}}function qt(r,o){if(r&1){let e=v();d(0,"textarea",61),u("input",function(i){m(e);let n=l();return g(n.diaryLogService.updateDayNote(n.selectedDayJs().toISOString(),i.target.value))}),s()}if(r&2){let e=l();_("value",e.diaryLogService.getDayNote(e.selectedDayJs().toISOString()))}}var lt=class r{mealPosition=ne;diaryDate=w("");selectedDate=Y(void 0);selectedDayJs=E(()=>this.selectedDate()&&B.fromNgbDateStruct(this.selectedDate()));isTodaySelected=E(()=>this.selectedDate()&&B.fromNgbDateStruct(this.selectedDate()).isSame(B.getStartOfToday(),"day"));ngAfterViewInit(){this.diaryDate()&&this.selectedDate.set(B.toNgbDateStruct(this.diaryDate()))}location=x(Oe);activatedRoute=x(Ge);constructor(){re(()=>{if(!this.selectedDate())return;let o=this.selectedDayJs();if(o){let e=this.router.createUrlTree([],{relativeTo:this.activatedRoute,queryParams:{diaryDate:o.toISOString()}}).toString();this.location.go(e)}})}dayTemplateService=x(he);router=x(qe);addFood(o){this.router.navigate([Me.myFoods],{queryParams:{diaryDate:this.selectedDayJs().toISOString(),mealPosition:o}})}addRecipe(o){this.router.navigate([Me.recipes],{queryParams:{diaryDate:this.selectedDayJs().toISOString(),mealPosition:o}})}diaryLogService=x(W);mealPositionMap=ue;getRespectiveMeal(o){return this.diaryLogService.getRespectiveMeal(this.selectedDayJs().toISOString(),o)}getRespectiveRecipes(o){return this.diaryLogService.getRespectiveRecipes(this.selectedDayJs().toISOString(),o)}updateMealName(o,e){this.diaryLogService.updateMealName(this.selectedDayJs().toISOString(),o,e)}removeFood(o,e){this.diaryLogService.removeFood(this.selectedDayJs().toISOString(),o,e)}updateFoodWeight(o,e,t){this.diaryLogService.updateFoodWeight(this.selectedDayJs().toISOString(),o,e,+t)}getPositionStats(o){return this.diaryLogService.getPositionStats(this.selectedDayJs().toISOString(),o)}getDayStats(){return this.diaryLogService.getDayStats(this.selectedDayJs().toISOString())}toggleExpandedMeal(o){this.diaryLogService.toggleExpandedMeal(this.selectedDayJs().toISOString(),o)}isMealExpanded(o){let e=this.diaryLogService.getExpandedMeal();return e?.isoDate===this.selectedDayJs().toISOString()&&e?.mealPosition===o}modalService=x(pe);editMealNoteDialogRef=le("editMealNoteDialog");editNoteMealId=V("");editNoteMeal=V("");toggleEditMealNoteDialog(o,e){this.editNoteMealId.set(o),this.editNoteMeal.set(e),this.modalService.open(this.editMealNoteDialogRef(),{size:"sm",centered:!0}).result.catch(()=>{this.editNoteMealId.set(""),this.editNoteMeal.set("")})}updateMealNote(o,e){this.diaryLogService.updateMealNote(this.selectedDayJs().toISOString(),o,e)}updateRecipeFoodWeight(o,e,t,i){this.diaryLogService.updateRecipeFoodWeight(this.selectedDayJs().toISOString(),o,e,t,i)}removeFoodFromRecipe(o,e,t){this.diaryLogService.removeFoodFromRecipe(this.selectedDayJs().toISOString(),o,e,t)}removeRecipeFromPosition(o,e){this.diaryLogService.removeRecipeFromPosition(this.selectedDayJs().toISOString(),o,e)}toggleEditDayNoteDialog(o){this.modalService.open(o,{size:"sm",centered:!0})}onScanBarcodeClick(o){let e=this.modalService.open(ve,{size:"sm",centered:!0});e.componentInstance.isoDate.set(this.selectedDayJs().toISOString()),e.componentInstance.mealPosition.set(o)}optionsService=x(te);getWaterBg(o,e){let t=this.diaryLogService.getWeightByFormula(void 0,e);if(!t)return"rgba(0, 0, 0, 0)";let i=Math.min(o/(t*.325),100);return`rgba(${140-i*1.5}, ${50+i*.8}, ${i*2}, 0.5)`}waterThresholdMet(o,e){let t=this.diaryLogService.getWeightByFormula(void 0,e);return t?o>t*32.5:!1}imageStoreService=x(rt);cdr=x(Pe);async onImageSelected(o,e){let i=o.target?.files?.[0];if(!i)return;let n=await dt(i),c=ge();this.imageStoreService.put(c,n).then(()=>{e.imageId=c,this.diaryLogService.saveDiaryLog(),this.cdr.detectChanges()})}recipesService=x(ot);async deleteImage(o){this.diaryLogService.deleteMealImage(o),this.recipesService.anyImage(o)||await this.imageStoreService.delete(o)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=S({type:r,selectors:[["diary"]],viewQuery:function(e,t){e&1&&ae(t.editMealNoteDialogRef,kt,5),e&2&&de()},inputs:{diaryDate:[1,"diaryDate"],selectedDate:[1,"selectedDate"]},outputs:{selectedDate:"selectedDateChange"},decls:47,vars:26,consts:[["editMealNoteDialog",""],["editDayNoteDialog",""],["collapsible",""],["imgInput",""],[1,"content-wrapper"],[1,"bg-body-tertiary","text-center","opacity-75",2,"font-size","14px","line-height","16px"],[3,"selectedDateChange","selectedDate"],[1,"border-bottom"],[1,"d-flex"],[1,"d-flex","justify-content-between","align-items-center","p-1",2,"width","130px"],[1,"btn","p-0","opacity-75","d-flex","justify-content-between","rounded",2,"border","1px solid transparent",3,"click"],["icon","iconoir:notes"],[1,"d-flex","align-items-center"],[1,"btn","p-0","d-flex","justify-content-between","position-relative","opacity-70",2,"width","fit-content",3,"click"],["size","16px","icon","iconamoon:sign-minus-bold",1,"position-absolute","z-1","translate-middle","top-50","start-50","text-info-emphasis"],["icon","mdi:glass-outline",1,"z-0","opacity-20"],[1,"text-center","rounded","fw-semibold","opacity-70",2,"width","40px","border","1px solid transparent"],["size","16px","icon","iconamoon:sign-plus-bold",1,"position-absolute","z-1","translate-middle","top-50","start-50","text-info-emphasis"],[1,"row","g-0","flex-grow-1","fw-bold","text-muted","fst-italic","opacity-25","bg-body-secondary",2,"font-size","12px"],[1,"col","col-2","align-self-center","text-center"],["id","accordionFlush",1,"accordion","accordion-flush","position-relative"],[1,"overlay"],[3,"stats","fixedDecimals"],[1,"mt-1","d-block","opacity-95",3,"isoDate","stats"],[1,"mt-1","d-block",3,"isoDate"],[3,"isoDate"],[1,"accordion-item"],[1,"accordion-header","d-flex","align-items-center"],["type","button","data-bs-toggle","collapse",1,"accordion-button","p-2","text-truncate","text-muted","shadow-none","bg-dark-subtsle",2,"width","130px",3,"click"],[1,"flex-grow-1","align-self-stretch"],[1,"row","g-0","h-100","fw-light","fst-italic",2,"font-size","12px","transition","background-color 0.3s"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(80, 100, 240)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(220, 220, 90)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(200, 160, 30)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(100, 130, 20)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(150, 140, 180)"],[1,"col","col-2","align-self-center","text-center",2,"color","rgb(100, 100, 100)"],["data-bs-parent","#accordionFlush",1,"accordion-collapse","collapse","rounded",3,"id"],[1,"d-flex","align-items-center","p-2","gap-1","bg-body-tertiary"],[3,"recipe"],[1,"d-flex","flex-column","gap-1"],[3,"food","isOdd","focusWeight"],[1,"mx-auto","d-flex","justify-content-center","align-items-center"],[1,"d-flex","justify-content-evenly","align-items-center","w-100","position-relative","overflow-hidden"],[1,"p-2","bg-body-tertiary","d-flex","gap-2","justify-content-between"],["buttonIcon","pajamas:recipe","iconSize","24px",1,"btn","btn-outline-primary","btn-sm","opacity-60","flex-grow-1",3,"click","minWidthPx"],["buttonIcon","si:barcode-fill","iconSize","24px",1,"btn","btn-outline-success","btn-sm","opacity-50","flex-grow-1",3,"click","minWidthPx"],["buttonIcon","iconoir:lens-plus","iconSize","24px",1,"btn","btn-outline-success","btn-sm","opacity-80","flex-grow-1",3,"click","minWidthPx"],["buttonIcon","iconoir:notes","iconSize","24px",1,"btn","btn-outline-secondary","border-0",3,"click"],["type","text",1,"form-control","form-control-sm","shadow-none","text-center","bg-dark",3,"input","value"],["size","small",3,"ngModelChange","change","spinners","ngModel"],[3,"updateFoodWeight","removeRecipe","removeFood","recipe"],[3,"removeFood","updateFoodWeight","food","isOdd","focusWeight"],[1,"overflow-hidden","d-flex","justify-content-center","align-items-center","position-relative",2,"box-shadow","0 0 2px 3px rgba(30, 30, 30, 0.5)","border-radius","6px"],["buttonIcon","mdi:close",1,"btn","text-black","border","p-0","position-absolute","end-0","top-0","me-1","mt-1","z-2","opacity-75",3,"click","iconSize"],[1,"z-1",3,"deleteChange","imageId"],[1,"position-absolute","z-0","w-100"],["stretched","",3,"imageId"],["type","file","accept","image/*","autofocus","false","tabindex","-1",1,"d-none",3,"change"],["buttonIcon","streamline-logos:food-spotting-logo-2-block","iconSize","48px",1,"btn","opacity-50",3,"click"],["rows","3","placeholder","Meal note",1,"form-control","form-control-sm","text-center",3,"input","value"],["rows","3","placeholder","Day note",1,"form-control","form-control-sm","text-center",3,"input","value"]],template:function(e,t){if(e&1){let i=v();d(0,"div",4)(1,"div",5),p(2),Ne(3,"date"),s(),d(4,"weekdays",6),P("selectedDateChange",function(c){return m(i),R(t.selectedDate,c)||(t.selectedDate=c),g(c)}),s(),f(5,"div",7),d(6,"div",8)(7,"div",9)(8,"button",10),u("click",function(){m(i);let c=we(46);return g(t.toggleEditDayNoteDialog(c))}),f(9,"iconify",11),s(),d(10,"div",12)(11,"button",13),u("click",function(){return m(i),g(t.diaryLogService.subtractDayWater(t.selectedDayJs().toISOString(),100))}),f(12,"iconify",14)(13,"iconify",15),s(),Se(14),d(15,"div",16),D(16,Pt,1,1)(17,Lt,1,0),s(),d(18,"button",13),u("click",function(){return m(i),g(t.diaryLogService.addDayWater(t.selectedDayJs().toISOString(),100))}),f(19,"iconify",17)(20,"iconify",15),s()()(),d(21,"div",18)(22,"div",19),p(23,"P"),s(),d(24,"div",19),p(25,"C"),s(),d(26,"div",19),p(27,"Fa"),s(),d(28,"div",19),p(29,"Fi"),s(),d(30,"div",19),p(31,"KCal"),s(),d(32,"div",19),p(33,"G"),s()()(),f(34,"div",7),d(35,"div",20),f(36,"div",21),T(37,jt,2,2,null,null,F),s(),f(39,"total-row",22)(40,"macros-widget",23)(41,"weight-in-widget",24)(42,"activity-widget",25),s(),Ee(43,Gt,1,1,"ng-template",null,0,Ce)(45,qt,1,1,"ng-template",null,1,Ce)}if(e&2){let i;a(),O(Ve(20,Wt,!t.isTodaySelected(),t.isTodaySelected(),!t.isTodaySelected())),a(),y(" ",Re(3,17,(i=t.selectedDayJs())==null?null:i.toISOString())," "),a(2),N("selectedDate",t.selectedDate),a(4),L("btn-outline-info",t.diaryLogService.getDayNote(t.selectedDayJs().toISOString())),a(6);let n=De(t.diaryLogService.getDayWater(t.selectedDayJs().toISOString()));a(),ke(We(24,Vt,t.getWaterBg(n,t.optionsService.options().weightFormulaBackDays))),L("border-info-subtle",t.waterThresholdMet(n,t.optionsService.options().weightFormulaBackDays)),a(),C(n?16:17),a(21),I(t.dayTemplateService.getDayTemplate().entries),a(2),_("stats",t.getDayStats())("fixedDecimals",0),a(),_("isoDate",t.selectedDayJs().toISOString())("stats",t.getDayStats()),a(),_("isoDate",t.selectedDayJs().toISOString()),a(),_("isoDate",t.selectedDayJs().toISOString())}},dependencies:[$,ze,K,J,ee,ie,ye,oe,_e,fe,j,xe,be,at,me,$e],styles:[".overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#0000;background:linear-gradient(#f0c8f00d,#1414140d);z-index:1000;pointer-events:none}"]})};export{lt as Diary};
